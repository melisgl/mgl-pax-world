<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
<title>Try Manual</title>
<link type='text/css' href='style.css' rel='stylesheet'/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<script src="jquery.min.js"></script>
<script src="toc.min.js"></script>
<script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         inlineMath: [['$','$']],
         processEscapes: true
       }
     });
   </script>
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
   </script>
   </head>
<body>
<div id="content-container">
<div id="toc">
<div id="toc-header"><ul><li><a href="index.html">PAX World</a></li></ul></div>
<div id="page-toc">
</div>
<div id="toc-footer"><ul><li><a href="https://github.com/melisgl/mgl-pax">[generated by MGL-PAX]</a></li></ul></div>
</div>
<div id="content">
<p><a id='x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28-23A-28-283-29-20BASE-CHAR-20-2E-20-22try-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((3) BASE-CHAR . \&quot;try\&quot;) ASDF/SYSTEM:SYSTEM)">&#8594;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L5">&#955;</a></span></span></p>

<h1><a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29">Try Manual</a></h1>

<h2>Table of Contents</h2>

<ul>
<li><a href="#x-28-23A-28-283-29-20BASE-CHAR-20-2E-20-22try-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((3) BASE-CHAR . \&quot;try\&quot;) ASDF/SYSTEM:SYSTEM)">1 TRY ASDF System Details</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FLINKS-20MGL-PAX-3ASECTION-29" title="Links">2 Links</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FTUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">3 Tutorial</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">4 Events</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FMIDDLE-LAYER-OF-EVENTS-20MGL-PAX-3ASECTION-29" title="Middle Layer of Events">4.1 Middle Layer of Events</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29" title="Concrete Events">4.2 Concrete Events</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FEVENT-GLUE-20MGL-PAX-3ASECTION-29" title="Event Glue">4.3 Event Glue</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FPRINTING-EVENTS-20MGL-PAX-3ASECTION-29" title="Printing Events">4.4 Printing Events</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FEVENT-RESTARTS-20MGL-PAX-3ASECTION-29" title="Event Restarts">4.5 Event Restarts</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">4.6 Outcomes</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29" title="Outcome Restarts">4.6.1 Outcome Restarts</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">4.6.2 Checks</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29" title="Trials">4.6.3 Trials</a></li>
</ul></li>
<li><a href="#x-28TRY-3A-40TRY-2FERRORS-20MGL-PAX-3ASECTION-29" title="Errors">4.7 Errors</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FCATEGORIES-20MGL-PAX-3ASECTION-29" title="Categories">4.8 Categories</a></li>
</ul></li>
<li><a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29" title="The IS Macro">5 The IS Macro</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29" title="Format Specifier Forms">5.1 Format Specifier Forms</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">5.2 Captures</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29" title="Automatic Captures">5.2.1 Automatic Captures</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FEXPLICIT-CAPTURES-20MGL-PAX-3ASECTION-29" title="Explicit Captures">5.2.2 Explicit Captures</a></li>
</ul></li>
</ul></li>
<li><a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">6 Check Library</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">6.1 Checking Conditions</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FMISC-CHECKS-20MGL-PAX-3ASECTION-29" title="Miscellaneous Checks">6.2 Miscellaneous Checks</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FCHECK-UTILITIES-20MGL-PAX-3ASECTION-29" title="Check Utilities">6.3 Check Utilities</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FCOMPARING-FLOATS-20MGL-PAX-3ASECTION-29" title="Comparing Floats">6.3.1 Comparing Floats</a></li>
</ul></li>
</ul></li>
<li><a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">7 Tests</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Calling Test Functions">7.1 Calling Test Functions</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">7.2 Explicit TRY</a>

<ul>
<li><a href="#x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29" title="Testables">7.2.1 Testables</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-IMPLEMENTATION-20MGL-PAX-3ASECTION-29" title="Implementation of Implicit TRY">7.2.2 Implementation of Implicit TRY</a></li>
</ul></li>
<li><a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">7.3 Printing Events</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">7.4 Counting Events</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">7.5 Collecting Events</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">7.6 Rerunning Trials</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FREPLAY-20MGL-PAX-3ASECTION-29" title="Reprocessing Trials">7.7 Reprocessing Trials</a></li>
</ul></li>
<li><a href="#x-28TRY-3A-40TRY-2FIMPLEMENTATION-NOTES-20MGL-PAX-3ASECTION-29" title="Implementation Notes">8 Implementation Notes</a></li>
<li><a href="#x-28TRY-3A-40TRY-2FGLOSSARY-20MGL-PAX-3ASECTION-29" title="Glossary">9 Glossary</a></li>
</ul>

<h6>[in package TRY]</h6>

<p><a id='x-28-23A-28-283-29-20BASE-CHAR-20-2E-20-22try-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FLINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8594;</a> <a href="#x-28-23A-28-283-29-20BASE-CHAR-20-2E-20-22try-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((3) BASE-CHAR . \&quot;try\&quot;) ASDF/SYSTEM:SYSTEM)">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/try.asd#L1">&#955;</a></span></span></p>

<h2><a href="#x-28-23A-28-283-29-20BASE-CHAR-20-2E-20-22try-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29">1 TRY ASDF System Details</a></h2>

<ul>
<li>Version: 0.0.1</li>
<li>Description: Try is a test framework.</li>
<li>Long Description: Try is what we get if we make tests functions and
  build a test framework on top of the condition system as
  <a href="https://common-lisp.net/project/stefil/index-old.shtml" >Stefil</a> did
  but also address the issue of rerunning and replaying, make the <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a>
  check more capable, use the types of the condition hierarchy to
  parameterize what to debug, print, rerun, and finally document the
  whole thing.</li>
<li>Licence: MIT, see COPYING.</li>
<li>Author: Gábor Melis</li>
<li>Mailto: <a href="mailto:mega@retes.hu" >mega@retes.hu</a></li>
<li>Homepage: <a href="http://melisgl.github.io/try" >http://melisgl.github.io/try</a></li>
<li>Bug tracker: <a href="https://github.com/melisgl/try/issues" >https://github.com/melisgl/try/issues</a></li>
<li>Source control: <a href="https://github.com/melisgl/try.git" >GIT</a></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FLINKS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28-23A-28-283-29-20BASE-CHAR-20-2E-20-22try-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((3) BASE-CHAR . \&quot;try\&quot;) ASDF/SYSTEM:SYSTEM)">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FTUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FLINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L16">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FLINKS-20MGL-PAX-3ASECTION-29">2 Links</a></h2>

<p>Here is the <a href="https://github.com/melisgl/try" >official repository</a>
and the <a href="http://melisgl.github.io/mgl-pax-world/try-manual.html" >HTML
documentation</a>
for the latest version.</p>

<p><a id='x-28TRY-3A-40TRY-2FTUTORIAL-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FLINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FTUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L22">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FTUTORIAL-20MGL-PAX-3ASECTION-29">3 Tutorial</a></h2>

<p>Try is a library for unit testing with equal support for
interactive and non-interactive workflows. Tests are functions, and
almost everything else is a condition, whose types feature
prominently in parameterization.</p>

<h5>Looking for Truth</h5>

<p><a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29" title="The IS Macro">The IS Macro</a> is a replacement for <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_assert.htm" title="(ASSERT MGL-PAX:MACRO)"><code>CL:ASSERT</code></a>, that can capture values of
subforms to provide context to failures:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">= <span class="paren3">(<span class="code">1+ 5</span>)</span> 0</span>)</span></span>)</span>

debugger invoked on a TRY:UNEXPECTED-RESULT-FAILURE:
  UNEXPECTED-FAILURE in check:
    <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">1+ 5</span>)</span> 0</span>)</span></span>)</span>
  where
    #1# = 6</span></code></pre>

<p>Note the <code>#N#</code> syntax due to <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_pr_cir.htm" title="(*PRINT-CIRCLE* VARIABLE)"><code>*PRINT-CIRCLE*</code></a>.</p>

<h5>Checking Multiple Values</h5>

<p><a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> automatically captures values of arguments to functions like <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_1pl_1_.htm" title="(1+ FUNCTION)"><code>1+</code></a>
in the above example (see <a href="#x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29" title="Automatic Captures">Automatic Captures</a>). Values of other
interesting subforms can be explicitly requested to be
captured (<a href="#x-28TRY-3A-40TRY-2FEXPLICIT-CAPTURES-20MGL-PAX-3ASECTION-29" title="Explicit Captures">Explicit Captures</a>). <code>IS</code> supports capturing multiple
values and can be taught how to deal with macros
(<a href="#x-28TRY-3A-40TRY-2FWRITING-AUTOMATIC-CAPTURE-RULES-20MGL-PAX-3ASECTION-29" title="Writing Automatic Capture Rules">Writing Automatic Capture Rules</a>). The combination of these
features allows <a href="#x-28TRY-3AMATCH-VALUES-20MGL-PAX-3AMACRO-29" title="(TRY:MATCH-VALUES MGL-PAX:MACRO)"><code>MATCH-VALUES</code></a> to be implementable as tiny extension:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">match-values <span class="paren3">(<span class="code">values <span class="paren4">(<span class="code">1+ 5</span>)</span> <span class="string">"sdf"</span></span>)</span>
      <span class="paren3">(<span class="code">= * 0</span>)</span>
      <span class="paren3">(<span class="code">string= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span>

debugger invoked on a TRY:UNEXPECTED-FAILURE:
  <span class="paren1">(<span class="code">IS
   <span class="paren2">(<span class="code">MATCH-VALUES #1=<span class="paren3">(<span class="code">VALUES <span class="paren4">(<span class="code">1+ 5</span>)</span> #2=<span class="string">"sdf"</span></span>)</span>
     <span class="paren3">(<span class="code">= * 0</span>)</span>
     <span class="paren3">(<span class="code">STRING= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span>
  where
    #1# == 6
           #2#</span></code></pre>

<p>In the body of <code>MATCH-VALUES</code>, <code>*</code> is bound to successive
return values of some form, here <code>(VALUES (1+ 5) &quot;sdf&quot;)</code>.
<code>MATCH-VALUES</code> comes with an automatic rewrite rule that captures the
values of this form, which are printed above as <code>#1# == 6 #2#</code>. <code>IS</code>
is flexible enough that all other checks (<a href="#x-28TRY-3ASIGNALS-20MGL-PAX-3AMACRO-29" title="(TRY:SIGNALS MGL-PAX:MACRO)"><code>SIGNALS</code></a>, <a href="#x-28TRY-3ASIGNALS-NOT-20MGL-PAX-3AMACRO-29" title="(TRY:SIGNALS-NOT MGL-PAX:MACRO)"><code>SIGNALS-NOT</code></a>,
<a href="#x-28TRY-3AINVOKES-DEBUGGER-20MGL-PAX-3AMACRO-29" title="(TRY:INVOKES-DEBUGGER MGL-PAX:MACRO)"><code>INVOKES-DEBUGGER</code></a>, <a href="#x-28TRY-3AINVOKES-DEBUGGER-NOT-20MGL-PAX-3AMACRO-29" title="(TRY:INVOKES-DEBUGGER-NOT MGL-PAX:MACRO)"><code>INVOKES-DEBUGGER-NOT</code></a>, <a href="#x-28TRY-3AFAILS-20MGL-PAX-3AMACRO-29" title="(TRY:FAILS MGL-PAX:MACRO)"><code>FAILS</code></a>, and <a href="#x-28TRY-3AIN-TIME-20MGL-PAX-3AMACRO-29" title="(TRY:IN-TIME MGL-PAX:MACRO)"><code>IN-TIME</code></a> are built
on top of it.</p>

<h5>Writing Tests</h5>

<p>Beyond a fancy <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_assert.htm" title="(ASSERT MGL-PAX:MACRO)"><code>ASSERT</code></a>, Try provides tests, which are Lisp functions
that record their execution in <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> objects. Let's define a test
and run it:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> should-work <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code">should-work</span>)</span>
.. SHOULD-WORK            <span class="comment">; TRIAL-START
</span>..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>             <span class="comment">; EXPECTED-RESULT-SUCCESS
</span>.. ⋅ SHOULD-WORK ⋅1       <span class="comment">; EXPECTED-VERDICT-SUCCESS
</span>..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">SHOULD-WORK</span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;</span></code></pre>

<p>This is an <a href="mgl-pax-manual.html#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)"><code>MGL-PAX</code></a> transcript, output is prefixed with <code>..</code> and the
unreadable return value with <code>==&gt;</code>. Try is driven by conditions, and
the comments to the right give the type of the condition that is
printed on that line. The <code>⋅</code> character marks successes.</p>

<p>We could have run our test with <code>(TRY 'SHOULD-WORK)</code>, as well, which
does pretty much the same thing except it defaults to never entering
the debugger, whereas calling a test function directly enters the
debugger on events whose type matches the type in the variable
<a href="#x-28TRY-3A-2ADEBUG-2A-20VARIABLE-29" title="(TRY:*DEBUG* VARIABLE)"><code>*DEBUG*</code></a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">try 'should-work</span>)</span>
.. SHOULD-WORK
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ SHOULD-WORK ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">SHOULD-WORK</span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;</span></code></pre>

<h5>Test Suites</h5>

<p>Test suites are just tests which call other tests.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-suite <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">should-work</span>)</span>
  <span class="paren2">(<span class="code">is <span class="paren3">(<span class="code">= <span class="paren4">(<span class="code">foo</span>)</span> 5</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> foo <span class="paren2">(<span class="code"></span>)</span>
  4</span>)</span>

<span class="paren1">(<span class="code">try 'my-suite</span>)</span>
.. MY-SUITE                 <span class="comment">; TRIAL-START
</span>..   SHOULD-WORK            <span class="comment">; TRIAL-START
</span>..     ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>             <span class="comment">; EXPECTED-RESULT-SUCCESS
</span>..   ⋅ SHOULD-WORK ⋅1       <span class="comment">; EXPECTED-VERDICT-SUCCESS
</span>..   ⊠ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">FOO</span>)</span> 5</span>)</span></span>)</span>  <span class="comment">; UNEXPECTED-RESULT-FAILURE
</span>..     where
..       #1# = 4
.. ⊠ MY-SUITE ⊠1 ⋅1         <span class="comment">; UNEXPECTED-VERDICT-FAILURE
</span>..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-SUITE</span>)</span> UNEXPECTED-FAILURE 0.000s ⊠1 ⋅1&gt;</span></code></pre>

<p><code>⊠</code> marks <a href="#x-28TRY-3AUNEXPECTED-FAILURE-20TYPE-29" title="(TRY:UNEXPECTED-FAILURE TYPE)"><code>UNEXPECTED-FAILURE</code></a>s. Note how the failure of <code>(IS (= (FOO)
5))</code> caused <code>MY-SUITE</code> to fail as well.</p>

<h5>Filtering Output</h5>

<p>To focus on the important bits, we can print only the <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>
events:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">try 'my-suite <span class="keyword">:print</span> 'unexpected</span>)</span>
.. MY-SUITE
..   ⊠ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">FOO</span>)</span> 5</span>)</span></span>)</span>
..     where
..       #1# = 4
.. ⊠ MY-SUITE ⊠1 ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-SUITE</span>)</span> UNEXPECTED-FAILURE 0.000s ⊠1 ⋅1&gt;</span></code></pre>

<p>Note that <code>SHOULD-WORK</code> is still run, and its check's success is
counted as evidenced by<code>⋅1</code>. The above effect can also be achieved
without running the tests again with <a href="#x-28TRY-3AREPLAY-EVENTS-20FUNCTION-29" title="(TRY:REPLAY-EVENTS FUNCTION)"><code>REPLAY-EVENTS</code></a>.</p>

<h5>Debugging</h5>

<p>Let's figure out what went wrong:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">my-suite</span>)</span>

<span class="comment">;;; Here the debugger is invoked:
</span>UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">FOO</span>)</span> 5</span>)</span></span>)</span>
where
  #1# = 4
Restarts:
 0: [RECORD-EVENT] Record the event and continue.
 1: [FORCE-EXPECTED-SUCCESS] Change outcome to TRY:EXPECTED-RESULT-SUCCESS.
 2: [FORCE-UNEXPECTED-SUCCESS] Change outcome to TRY:UNEXPECTED-RESULT-SUCCESS.
 3: [FORCE-EXPECTED-FAILURE] Change outcome to TRY:EXPECTED-RESULT-FAILURE.
 4: [ABORT-CHECK] Change outcome to TRY:RESULT-ABORT*.
 5: [SKIP-CHECK] Change outcome to TRY:RESULT-SKIP.
 6: [RETRY-CHECK] Retry check.
 7: [ABORT-TRIAL] Record the event and abort trial TRY::MY-SUITE.
 8: [SKIP-TRIAL] Record the event and skip trial TRY::MY-SUITE.
 9: [RETRY-TRIAL] Record the event and retry trial TRY::MY-SUITE.
 10: [SET-TRY-DEBUG] Supply a new value for :DEBUG of TRY:TRY.
 11: [RETRY] Retry SLIME interactive evaluation request.</span></code></pre>

<p>In the <a href="https://common-lisp.net/project/slime/doc/html/" >SLIME</a>
debugger, we press <code>v</code> on the frame of the call to <code>MY-SUITE</code> to
navigate to its definition, realize what the problem is and fix
<code>FOO</code>:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> foo <span class="paren2">(<span class="code"></span>)</span>
  5</span>)</span></span></code></pre>

<p>Now, we select the <a href="#x-28TRY-3ARETRY-TRIAL-20FUNCTION-29" title="(TRY:RETRY-TRIAL FUNCTION)"><code>RETRY-TRIAL</code></a> restart, and on the retry
<code>MY-SUITE</code> passes. The full output is:</p>

<pre><code><span class="code">MY-SUITE
  SHOULD-WORK
    ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
  ⋅ SHOULD-WORK ⋅1
WARNING: redefining TRY::FOO in DEFUN
  ⊠ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">FOO</span>)</span> 5</span>)</span></span>)</span>
    where
      #1# = 4
MY-SUITE retry #1
  SHOULD-WORK
    ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
  ⋅ SHOULD-WORK ⋅1
  ⋅ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= <span class="paren3">(<span class="code">FOO</span>)</span> 5</span>)</span></span>)</span>
⋅ MY-SUITE ⋅2</span></code></pre>

<h5>Rerunning Stuff</h5>

<p>Instead of working interactively, one can fix the failing test and
rerun it. Now, let's fix <code>MY-SUITE</code> and rerun it:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-suite <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">should-work</span>)</span>
  <span class="paren2">(<span class="code">is nil</span>)</span></span>)</span>

<span class="paren1">(<span class="code">try 'my-suite</span>)</span>
.. MY-SUITE
..   SHOULD-WORK
..     ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..   ⋅ SHOULD-WORK ⋅1
..   ⊠ <span class="paren1">(<span class="code">IS NIL</span>)</span>
.. ⊠ MY-SUITE ⊠1 ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-SUITE</span>)</span> UNEXPECTED-FAILURE 0.000s ⊠1 ⋅1&gt;

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-suite <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">should-work</span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code">try !</span>)</span>
.. MY-SUITE
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ MY-SUITE ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-SUITE</span>)</span> EXPECTED-SUCCESS 0.004s ⋅1&gt;</span></code></pre>

<p>Here, <a href="#x-28TRY-3A-21-20-28VARIABLE-20NIL-29-29" title="(TRY:! (VARIABLE NIL))"><code>!</code></a> refers to the most recent <code>TRIAL</code> returned by <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>. When a
trial is passed to <code>TRY</code> or is <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_funcal.htm" title="(FUNCALL FUNCTION)"><code>FUNCALL</code></a>ed, trials in it which match
the type in <code>TRY</code>'s <code>RERUN</code> argument are rerun (here, <code>UNEXPECTED</code> by
default). <code>SHOULD-WORK</code> and its check are <a href="#x-28TRY-3AEXPECTED-SUCCESS-20TYPE-29" title="(TRY:EXPECTED-SUCCESS TYPE)"><code>EXPECTED-SUCCESS</code></a>es,
hence they don't match <code>UNEXPECTED</code> and are not rerun (see
<a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>).</p>

<h5>Conditional Execution</h5>

<p>Conditional execution can be achieved simply testing the <code>TRIAL</code>
object returned by <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">Tests</a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-suite <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">when <span class="paren3">(<span class="code">passedp <span class="paren4">(<span class="code">should-work</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">is t <span class="keyword">:msg</span> <span class="string">"a test that depends on SHOULD-WORK"</span></span>)</span>
    <span class="paren3">(<span class="code">when <span class="paren4">(<span class="code">is nil</span>)</span>
      <span class="paren4">(<span class="code">is nil <span class="keyword">:msg</span> <span class="string">"never run"</span></span>)</span></span>)</span></span>)</span></span>)</span></span></code></pre>

<h5>Skipping</h5>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-suite <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-skip</span></i> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">not <span class="paren5">(<span class="code">server-available-p</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">test-server</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> test-server <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> server-available-p <span class="paren2">(<span class="code"></span>)</span>
  nil</span>)</span>

<span class="paren1">(<span class="code">my-suite</span>)</span>
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-SUITE</span>)</span> EXPECTED-SUCCESS 0.012s&gt;</span></code></pre>

<p>In the above, <code>TEST-SERVER</code> was skipped. No checks were made, no
errors happened, so nothing was printed.</p>

<h5>Expecting Outcomes</h5>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> known-broken <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-failure-expected</span></i> <span class="paren3">(<span class="code">t</span>)</span>
    <span class="paren3">(<span class="code">is nil</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code">known-broken</span>)</span>
.. KNOWN-BROKEN
..   × <span class="paren1">(<span class="code">IS NIL</span>)</span>
.. ⋅ KNOWN-BROKEN ×1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">KNOWN-BROKEN</span>)</span> EXPECTED-SUCCESS 0.000s ×1&gt;</span></code></pre>

<p><code>×</code> marks <code>EXPECTED-SUCCESS</code>es. <code>(WITH-SKIP (T) ...)</code> makes all
checks successes and failures <a href="#x-28TRY-3AEXPECTED-20CONDITION-29" title="(TRY:EXPECTED CONDITION)"><code>EXPECTED</code></a>, which are counted in their
own <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a> by default but don't make the enclosing tests to
fail. Also see <a href="#x-28TRY-3AWITH-EXPECTED-OUTCOME-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-EXPECTED-OUTCOME MGL-PAX:MACRO)"><code>WITH-EXPECTED-OUTCOME</code></a>.</p>

<h5>Running Tests on Definition</h5>

<p>With <a href="#x-28TRY-3A-2ARUN-DEFTEST-WHEN-2A-20VARIABLE-29" title="(TRY:*RUN-DEFTEST-WHEN* VARIABLE)"><code>*RUN-DEFTEST-WHEN*</code></a>, one can run test on definition. To run
tests on evaluation, as in SLIME <code>C-M-x</code>, <code>slime-eval-defun</code>:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">setq</span></i> <span class="special">*run-deftest-when*</span> <span class="keyword">:execute</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> some-test <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>
.. SOME-TEST
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ SOME-TEST ⋅1
..
=&gt; SOME-TEST

<span class="paren1">(<span class="code"><i><span class="symbol">setq</span></i> <span class="special">*run-deftest-when*</span> nil</span>)</span></span></code></pre>

<h5>Fixtures</h5>

<p>There is no direct support for fixtures in Try. One can easily write
macros like the following.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defvar</span></i> <span class="special">*server*</span> nil</span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmacro</span></i> <i><span class="symbol">with-xxx</span></i> <span class="paren2">(<span class="code">&amp;body body</span>)</span>
  `<span class="paren2">(<span class="code"><i><span class="symbol">flet</span></i> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">,<i><span class="symbol">with-xxx-body</span></i> <span class="paren5">(<span class="code"></span>)</span>
            ,@body</span>)</span></span>)</span>
     <span class="paren3">(<span class="code"><i><span class="symbol">if</span></i> <span class="special">*server*</span>
         <span class="paren4">(<span class="code"><i><span class="symbol">with-xxx-body</span></i></span>)</span>
         <span class="paren4">(<span class="code"><i><span class="symbol">with-server</span></i> <span class="paren5">(<span class="code">make-expensive-server</span>)</span>
           <span class="paren5">(<span class="code"><i><span class="symbol">with-xxx-body</span></i></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span></code></pre>

<p>Plus, with support for selectively <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>, the need for fixtures
is lessened.</p>

<h5>Packages</h5>

<p>The suggested way of writing tests is to call test functions
explicitly:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defpackage</span></i> <span class="keyword">:some-test-package</span>
  <span class="paren2">(<span class="code"><span class="keyword">:use</span> <span class="keyword">#:common-lisp</span> <span class="keyword">#:try</span></span>)</span></span>)</span>
<span class="paren1">(<span class="code">in-package <span class="keyword">:some-test-package</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> test-all <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">test-this</span>)</span>
  <span class="paren2">(<span class="code">test-that</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> test-this <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">test-this/more</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> test-this/more <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> test-that <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> not-called <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> test <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">warn-on-tests-not-run <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">find-package <span class="keyword">:some-test-package</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">try 'test-all</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code">test</span>)</span>
.. TEST-ALL
..   TEST-THIS
..     TEST-THIS/MORE
..       ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..     ⋅ TEST-THIS/MORE ⋅1
..   ⋅ TEST-THIS ⋅1
..   TEST-THAT
..     ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..   ⋅ TEST-THAT ⋅1
.. ⋅ TEST-ALL ⋅2
.. WARNING: Test NOT-CALLED not run.
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">TEST-ALL</span>)</span> EXPECTED-SUCCESS 0.012s ⋅2&gt;</span></code></pre>

<p>Note how the <code>TEST</code> function uses <a href="#x-28TRY-3AWARN-ON-TESTS-NOT-RUN-20MGL-PAX-3AMACRO-29" title="(TRY:WARN-ON-TESTS-NOT-RUN MGL-PAX:MACRO)"><code>WARN-ON-TESTS-NOT-RUN</code></a> to catch any
tests defined in <code>SOME-TEST-PACKAGE</code> that were not run. Tests can be
deleted by <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_fmakun.htm" title="(FMAKUNBOUND FUNCTION)"><code>FMAKUNBOUND</code></a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_uninte.htm" title="(UNINTERN FUNCTION)"><code>UNINTERN</code></a>, or by redefining the function with
<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm" title="(DEFUN MGL-PAX:MACRO)"><code>DEFUN</code></a>. Tests defined in a given package can be listed with
<a href="#x-28TRY-3ALIST-PACKAGE-TESTS-20FUNCTION-29" title="(TRY:LIST-PACKAGE-TESTS FUNCTION)"><code>LIST-PACKAGE-TESTS</code></a>.</p>

<p>This style allows higher level tests to establish the dynamic
environment necessary for lower level tests.</p>

<p><a id='x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FTUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FMIDDLE-LAYER-OF-EVENTS-20MGL-PAX-3ASECTION-29" title="Middle Layer of Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29">4 Events</a></h2>

<p>Try is built around events implemented as <code>CONDITION</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_cnd.htm" title="(CONDITION CONDITION)"><code>0</code></a> <a href="mgl-pax-manual.html#x-28CONDITION-20MGL-PAX-3ALOCATIVE-29" title="(CONDITION MGL-PAX:LOCATIVE)"><code>1</code></a>)s.
Matching the types of events to <a href="#x-28TRY-3A-2ADEBUG-2A-20VARIABLE-29" title="(TRY:*DEBUG* VARIABLE)"><code>*DEBUG*</code></a>, <a href="#x-28TRY-3A-2ACOUNT-2A-20VARIABLE-29" title="(TRY:*COUNT* VARIABLE)"><code>*COUNT*</code></a>, <a href="#x-28TRY-3A-2ACOLLECT-2A-20VARIABLE-29" title="(TRY:*COLLECT* VARIABLE)"><code>*COLLECT*</code></a>, <a href="#x-28TRY-3A-2ARERUN-2A-20VARIABLE-29" title="(TRY:*RERUN* VARIABLE)"><code>*RERUN*</code></a>,
<a href="#x-28TRY-3A-2APRINT-2A-20VARIABLE-29" title="(TRY:*PRINT* VARIABLE)"><code>*PRINT*</code></a>, and <a href="#x-28TRY-3A-2ADESCRIBE-2A-20VARIABLE-29" title="(TRY:*DESCRIBE* VARIABLE)"><code>*DESCRIBE*</code></a> is what gives Try its flexibility.</p>

<p><a id='x-28TRY-3A-40TRY-2FMIDDLE-LAYER-OF-EVENTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29" title="Concrete Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FMIDDLE-LAYER-OF-EVENTS-20MGL-PAX-3ASECTION-29" title="Middle Layer of Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L18">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FMIDDLE-LAYER-OF-EVENTS-20MGL-PAX-3ASECTION-29">4.1 Middle Layer of Events</a></h3>

<p>The event hierarchy is fairly involved, so let's start in the middle.
The condition <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> has 4 disjoint subclasses:</p>

<ul>
<li><p><a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a>, which corresponds to the entry to a test (see
  <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">Tests</a>),</p></li>
<li><p><a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>, the <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> of a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>,</p></li>
<li><p><a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>, the <code>OUTCOME</code> of a check (see <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">Checks</a>), and</p></li>
<li><p><a href="#x-28TRY-3AERROR-2A-20CONDITION-29" title="(TRY:ERROR* CONDITION)"><code>ERROR*</code></a>, an unexpected <code>CL:ERROR</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm" title="(ERROR CONDITION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_error.htm" title="(ERROR FUNCTION)"><code>1</code></a>) or unadorned <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a>.</p></li>
</ul>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="comment">;; We don't want to debug nor print a backtrace for the error below.
</span>      <span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*describe*</span> nil</span>)</span></span>)</span>
  <span class="comment">;; signals TRIAL-START / VERDICT-ABORT* on entry / exit
</span>  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">demo</span>)</span>
    <span class="comment">;; signals EXPECTED-RESULT-SUCCESS
</span>    <span class="paren3">(<span class="code">is t</span>)</span>
    <span class="comment">;; signals UNHANDLED-ERROR with a nested CL:ERROR
</span>    <span class="paren3">(<span class="code">error <span class="string">"xxx"</span></span>)</span></span>)</span></span>)</span>
.. DEMO                       <span class="comment">; TRIAL-START
</span>..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>                 <span class="comment">; EXPECTED-RESULT-SUCCESS (⋅)
</span>..   ⊟ "xxx" <span class="paren1">(<span class="code">SIMPLE-ERROR</span>)</span>   <span class="comment">; UNHANDLED-ERROR (⊟)
</span>.. ⊟ DEMO ⊟1 ⋅1               <span class="comment">; VERDICT-ABORT* (⊟)
</span>..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">DEMO</span>)</span></span>)</span> ABORT* 0.004s ⊟1 ⋅1&gt;</span></code></pre>

<p><a id='x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FMIDDLE-LAYER-OF-EVENTS-20MGL-PAX-3ASECTION-29" title="Middle Layer of Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FEVENT-GLUE-20MGL-PAX-3ASECTION-29" title="Event Glue">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29" title="Concrete Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L50">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29">4.2 Concrete Events</a></h3>

<p>The non-abstract condition classes of events that are actually
signalled are called concrete.</p>

<p><a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> is a concrete event class. <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>s and <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>s have six
 concrete subclasses:</p>

<ul>
<li><p><a href="#x-28TRY-3AEXPECTED-RESULT-SUCCESS-20CONDITION-29" title="(TRY:EXPECTED-RESULT-SUCCESS CONDITION)"><code>EXPECTED-RESULT-SUCCESS</code></a>, <a href="#x-28TRY-3AUNEXPECTED-RESULT-SUCCESS-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-SUCCESS CONDITION)"><code>UNEXPECTED-RESULT-SUCCESS</code></a>,
   <a href="#x-28TRY-3AEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:EXPECTED-RESULT-FAILURE CONDITION)"><code>EXPECTED-RESULT-FAILURE</code></a>, <a href="#x-28TRY-3AUNEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-FAILURE CONDITION)"><code>UNEXPECTED-RESULT-FAILURE</code></a>,
   <a href="#x-28TRY-3ARESULT-SKIP-20CONDITION-29" title="(TRY:RESULT-SKIP CONDITION)"><code>RESULT-SKIP</code></a>, <a href="#x-28TRY-3ARESULT-ABORT-2A-20CONDITION-29" title="(TRY:RESULT-ABORT* CONDITION)"><code>RESULT-ABORT*</code></a></p></li>
<li><p><a href="#x-28TRY-3AEXPECTED-VERDICT-SUCCESS-20CONDITION-29" title="(TRY:EXPECTED-VERDICT-SUCCESS CONDITION)"><code>EXPECTED-VERDICT-SUCCESS</code></a>, <a href="#x-28TRY-3AUNEXPECTED-VERDICT-SUCCESS-20CONDITION-29" title="(TRY:UNEXPECTED-VERDICT-SUCCESS CONDITION)"><code>UNEXPECTED-VERDICT-SUCCESS</code></a>,
   <a href="#x-28TRY-3AEXPECTED-VERDICT-FAILURE-20CONDITION-29" title="(TRY:EXPECTED-VERDICT-FAILURE CONDITION)"><code>EXPECTED-VERDICT-FAILURE</code></a>, <a href="#x-28TRY-3AUNEXPECTED-VERDICT-FAILURE-20CONDITION-29" title="(TRY:UNEXPECTED-VERDICT-FAILURE CONDITION)"><code>UNEXPECTED-VERDICT-FAILURE</code></a>,
   <a href="#x-28TRY-3AVERDICT-SKIP-20CONDITION-29" title="(TRY:VERDICT-SKIP CONDITION)"><code>VERDICT-SKIP</code></a>, <a href="#x-28TRY-3AVERDICT-ABORT-2A-20CONDITION-29" title="(TRY:VERDICT-ABORT* CONDITION)"><code>VERDICT-ABORT*</code></a></p></li>
</ul>

<p><a href="#x-28TRY-3AERROR-2A-20CONDITION-29" title="(TRY:ERROR* CONDITION)"><code>ERROR*</code></a> is an abstract class with two concrete subclasses:</p>

<ul>
<li><p><a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>, signalled when a <code>CL:ERROR</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm" title="(ERROR CONDITION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_error.htm" title="(ERROR FUNCTION)"><code>1</code></a>) reaches the handler set
   up by <a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" title="(TRY:DEFTEST MGL-PAX:MACRO)"><code>DEFTEST</code></a> or <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a>, or when the debugger is invoked.</p></li>
<li><p><a href="#x-28TRY-3ANLX-20CONDITION-29" title="(TRY:NLX CONDITION)"><code>NLX</code></a>, signalled when no error was detected by the handler, but the
   trial finishes with a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a>.</p></li>
</ul>

<p>These are the 15 concrete event classes.</p>

<p><a id='x-28TRY-3A-40TRY-2FEVENT-GLUE-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29" title="Concrete Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FPRINTING-EVENTS-20MGL-PAX-3ASECTION-29" title="Printing Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FEVENT-GLUE-20MGL-PAX-3ASECTION-29" title="Event Glue">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L76">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FEVENT-GLUE-20MGL-PAX-3ASECTION-29">4.3 Event Glue</a></h3>

<p>These condition classes group various bits of the
<a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29" title="Concrete Events">Concrete Events</a> and the <a href="#x-28TRY-3A-40TRY-2FMIDDLE-LAYER-OF-EVENTS-20MGL-PAX-3ASECTION-29" title="Middle Layer of Events">Middle Layer of Events</a> for ease of
reference.</p>

<p>Concrete event classes except <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> are subclasses of
hyphen-separated words in their name. For example,
<a href="#x-28TRY-3AUNEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-FAILURE CONDITION)"><code>UNEXPECTED-RESULT-FAILURE</code></a> inherits from <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>, <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>, and
<a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>, so it matches types such as <code>UNEXPECTED</code> or <code>(AND UNEXPECTED
RESULT)</code>.</p>

<p><a id='x-28TRY-3AEVENT-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L118">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEVENT-20CONDITION-29" >EVENT</a></span></span></span></p>

<p>Common abstract superclass of all events in Try.</p></li>
</ul>

<p><a id='x-28TRY-3AEXPECTED-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L124">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEXPECTED-20CONDITION-29" >EXPECTED</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p>Concrete condition classes with <code>EXPECTED</code> in their
name are subclasses of <code>EXPECTED</code>. <a href="#x-28TRY-3ASKIP-20CONDITION-29" title="(TRY:SKIP CONDITION)"><code>SKIP</code></a> is also a subclass of
<code>EXPECTED</code>.</p></li>
</ul>

<p><a id='x-28TRY-3AUNEXPECTED-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L129">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" >UNEXPECTED</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p>Concrete condition classes with <code>UNEXPECTED</code> in their
name are subclasses of <code>UNEXPECTED</code>. <a href="#x-28TRY-3AABORT-2A-20CONDITION-29" title="(TRY:ABORT* CONDITION)"><code>ABORT*</code></a> is also a subclass of
<code>UNEXPECTED</code>.</p></li>
</ul>

<p><a id='x-28TRY-3ASUCCESS-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L134">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASUCCESS-20CONDITION-29" >SUCCESS</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p>See <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">Checks</a> and <a href="#x-28TRY-3A-40TRY-2FTRIAL-VERDICTS-20MGL-PAX-3ASECTION-29" title="Trial Verdicts">Trial Verdicts</a> for how
<code>SUCCESS</code> or <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a> is decided.</p></li>
</ul>

<p><a id='x-28TRY-3AFAILURE-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L138">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFAILURE-20CONDITION-29" >FAILURE</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p>See <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3ADISMISSAL-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L141">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ADISMISSAL-20CONDITION-29" >DISMISSAL</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p>The third possibility after <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a> and <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>.
Either <a href="#x-28TRY-3ASKIP-20CONDITION-29" title="(TRY:SKIP CONDITION)"><code>SKIP</code></a> or <a href="#x-28TRY-3AABORT-2A-20CONDITION-29" title="(TRY:ABORT* CONDITION)"><code>ABORT*</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AABORT-2A-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L145">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AABORT-2A-20CONDITION-29" >ABORT*</a></span></span> <span class="locative-args">UNEXPECTED</span></span></p>

<p><a href="#x-28TRY-3ARESULT-ABORT-2A-20CONDITION-29" title="(TRY:RESULT-ABORT* CONDITION)"><code>RESULT-ABORT*</code></a>, <a href="#x-28TRY-3AVERDICT-ABORT-2A-20CONDITION-29" title="(TRY:VERDICT-ABORT* CONDITION)"><code>VERDICT-ABORT*</code></a> or <a href="#x-28TRY-3AERROR-2A-20CONDITION-29" title="(TRY:ERROR* CONDITION)"><code>ERROR*</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3ASKIP-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L125">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASKIP-20CONDITION-29" >SKIP</a></span></span> <span class="locative-args">EXPECTED DISMISSAL</span></span></p>

<p><a href="#x-28TRY-3ARESULT-SKIP-20CONDITION-29" title="(TRY:RESULT-SKIP CONDITION)"><code>RESULT-SKIP</code></a> or <a href="#x-28TRY-3AVERDICT-SKIP-20CONDITION-29" title="(TRY:VERDICT-SKIP CONDITION)"><code>VERDICT-SKIP</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3ALEAF-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L121">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ALEAF-20CONDITION-29" >LEAF</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p><a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a> or <a href="#x-28TRY-3AERROR-2A-20CONDITION-29" title="(TRY:ERROR* CONDITION)"><code>ERROR*</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AEXPECTED-SUCCESS-20TYPE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L149">[type]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEXPECTED-SUCCESS-20TYPE-29" >EXPECTED-SUCCESS</a></span></span></span></p>

<p>A shorthand for <code>(AND EXPECTED SUCCESS)</code>.</p></li>
</ul>

<p><a id='x-28TRY-3AUNEXPECTED-SUCCESS-20TYPE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L152">[type]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNEXPECTED-SUCCESS-20TYPE-29" >UNEXPECTED-SUCCESS</a></span></span></span></p>

<p>A shorthand for <code>(AND UNEXPECTED SUCCESS)</code>.</p></li>
</ul>

<p><a id='x-28TRY-3AEXPECTED-FAILURE-20TYPE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L155">[type]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEXPECTED-FAILURE-20TYPE-29" >EXPECTED-FAILURE</a></span></span></span></p>

<p>A shorthand for <code>(AND EXPECTED FAILURE)</code>.</p></li>
</ul>

<p><a id='x-28TRY-3AUNEXPECTED-FAILURE-20TYPE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L158">[type]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNEXPECTED-FAILURE-20TYPE-29" >UNEXPECTED-FAILURE</a></span></span></span></p>

<p>A shorthand for <code>(AND UNEXPECTED FAILURE)</code>.</p></li>
</ul>

<p><a id='x-28TRY-3APASS-20TYPE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L162">[type]</a></span> <span class="reference-object"><a href="#x-28TRY-3APASS-20TYPE-29" >PASS</a></span></span></span></p>

<p>An <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> that's not an <a href="#x-28TRY-3AABORT-2A-20CONDITION-29" title="(TRY:ABORT* CONDITION)"><code>ABORT*</code></a> or an <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AFAIL-20TYPE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L165">[type]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFAIL-20TYPE-29" >FAIL</a></span></span></span></p>

<p>An <a href="#x-28TRY-3AABORT-2A-20CONDITION-29" title="(TRY:ABORT* CONDITION)"><code>ABORT*</code></a> or an <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FPRINTING-EVENTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FEVENT-GLUE-20MGL-PAX-3ASECTION-29" title="Event Glue">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FEVENT-RESTARTS-20MGL-PAX-3ASECTION-29" title="Event Restarts">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FPRINTING-EVENTS-20MGL-PAX-3ASECTION-29" title="Printing Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L170">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FPRINTING-EVENTS-20MGL-PAX-3ASECTION-29">4.4 Printing Events</a></h3>

<p><a id='x-28TRY-3A-2AEVENT-PRINT-BINDINGS-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L173">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AEVENT-PRINT-BINDINGS-2A-20VARIABLE-29" >*EVENT-PRINT-BINDINGS*</a></span></span> <span class="locative-args">((*PRINT-CIRCLE* T))</span></span></p>

<p><a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s are conditions signalled in code that may change printer
variables such as <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_pr_cir.htm" title="(*PRINT-CIRCLE* VARIABLE)"><code>*PRINT-CIRCLE*</code></a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_pr_lev.htm" title="(*PRINT-LENGTH* VARIABLE)"><code>*PRINT-LENGTH*</code></a>, etc. To control
how events are printed, the list of variable bindings in
<code>*EVENT-PRINT-BINDINGS*</code> is established whenever an <code>EVENT</code> is printed
as if with:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">progv</span></i> <span class="paren2">(<span class="code">mapcar #'first <span class="special">*event-print-bindings*</span></span>)</span>
       <span class="paren2">(<span class="code">mapcar #'second <span class="special">*event-print-bindings*</span></span>)</span>
  ...</span>)</span></span></code></pre>

<p>The default value ensures that shared structure is recognized (see
<a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">Captures</a>). If the <code>#N#</code> syntax feels cumbersome, then change
this variable.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FEVENT-RESTARTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FPRINTING-EVENTS-20MGL-PAX-3ASECTION-29" title="Printing Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FEVENT-RESTARTS-20MGL-PAX-3ASECTION-29" title="Event Restarts">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L208">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FEVENT-RESTARTS-20MGL-PAX-3ASECTION-29">4.5 Event Restarts</a></h3>

<p>Only <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a> is applicable to all <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s. See
<a href="#x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29" title="Check Restarts">Check Restarts</a>, <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">Trial Restarts</a> for more.</p>

<p><a id='x-28TRY-3ARECORD-EVENT-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L213">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" >RECORD-EVENT</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>This restart is always the first restart available when an <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> is
signalled running under <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> (i.e. there is a <a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>). <code>TRY</code>
always invokes <code>RECORD-EVENT</code> when handling events.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FEVENT-RESTARTS-20MGL-PAX-3ASECTION-29" title="Event Restarts">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29" title="Outcome Restarts">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L3">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29">4.6 Outcomes</a></h3>

<p><a id='x-28TRY-3AOUTCOME-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L12">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AOUTCOME-20CONDITION-29" >OUTCOME</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p>An <code>OUTCOME</code> is the resolution of either a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> or a
check (see <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">Checks</a>), corresponding to subclasses <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> and
<a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AWITH-EXPECTED-OUTCOME-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L20">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AWITH-EXPECTED-OUTCOME-20MGL-PAX-3AMACRO-29" >WITH-EXPECTED-OUTCOME</a></span></span> <span class="locative-args">(EXPECTED-TYPE) &amp;BODY BODY</span></span></p>

<p>When an <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> is to be signalled, <code>EXPECTED-TYPE</code> determines
whether it's going to be <a href="#x-28TRY-3AEXPECTED-20CONDITION-29" title="(TRY:EXPECTED CONDITION)"><code>EXPECTED</code></a>. The concrete <code>OUTCOME</code> classes are
<code>{EXPECTED,UNEXPECTED}-{RESULT,VERDICT}-{SUCCESS,FAILURE}</code> (see
<a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">Events</a>), of which <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a> or <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> and <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a> or <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a> are
already known. If a <code>RESULT</code> <code>FAILURE</code> is to be signalled, then the
moral equivalent of <code>(SUBTYPEP '(AND RESULT FAILURE) EXPECTED-TYPE)</code>
is evaluated and depending on whether it's true,
<a href="#x-28TRY-3AEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:EXPECTED-RESULT-FAILURE CONDITION)"><code>EXPECTED-RESULT-FAILURE</code></a> or <a href="#x-28TRY-3AUNEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-FAILURE CONDITION)"><code>UNEXPECTED-RESULT-FAILURE</code></a> is signalled.</p>

<p>By default, <code>SUCCESS</code> is expected. The following example shows how to
expect both <code>SUCCESS</code> and <code>FAILURE</code> for <code>RESULT</code>s, while requiring
<code>VERDICT</code>s to succeed:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-expected-outcome</span></i> <span class="paren3">(<span class="code">'<span class="paren4">(<span class="code">or result <span class="paren5">(<span class="code">and verdict success</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">t1</span>)</span>
      <span class="paren4">(<span class="code">is nil</span>)</span></span>)</span></span>)</span></span>)</span>
.. T1
..   × <span class="paren1">(<span class="code">IS NIL</span>)</span>
.. ⋅ T1 ×1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">T1</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ×1&gt;</span></code></pre>

<p>This is equivalent to <code>(WITH-FAILURE-EXPECTED () ...)</code>. To make
result failures expected but result successes unexpected:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-expected-outcome</span></i> <span class="paren3">(<span class="code">'<span class="paren4">(<span class="code">or <span class="paren5">(<span class="code">and result failure</span>)</span> <span class="paren5">(<span class="code">and verdict success</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">t1</span>)</span>
      <span class="paren4">(<span class="code">is t</span>)</span>
      <span class="paren4">(<span class="code">is nil</span>)</span></span>)</span></span>)</span></span>)</span>
.. T1
..   ⊡ <span class="paren1">(<span class="code">IS T</span>)</span>
..   × <span class="paren1">(<span class="code">IS NIL</span>)</span>
.. ⋅ T1 ⊡1 ×1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">T1</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⊡1 ×1&gt;</span></code></pre>

<p>This is equivalent to <code>(WITH-FAILURE-EXPECTED ('FAILURE) ...)</code>. The
final example leaves result failures unexpected but makes both
verdict successes and failures expected:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-expected-outcome</span></i> <span class="paren3">(<span class="code">'<span class="paren4">(<span class="code">or <span class="paren5">(<span class="code">and result success</span>)</span> verdict</span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">t1</span>)</span>
      <span class="paren4">(<span class="code">is nil</span>)</span></span>)</span></span>)</span></span>)</span>
.. T1
..   ⊠ <span class="paren1">(<span class="code">IS NIL</span>)</span>
.. × T1 ⊠1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">T1</span>)</span></span>)</span> EXPECTED-FAILURE 0.004s ⊠1&gt;</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3AWITH-FAILURE-EXPECTED-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L82">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AWITH-FAILURE-EXPECTED-20MGL-PAX-3AMACRO-29" >WITH-FAILURE-EXPECTED</a></span></span> <span class="locative-args">(&amp;OPTIONAL (RESULT-EXPECTED-TYPE <code>T</code>) (VERDICT-EXPECTED-TYPE ''<a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a>)) &amp;BODY BODY</span></span></p>

<p>A convenience macro on top of <a href="#x-28TRY-3AWITH-EXPECTED-OUTCOME-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-EXPECTED-OUTCOME MGL-PAX:MACRO)"><code>WITH-EXPECTED-OUTCOME</code></a>,
<code>WITH-FAILURE-EXPECTED</code> expects <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>s to have <code>VERDICT-EXPECTED-TYPE</code>
and <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>s to have <code>RESULT-EXPECTED-TYPE</code>. A simple
<code>(WITH-FAILURE-EXPECTED () ...)</code> makes all <code>RESULT</code> <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a>es and
<a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>s <a href="#x-28TRY-3AEXPECTED-20CONDITION-29" title="(TRY:EXPECTED CONDITION)"><code>EXPECTED</code></a>. <code>(WITH-FAILURE-EXPECTED ('FAILURE) ..)</code> expects
<code>FAILURE</code>s only, and any <code>SUCCESS</code>es will be <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AWITH-SKIP-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L128">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AWITH-SKIP-20MGL-PAX-3AMACRO-29" >WITH-SKIP</a></span></span> <span class="locative-args">(&amp;OPTIONAL (SKIP <code>T</code>)) &amp;BODY BODY</span></span></p>

<p><code>WITH-SKIP</code> skips checks and trials. It forces an immediate
<a href="#x-28TRY-3ASKIP-TRIAL-20FUNCTION-29" title="(TRY:SKIP-TRIAL FUNCTION)"><code>SKIP-TRIAL</code></a> whenever a trial is started (which turns into a
<a href="#x-28TRY-3AVERDICT-SKIP-20CONDITION-29" title="(TRY:VERDICT-SKIP CONDITION)"><code>VERDICT-SKIP</code></a>) and makes checks (without intervening trials, of
course) evaluate normally but signal <a href="#x-28TRY-3ARESULT-SKIP-20CONDITION-29" title="(TRY:RESULT-SKIP CONDITION)"><code>RESULT-SKIP</code></a>. <code>SKIP</code> is <code>NIL</code>
cancels the effect of any enclosing <code>WITH-SKIP</code> with <code>SKIP</code> true.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29" title="Outcome Restarts">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L242">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29">4.6.1 Outcome Restarts</a></h4>

<p><a id='x-28TRY-3AFORCE-EXPECTED-SUCCESS-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L248">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFORCE-EXPECTED-SUCCESS-20FUNCTION-29" >FORCE-EXPECTED-SUCCESS</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>Change the type of the <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> being signalled to <a href="#x-28TRY-3AEXPECTED-20CONDITION-29" title="(TRY:EXPECTED CONDITION)"><code>EXPECTED</code></a> and
<a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a>. If the original condition is a <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>, then this will be
<a href="#x-28TRY-3AEXPECTED-RESULT-SUCCESS-20CONDITION-29" title="(TRY:EXPECTED-RESULT-SUCCESS CONDITION)"><code>EXPECTED-RESULT-SUCCESS</code></a>, if it is a <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>, then
<a href="#x-28TRY-3AEXPECTED-VERDICT-SUCCESS-20CONDITION-29" title="(TRY:EXPECTED-VERDICT-SUCCESS CONDITION)"><code>EXPECTED-VERDICT-SUCCESS</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AFORCE-UNEXPECTED-SUCCESS-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L256">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFORCE-UNEXPECTED-SUCCESS-20FUNCTION-29" >FORCE-UNEXPECTED-SUCCESS</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>Change the type of <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> being signalled to <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> and
<a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AFORCE-EXPECTED-FAILURE-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L262">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFORCE-EXPECTED-FAILURE-20FUNCTION-29" >FORCE-EXPECTED-FAILURE</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>Change the type of <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> being signalled to <a href="#x-28TRY-3AEXPECTED-20CONDITION-29" title="(TRY:EXPECTED CONDITION)"><code>EXPECTED</code></a> and
<a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AFORCE-UNEXPECTED-FAILURE-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L268">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFORCE-UNEXPECTED-FAILURE-20FUNCTION-29" >FORCE-UNEXPECTED-FAILURE</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>Change the type of <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> being signalled to <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> and
<a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29" title="Outcome Restarts">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29" title="Check Restarts">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L275">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29">4.6.2 Checks</a></h4>

<p>Checks are like <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_assert.htm" title="(ASSERT MGL-PAX:MACRO)"><code>CL:ASSERT</code></a>s, they check whether some condition holds
and signal an <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>. The outcome signalled for checks is a
subclass of <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>.</p>

<p>Take, for example, <code>(IS (= X 5))</code>. Depending on whether <code>X</code> is
indeed 5, some kind of <code>RESULT</code> <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a> or <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a> will be signalled.
<a href="#x-28TRY-3AWITH-EXPECTED-OUTCOME-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-EXPECTED-OUTCOME MGL-PAX:MACRO)"><code>WITH-EXPECTED-OUTCOME</code></a> determines whether it's <a href="#x-28TRY-3AEXPECTED-20CONDITION-29" title="(TRY:EXPECTED CONDITION)"><code>EXPECTED</code></a> or
<a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>, and we have one of <a href="#x-28TRY-3AEXPECTED-RESULT-SUCCESS-20CONDITION-29" title="(TRY:EXPECTED-RESULT-SUCCESS CONDITION)"><code>EXPECTED-RESULT-SUCCESS</code></a>,
<a href="#x-28TRY-3AUNEXPECTED-RESULT-SUCCESS-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-SUCCESS CONDITION)"><code>UNEXPECTED-RESULT-SUCCESS</code></a>, <a href="#x-28TRY-3AEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:EXPECTED-RESULT-FAILURE CONDITION)"><code>EXPECTED-RESULT-FAILURE</code></a>,
<a href="#x-28TRY-3AUNEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-FAILURE CONDITION)"><code>UNEXPECTED-RESULT-FAILURE</code></a> to signal. Furthermore, if <a href="#x-28TRY-3AWITH-SKIP-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-SKIP MGL-PAX:MACRO)"><code>WITH-SKIP</code></a> is in
effect, then <a href="#x-28TRY-3ARESULT-SKIP-20CONDITION-29" title="(TRY:RESULT-SKIP CONDITION)"><code>RESULT-SKIP</code></a> is signalled.</p>

<p>The result is signalled with <code>#'SIGNAL</code> if it is a <a href="#x-28TRY-3APASS-20TYPE-29" title="(TRY:PASS TYPE)"><code>PASS</code></a>, else it's
signalled with <code>#'ERROR</code>. This distinction matters only if the event
is not handled, which is never the case in a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>. Standalone
checks though - those that are not enclosed by a trial - invoke the
debugger on <code>RESULT</code>s which are not of type <code>PASS</code>.</p>

<p>The signalled <code>RESULT</code> is not final until <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a> is invoked on
it, and it can be changed with the <a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29" title="Outcome Restarts">Outcome Restarts</a> and the
<a href="#x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29" title="Check Restarts">Check Restarts</a>.</p>

<p><a id='x-28TRY-3ARESULT-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/result.lisp#L3">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARESULT-20CONDITION-29" >RESULT</a></span></span> <span class="locative-args">LEAF OUTCOME</span></span></li>
</ul>

<p><a id='x-28TRY-3AEXPECTED-RESULT-SUCCESS-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/result.lisp#L15">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEXPECTED-RESULT-SUCCESS-20CONDITION-29" >EXPECTED-RESULT-SUCCESS</a></span></span> <span class="locative-args">EXPECTED RESULT SUCCESS</span></span></li>
</ul>

<p><a id='x-28TRY-3AUNEXPECTED-RESULT-SUCCESS-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/result.lisp#L16">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNEXPECTED-RESULT-SUCCESS-20CONDITION-29" >UNEXPECTED-RESULT-SUCCESS</a></span></span> <span class="locative-args">UNEXPECTED RESULT SUCCESS</span></span></li>
</ul>

<p><a id='x-28TRY-3AEXPECTED-RESULT-FAILURE-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/result.lisp#L17">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEXPECTED-RESULT-FAILURE-20CONDITION-29" >EXPECTED-RESULT-FAILURE</a></span></span> <span class="locative-args">EXPECTED RESULT FAILURE</span></span></li>
</ul>

<p><a id='x-28TRY-3AUNEXPECTED-RESULT-FAILURE-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/result.lisp#L18">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNEXPECTED-RESULT-FAILURE-20CONDITION-29" >UNEXPECTED-RESULT-FAILURE</a></span></span> <span class="locative-args">UNEXPECTED RESULT FAILURE</span></span></li>
</ul>

<p><a id='x-28TRY-3ARESULT-SKIP-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/result.lisp#L19">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARESULT-SKIP-20CONDITION-29" >RESULT-SKIP</a></span></span> <span class="locative-args">RESULT SKIP</span></span></li>
</ul>

<p><a id='x-28TRY-3ARESULT-ABORT-2A-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/result.lisp#L20">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARESULT-ABORT-2A-20CONDITION-29" >RESULT-ABORT*</a></span></span> <span class="locative-args">RESULT ABORT* DISMISSAL</span></span></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29" title="Trials">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29" title="Check Restarts">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L306">&#955;</a></span></span></p>

<h5><a href="#x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29">Check Restarts</a></h5>

<p><a id='x-28TRY-3AABORT-CHECK-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L311">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AABORT-CHECK-20FUNCTION-29" >ABORT-CHECK</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>Change the <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> of the check being signalled to <a href="#x-28TRY-3ARESULT-ABORT-2A-20CONDITION-29" title="(TRY:RESULT-ABORT* CONDITION)"><code>RESULT-ABORT*</code></a>.
<code>RESULT-ABORT*</code>, being <code>(NOT PASS)</code>, will cause the check to return
<code>NIL</code> if <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a> is invoked on it.</p></li>
</ul>

<p><a id='x-28TRY-3ASKIP-CHECK-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L318">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASKIP-CHECK-20FUNCTION-29" >SKIP-CHECK</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>Change the <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> of the check being signalled to <a href="#x-28TRY-3ARESULT-SKIP-20CONDITION-29" title="(TRY:RESULT-SKIP CONDITION)"><code>RESULT-SKIP</code></a>.
<code>RESULT-SKIP</code>, being a <a href="#x-28TRY-3APASS-20TYPE-29" title="(TRY:PASS TYPE)"><code>PASS</code></a>, will cause the check to return <code>T</code> if
<code>CONTINUE</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_abortc.htm" title="(CONTINUE FUNCTION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/r_contin.htm" title="(CONTINUE RESTART)"><code>1</code></a>) or <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a> is invoked on it.</p></li>
</ul>

<p><a id='x-28TRY-3ARETRY-CHECK-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/outcome.lisp#L325">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARETRY-CHECK-20FUNCTION-29" >RETRY-CHECK</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION</span></span></p>

<p>Initiate a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> to go reevaluate the forms wrapped by
the check without signalling an <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29" title="Check Restarts">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FTRIAL-EVENTS-20MGL-PAX-3ASECTION-29" title="Trial Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29" title="Trials">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L5">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29">4.6.3 Trials</a></h4>

<p><a id='x-28TRY-3ATRIAL-20TYPE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L14">[type]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATRIAL-20TYPE-29" >TRIAL</a></span></span></span></p>

<p>Trials are records of calls to tests (see
<a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">Counting Events</a>, <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">Collecting Events</a>). Their behaviour as <a href="#x-28TRY-3A-3A-40FUNCALLABLE-INSTANCE-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@FUNCALLABLE-INSTANCE MGL-PAX:GLOSSARY-TERM)">funcallable instance</a>s
is explained in <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>.</p>

<p>There are three ways to acquire a <code>TRIAL</code> object: by calling
<a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>, through the lexical binding of the symbol that names
the test or through the return value of a test:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> xxx <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">prin1 xxx</span>)</span></span>)</span>

<span class="paren1">(<span class="code">xxx</span>)</span>
.. #&lt;TRIAL <span class="paren1">(<span class="code">XXX</span>)</span> RUNNING&gt;
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">XXX</span>)</span> EXPECTED-SUCCESS 0.000s&gt;</span></code></pre>

<p><code>WITH-TRIAL</code> can also provide access to its <code>TRIAL</code>:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">t0</span>)</span>
  <span class="paren2">(<span class="code">prin1 t0</span>)</span></span>)</span>
.. #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">T0</span>)</span></span>)</span> RUNNING&gt;
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">T0</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s&gt;</span></code></pre>

<p><code>TRIAL</code>s are not to be instantiated by client code.</p></li>
</ul>

<p><a id='x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L168">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" >CURRENT-TRIAL</a></span></span> <span class="locative-args"></span></span></p>

<p><a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>s, like the calls to tests they stand for, nest. <code>CURRENT-TRIAL</code>
returns the innermost trial. If there is no currently running test,
then an error is signalled. The returned trial is <a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" title="(TRY:RUNNINGP FUNCTION)"><code>RUNNINGP</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FTRIAL-EVENTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29" title="Trials">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29" title="Trials">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FTRIAL-VERDICTS-20MGL-PAX-3ASECTION-29" title="Trial Verdicts">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FTRIAL-EVENTS-20MGL-PAX-3ASECTION-29" title="Trial Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L5">&#955;</a></span></span></p>

<h5><a href="#x-28TRY-3A-40TRY-2FTRIAL-EVENTS-20MGL-PAX-3ASECTION-29">Trial Events</a></h5>

<p><a id='x-28TRY-3ATRIAL-EVENT-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L17">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATRIAL-EVENT-20CONDITION-29" >TRIAL-EVENT</a></span></span> <span class="locative-args">EVENT</span></span></p>

<p>A <code>TRIAL-EVENT</code> is either a <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> or a
<a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3ATRIAL-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-EVENT-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L17">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATRIAL-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-EVENT-29-29" >TRIAL</a></span></span> <span class="locative-args">TRIAL-EVENT</span> <span class="locative-args">(:TRIAL)</span></span></li>
</ul>

<p><a id='x-28TRY-3ATRIAL-START-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L24">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" >TRIAL-START</a></span></span> <span class="locative-args">TRIAL-EVENT</span></span></p>

<p><code>TRIAL-START</code> is signalled when a test function
(see <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">Tests</a>) is entered and a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> is started, it is already
the <a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>, and the <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">Trial Restarts</a> are available. It is
also signalled when a trial is retried:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code"></span>)</span>
    <span class="paren3">(<span class="code">handler-bind <span class="paren4">(<span class="code"><span class="paren5">(<span class="code">trial-start <span class="paren6">(<span class="code"><i><span class="symbol">lambda</span></i> <span class="paren1">(<span class="code">c</span>)</span>
                                  <span class="paren1">(<span class="code">format t <span class="string">"TRIAL-START for ~S retry#~S~%"</span>
                                          <span class="paren2">(<span class="code">test-name <span class="paren3">(<span class="code">trial c</span>)</span></span>)</span>
                                          <span class="paren2">(<span class="code">n-retries <span class="paren3">(<span class="code">trial c</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
      <span class="paren4">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren5">(<span class="code">this</span>)</span>
        <span class="paren5">(<span class="code">when <span class="paren6">(<span class="code">zerop <span class="paren1">(<span class="code">random 2</span>)</span></span>)</span>
          <span class="paren6">(<span class="code">retry-trial</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
.. TRIAL-START for THIS retry#0
.. TRIAL-START for THIS retry#1
.. TRIAL-START for THIS retry#2
..</span></code></pre>

<p>The matching of <code>TRIAL-START</code> events is less straightforward than that
of other <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s.</p>

<ul>
<li><p>When a <code>TRIAL-START</code> event matches the <code>COLLECT</code> type (see
  <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">Collecting Events</a>), its <a href="#x-28TRY-3ATRIAL-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-EVENT-29-29" title="(TRY:TRIAL (MGL-PAX:READER TRY:TRIAL-EVENT))"><code>TRIAL</code></a> is collected.</p></li>
<li><p>Similarly, when a <code>TRIAL-START</code> matches the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_wr_pr.htm" title="(PRINT FUNCTION)"><code>PRINT</code></a> type (see
  <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">Printing Events</a>), it is printed immediately, and its trial's <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>
  will be printed too regardless of whether it matches <code>PRINT</code>. If
  <code>TRIAL-START</code> does not match <code>PRINT</code>, it may still be printed if for
  example <a href="#x-28TRY-3A-2APRINT-PARENT-2A-20VARIABLE-29" title="(TRY:*PRINT-PARENT* VARIABLE)"><code>*PRINT-PARENT*</code></a> requires it.</p></li>
<li><p>When a <code>TRIAL-START</code> matches the <code>RERUN</code> type (see <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>), its
  <a href="#x-28TRY-3ATRIAL-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-EVENT-29-29" title="(TRY:TRIAL (MGL-PAX:READER TRY:TRIAL-EVENT))"><code>TRIAL</code></a> may be rerun.</p></li>
<li><p>Also, see <a href="#x-28TRY-3AWITH-SKIP-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-SKIP MGL-PAX:MACRO)"><code>WITH-SKIP</code></a>.</p></li>
</ul></li>
</ul>

<p><a id='x-28TRY-3AVERDICT-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L68">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AVERDICT-20CONDITION-29" >VERDICT</a></span></span> <span class="locative-args">TRIAL-EVENT OUTCOME</span></span></p>

<p>A <code>VERDICT</code> is the <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> of a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>. It is one of
<code>{EXPECTED,UNEXPECTED}-VERDICT-{SUCCESS,FAILURE}</code>, <a href="#x-28TRY-3AVERDICT-SKIP-20CONDITION-29" title="(TRY:VERDICT-SKIP CONDITION)"><code>VERDICT-SKIP</code></a> and
<a href="#x-28TRY-3AVERDICT-ABORT-2A-20CONDITION-29" title="(TRY:VERDICT-ABORT* CONDITION)"><code>VERDICT-ABORT*</code></a>. Regarding how the verdict type is determined, see
<a href="#x-28TRY-3A-40TRY-2FTRIAL-VERDICTS-20MGL-PAX-3ASECTION-29" title="Trial Verdicts">Trial Verdicts</a>.</p>

<p>Verdicts are signalled while their <a href="#x-28TRY-3ATRIAL-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-EVENT-29-29" title="(TRY:TRIAL (MGL-PAX:READER TRY:TRIAL-EVENT))"><code>TRIAL</code></a> is
still the <a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>, and <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">Trial Restarts</a> are still
available.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">try <span class="paren2">(<span class="code"><i><span class="symbol">lambda</span></i> <span class="paren3">(<span class="code"></span>)</span>
       <span class="paren3">(<span class="code">handler-bind <span class="paren4">(<span class="code"><span class="paren5">(<span class="code"><span class="paren6">(<span class="code">and verdict failure</span>)</span> #'retry-trial</span>)</span></span>)</span>
         <span class="paren4">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren5">(<span class="code">this</span>)</span>
           <span class="paren5">(<span class="code">is <span class="paren6">(<span class="code">zerop <span class="paren1">(<span class="code">random 2</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
.. <span class="paren1">(<span class="code">TRY #&lt;<i><span class="symbol">FUNCTION</span></i> <span class="paren2">(<span class="code"><i><span class="symbol">LAMBDA</span></i> <span class="paren3">(<span class="code"></span>)</span></span>)</span> {53038ADB}&gt;</span>)</span>
..   THIS
..     ⊠ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">ZEROP #1=<span class="paren3">(<span class="code">RANDOM 2</span>)</span></span>)</span></span>)</span>
..       where
..         #1# = 1
..   THIS retry #1
..     ⋅ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">ZEROP <span class="paren3">(<span class="code">RANDOM 2</span>)</span></span>)</span></span>)</span>
..   ⋅ THIS ⋅1
.. ⋅ <span class="paren1">(<span class="code">TRY #&lt;<i><span class="symbol">FUNCTION</span></i> <span class="paren2">(<span class="code"><i><span class="symbol">LAMBDA</span></i> <span class="paren3">(<span class="code"></span>)</span></span>)</span> {53038ADB}&gt;</span>)</span> ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">TRY #&lt;<i><span class="symbol">FUNCTION</span></i> <span class="paren2">(<span class="code"><i><span class="symbol">LAMBDA</span></i> <span class="paren3">(<span class="code"></span>)</span></span>)</span> {53038ADB}&gt;</span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3AEXPECTED-VERDICT-SUCCESS-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L111">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEXPECTED-VERDICT-SUCCESS-20CONDITION-29" >EXPECTED-VERDICT-SUCCESS</a></span></span> <span class="locative-args">EXPECTED VERDICT SUCCESS</span></span></li>
</ul>

<p><a id='x-28TRY-3AUNEXPECTED-VERDICT-SUCCESS-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L112">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNEXPECTED-VERDICT-SUCCESS-20CONDITION-29" >UNEXPECTED-VERDICT-SUCCESS</a></span></span> <span class="locative-args">UNEXPECTED VERDICT SUCCESS</span></span></li>
</ul>

<p><a id='x-28TRY-3AEXPECTED-VERDICT-FAILURE-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L113">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AEXPECTED-VERDICT-FAILURE-20CONDITION-29" >EXPECTED-VERDICT-FAILURE</a></span></span> <span class="locative-args">EXPECTED VERDICT FAILURE</span></span></li>
</ul>

<p><a id='x-28TRY-3AUNEXPECTED-VERDICT-FAILURE-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L114">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNEXPECTED-VERDICT-FAILURE-20CONDITION-29" >UNEXPECTED-VERDICT-FAILURE</a></span></span> <span class="locative-args">UNEXPECTED VERDICT FAILURE</span></span></li>
</ul>

<p><a id='x-28TRY-3AVERDICT-SKIP-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L115">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AVERDICT-SKIP-20CONDITION-29" >VERDICT-SKIP</a></span></span> <span class="locative-args">VERDICT SKIP</span></span></li>
</ul>

<p><a id='x-28TRY-3AVERDICT-ABORT-2A-20CONDITION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial-event.lisp#L116">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AVERDICT-ABORT-2A-20CONDITION-29" >VERDICT-ABORT*</a></span></span> <span class="locative-args">VERDICT ABORT* DISMISSAL</span></span></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FTRIAL-VERDICTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FTRIAL-EVENTS-20MGL-PAX-3ASECTION-29" title="Trial Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29" title="Trials">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FTRIAL-VERDICTS-20MGL-PAX-3ASECTION-29" title="Trial Verdicts">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L195">&#955;</a></span></span></p>

<h5><a href="#x-28TRY-3A-40TRY-2FTRIAL-VERDICTS-20MGL-PAX-3ASECTION-29">Trial Verdicts</a></h5>

<p>When a trial finished, a <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> is signalled. The verdict's type
is determined as follows.</p>

<ul>
<li><p>It is a <a href="#x-28TRY-3AVERDICT-SKIP-20CONDITION-29" title="(TRY:VERDICT-SKIP CONDITION)"><code>VERDICT-SKIP</code></a> if</p>

<ul>
<li><p><a href="#x-28TRY-3ASKIP-TRIAL-20FUNCTION-29" title="(TRY:SKIP-TRIAL FUNCTION)"><code>SKIP-TRIAL</code></a> was called on the trial, or</p></li>
<li><p><a href="#x-28TRY-3AABORT-TRIAL-20FUNCTION-29" title="(TRY:ABORT-TRIAL FUNCTION)"><code>ABORT-TRIAL</code></a>, <code>SKIP-TRIAL</code>, or <a href="#x-28TRY-3ARETRY-TRIAL-20FUNCTION-29" title="(TRY:RETRY-TRIAL FUNCTION)"><code>RETRY-TRIAL</code></a> was called on an
  enclosing trial, and</p></li>
<li><p>these were not overruled by a later <code>ABORT-TRIAL</code> or <code>RETRY-TRIAL</code>
  on the trial.</p></li>
</ul></li>
<li><p>It is a <a href="#x-28TRY-3AVERDICT-ABORT-2A-20CONDITION-29" title="(TRY:VERDICT-ABORT* CONDITION)"><code>VERDICT-ABORT*</code></a> if <code>ABORT-TRIAL</code> was called on the trial, and
  it wasn't overruled by a later <code>SKIP-TRIAL</code> or <code>RETRY-TRIAL</code>.</p></li>
<li><p>If all children (including those not collected in <a href="#x-28TRY-3ACHILDREN-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" title="(TRY:CHILDREN (MGL-PAX:READER TRY:TRIAL))"><code>CHILDREN</code></a>) of the
  trial <a href="#x-28TRY-3APASS-20TYPE-29" title="(TRY:PASS TYPE)"><code>PASS</code></a>, then the verdict will be a <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a>, else it will be a
  <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a>.</p></li>
<li><p>Subject to the <a href="#x-28TRY-3AWITH-EXPECTED-OUTCOME-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-EXPECTED-OUTCOME MGL-PAX:MACRO)"><code>WITH-EXPECTED-OUTCOME</code></a> in effect,
  <code>{EXPECTED,UNEXPECTED}-VERDICT-{SUCCESS,FAILURE}</code> is the type of
  the verdict which will be signalled.</p></li>
</ul>

<p>The verdict of this type is signalled, but its type can be changed
by the <a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29" title="Outcome Restarts">Outcome Restarts</a> or the <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">Trial Restarts</a> before
<a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a> is invoked on it.</p>

<p><a id='x-28TRY-3AVERDICT-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L76">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3AVERDICT-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" >VERDICT</a></span></span> <span class="locative-args">TRIAL</span> <span class="locative-args">(= <code>NIL</code>)</span></span></p>

<p>The <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> signalled when this
<code>TRIAL</code> finished or <code>NIL</code> if it has not finished yet.</p></li>
</ul>

<p><a id='x-28TRY-3ARUNNINGP-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L226">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" >RUNNINGP</a></span></span> <span class="locative-args">TRIAL</span></span></p>

<p>See if the function call associated with <code>TRIAL</code> has not returned yet.
Trials that are not running have a <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> and are said to be
finished.</p></li>
</ul>

<p><a id='x-28TRY-3APASSEDP-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L232">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3APASSEDP-20FUNCTION-29" >PASSEDP</a></span></span> <span class="locative-args">TRIAL</span></span></p>

<p>See if <code>TRIAL</code> has finished and its <a href="#x-28TRY-3AVERDICT-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" title="(TRY:VERDICT (MGL-PAX:READER TRY:TRIAL))"><code>VERDICT</code></a> is a
<a href="#x-28TRY-3APASS-20TYPE-29" title="(TRY:PASS TYPE)"><code>PASS</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AFAILEDP-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L237">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFAILEDP-20FUNCTION-29" >FAILEDP</a></span></span> <span class="locative-args">TRIAL</span></span></p>

<p>See if <code>TRIAL</code> has finished and its <a href="#x-28TRY-3AVERDICT-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" title="(TRY:VERDICT (MGL-PAX:READER TRY:TRIAL))"><code>VERDICT</code></a> is a
<a href="#x-28TRY-3AFAIL-20TYPE-29" title="(TRY:FAIL TYPE)"><code>FAIL</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FTRIAL-VERDICTS-20MGL-PAX-3ASECTION-29" title="Trial Verdicts">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTRIALS-20MGL-PAX-3ASECTION-29" title="Trials">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FERRORS-20MGL-PAX-3ASECTION-29" title="Errors">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L305">&#955;</a></span></span></p>

<h5><a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29">Trial Restarts</a></h5>

<p>There are three restarts available for manipulating running
trials: <a href="#x-28TRY-3AABORT-TRIAL-20FUNCTION-29" title="(TRY:ABORT-TRIAL FUNCTION)"><code>ABORT-TRIAL</code></a>, <a href="#x-28TRY-3ASKIP-TRIAL-20FUNCTION-29" title="(TRY:SKIP-TRIAL FUNCTION)"><code>SKIP-TRIAL</code></a>, and <a href="#x-28TRY-3ARETRY-TRIAL-20FUNCTION-29" title="(TRY:RETRY-TRIAL FUNCTION)"><code>RETRY-TRIAL</code></a>. They may be
invoked programatically or from the debugger. <code>ABORT-TRIAL</code> is also
invoked by <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> when encountering <a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>.</p>

<p>The functions below invoke one of these restarts associated with a
<a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>. It is an error to call them on trials that are not <a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" title="(TRY:RUNNINGP FUNCTION)"><code>RUNNINGP</code></a>,
but they may be called on trials other than the <a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>. In
that case, any intervening trials are skipped.</p>

<pre><code><span class="code"><span class="comment">;; Skipped trials are marked with '-' in the output.
</span><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">outer</span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">inner</span>)</span>
    <span class="paren3">(<span class="code">is t</span>)</span>
    <span class="paren3">(<span class="code">skip-trial nil outer</span>)</span></span>)</span></span>)</span>
.. OUTER
..   INNER
..     ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..   - INNER ⋅1
.. - OUTER ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">OUTER</span>)</span></span>)</span> SKIP 0.000s ⋅1&gt;</span></code></pre>

<p>Furthermore, all three restarts initiate a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> to return
from the trial. If during the unwinding of the stack, the
non-local-exit is cancelled (see <a href="#x-28TRY-3A-3A-40CANCELLED-NLX-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@CANCELLED-NLX MGL-PAX:GLOSSARY-TERM)">cancelled non-local exit</a>), the appropriate
restart will be invoked upon returning from the trial. In the
following example, the non-local exit from a skip is cancelled by a
<a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_throw.htm" title="(THROW MGL-PAX:MACRO)"><code>THROW</code></a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">some-test</span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">catch</span></i> 'foo
    <span class="paren3">(<span class="code"><i><span class="symbol">unwind-protect</span></i>
         <span class="paren4">(<span class="code">skip-trial</span>)</span>
      <span class="paren4">(<span class="code"><i><span class="symbol">throw</span></i> 'foo nil</span>)</span></span>)</span></span>)</span>
  <span class="paren2">(<span class="code">is t <span class="keyword">:msg</span> <span class="string">"check after skip"</span></span>)</span></span>)</span>
.. SOME-TEST
..   ⋅ check after skip
.. - SOME-TEST ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">SOME-TEST</span>)</span></span>)</span> SKIP 0.000s ⋅1&gt;</span></code></pre>

<p>In the next example, the non-local exit from a skip is cancelled by
an <code>ERROR</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm" title="(ERROR CONDITION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_error.htm" title="(ERROR FUNCTION)"><code>1</code></a>), which triggers an <code>ABORT-TRIAL</code>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*describe*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">foo</span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">unwind-protect</span></i>
         <span class="paren4">(<span class="code">skip-trial</span>)</span>
      <span class="paren4">(<span class="code">error <span class="string">"xxx"</span></span>)</span></span>)</span></span>)</span></span>)</span>
.. FOO
..   ⊟ "xxx" <span class="paren1">(<span class="code">SIMPLE-ERROR</span>)</span>
.. ⊟ FOO ⊟1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">FOO</span>)</span></span>)</span> ABORT* 0.000s ⊟1&gt;</span></code></pre>

<p>All three restarts may be invoked on any <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>, including the
trial's own <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> and <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>. If <code>CONDITION</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_cnd.htm" title="(CONDITION CONDITION)"><code>0</code></a> <a href="mgl-pax-manual.html#x-28CONDITION-20MGL-PAX-3ALOCATIVE-29" title="(CONDITION MGL-PAX:LOCATIVE)"><code>1</code></a>) is an <code>EVENT</code>
(<code>RETRY-TRIAL</code> has a special case here), they also record it (as in
<a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a>) to ensure that when they handle an <code>EVENT</code> in the
debugger or programatically that event is not dropped.</p>

<p><a id='x-28TRY-3AABORT-TRIAL-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L380">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AABORT-TRIAL-20FUNCTION-29" >ABORT-TRIAL</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION (TRIAL (<a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>))</span></span></p>

<p>Invoke the <code>ABORT-TRIAL</code> restart of a <a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" title="(TRY:RUNNINGP FUNCTION)"><code>RUNNINGP</code></a> <code>TRIAL</code>.</p>

<p>When <code>CONDITION</code> is a <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> for <code>TRIAL</code>, <code>ABORT-TRIAL</code> signals a new
verdict of type VERDICT-ABORT<em>. This behavior is similar to that of
<a href="#x-28TRY-3AABORT-CHECK-20FUNCTION-29" title="(TRY:ABORT-CHECK FUNCTION)"><code>ABORT-CHECK</code></a>. Else, the <code>ABORT-TRIAL</code> restart may record <code>CONDITION</code>,
then it initiates a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> to return from the test function
with VERDICT-ABORT</em>. If during the unwinding <a href="#x-28TRY-3ASKIP-TRIAL-20FUNCTION-29" title="(TRY:SKIP-TRIAL FUNCTION)"><code>SKIP-TRIAL</code></a> or
<a href="#x-28TRY-3ARETRY-TRIAL-20FUNCTION-29" title="(TRY:RETRY-TRIAL FUNCTION)"><code>RETRY-TRIAL</code></a> is called, then the abort is cancelled.</p>

<p>Since <a href="#x-28TRY-3AABORT-2A-20CONDITION-29" title="(TRY:ABORT* CONDITION)"><code>ABORT*</code></a> is an <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>, <code>ABORT-TRIAL</code> is rarely used
programatically. Signalling any error in a trial that's not caught
before the trial's handler catches it will get turned into an
<a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>, and <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> will invoke <code>ABORT-TRIAL</code> with it. Thus,
instead of invoking <code>ABORT-TRIAL</code> directly, signalling an error will
often suffice.</p></li>
</ul>

<p><a id='x-28TRY-3ASKIP-TRIAL-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L400">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASKIP-TRIAL-20FUNCTION-29" >SKIP-TRIAL</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION (TRIAL (<a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>))</span></span></p>

<p>Invoke the <code>SKIP-TRIAL</code> restart of a <a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" title="(TRY:RUNNINGP FUNCTION)"><code>RUNNINGP</code></a> <code>TRIAL</code>.</p>

<p>When <code>CONDITION</code> is a <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> for <code>TRIAL</code>, <code>SKIP-TRIAL</code> signals a new
verdict of type <a href="#x-28TRY-3AVERDICT-SKIP-20CONDITION-29" title="(TRY:VERDICT-SKIP CONDITION)"><code>VERDICT-SKIP</code></a>. This behavior is similar to that of
<a href="#x-28TRY-3ASKIP-CHECK-20FUNCTION-29" title="(TRY:SKIP-CHECK FUNCTION)"><code>SKIP-CHECK</code></a>. Else, the <code>SKIP-TRIAL</code> restart may record <code>CONDITION</code>, then
it initiates a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> to return from the test function with
<code>VERDICT-SKIP</code>. If during the unwinding <a href="#x-28TRY-3AABORT-TRIAL-20FUNCTION-29" title="(TRY:ABORT-TRIAL FUNCTION)"><code>ABORT-TRIAL</code></a> or <a href="#x-28TRY-3ARETRY-TRIAL-20FUNCTION-29" title="(TRY:RETRY-TRIAL FUNCTION)"><code>RETRY-TRIAL</code></a> is
called, then the skip is cancelled.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">skipped</span>)</span>
  <span class="paren2">(<span class="code">handler-bind <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">unexpected-result-failure #'skip-trial</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">is nil</span>)</span></span>)</span></span>)</span>
.. SKIPPED
..   ⊠ <span class="paren1">(<span class="code">IS NIL</span>)</span>
.. - SKIPPED ⊠1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">SKIPPED</span>)</span></span>)</span> SKIP 0.000s ⊠1&gt;</span></code></pre>

<p>Invoking <code>SKIP-TRIAL</code> on the <code>TRIAL</code>'s own <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> skips the trial
being started.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print*</span> '<span class="paren4">(<span class="code">or outcome leaf</span>)</span></span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">parent</span>)</span>
    <span class="paren3">(<span class="code">handler-bind <span class="paren4">(<span class="code"><span class="paren5">(<span class="code">trial-start #'skip-trial</span>)</span></span>)</span>
      <span class="paren4">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren5">(<span class="code">child</span>)</span>
        <span class="paren5">(<span class="code">is nil</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
.. PARENT
..   - CHILD
.. ⋅ PARENT
..</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3ARETRY-TRIAL-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L440">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARETRY-TRIAL-20FUNCTION-29" >RETRY-TRIAL</a></span></span> <span class="locative-args">&amp;OPTIONAL CONDITION (TRIAL (<a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>))</span></span></p>

<p>Invoke the <code>RETRY-TRIAL</code> restart of <a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" title="(TRY:RUNNINGP FUNCTION)"><code>RUNNINGP</code></a> <code>TRIAL</code>. The <code>RETRY-TRIAL</code>
restart may record <code>CONDITION</code>, then it initiates a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> to
go back to the beginning of the test function. If the non-local exit
completes, then</p>

<ul>
<li><p>(<a href="#x-28TRY-3AN-RETRIES-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" title="(TRY:N-RETRIES (MGL-PAX:READER TRY:TRIAL))"><code>N-RETRIES</code></a> <code>TRIAL</code>) is incremented,</p></li>
<li><p>collected results and trials are cleared (see <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">Collecting Events</a>),</p></li>
<li><p>counts are zeroed (see <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">Counting Events</a>), and</p></li>
<li><p><a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> is signalled again.</p></li>
</ul>

<p>If during the unwinding <a href="#x-28TRY-3AABORT-TRIAL-20FUNCTION-29" title="(TRY:ABORT-TRIAL FUNCTION)"><code>ABORT-TRIAL</code></a> or <a href="#x-28TRY-3ASKIP-TRIAL-20FUNCTION-29" title="(TRY:SKIP-TRIAL FUNCTION)"><code>SKIP-TRIAL</code></a> is called, then
the retry is cancelled.</p>

<p><code>CONDITION</code> (which may be <code>NIL</code>) is recorded if it is an <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> but not
the <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> of <code>TRIAL</code>, and the <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a> restart is available.</p></li>
</ul>

<p><a id='x-28TRY-3AN-RETRIES-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L62">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3AN-RETRIES-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" >N-RETRIES</a></span></span> <span class="locative-args">TRIAL</span> <span class="locative-args">(:N-RETRIES = 0)</span></span></p>

<p>The number of times this <code>TRIAL</code> has
been retried. See <a href="#x-28TRY-3ARETRY-TRIAL-20FUNCTION-29" title="(TRY:RETRY-TRIAL FUNCTION)"><code>RETRY-TRIAL</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FERRORS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCATEGORIES-20MGL-PAX-3ASECTION-29" title="Categories">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FERRORS-20MGL-PAX-3ASECTION-29" title="Errors">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L3">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FERRORS-20MGL-PAX-3ASECTION-29">4.7 Errors</a></h3>

<p><a id='x-28TRY-3AERROR-2A-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L13">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AERROR-2A-20CONDITION-29" >ERROR*</a></span></span> <span class="locative-args">ABORT* TRIAL-EVENT LEAF</span></span></p>

<p>Either <a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a> or <a href="#x-28TRY-3ANLX-20CONDITION-29" title="(TRY:NLX CONDITION)"><code>NLX</code></a>, <code>ERROR*</code> causes or
represents abnormal termination of a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>. <a href="#x-28TRY-3AABORT-TRIAL-20FUNCTION-29" title="(TRY:ABORT-TRIAL FUNCTION)"><code>ABORT-TRIAL</code></a> can be
called with <code>ERROR*</code>s, but there is little need for explicitly doing
so as <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a>, which <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> invokes, takes care of this.</p></li>
</ul>

<p><a id='x-28TRY-3ATEST-NAME-20-28MGL-PAX-3AREADER-20TRY-3AERROR-2A-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L13">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATEST-NAME-20-28MGL-PAX-3AREADER-20TRY-3AERROR-2A-29-29" >TEST-NAME</a></span></span> <span class="locative-args">ERROR*</span> <span class="locative-args">(:TEST-NAME)</span></span></li>
</ul>

<p><a id='x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L20">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" >UNHANDLED-ERROR</a></span></span> <span class="locative-args">ERROR*</span></span></p>

<p>Signalled when an <a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm" title="(ERROR CONDITION)"><code>CL:ERROR</code></a> condition reaches the
handlers set up <a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" title="(TRY:DEFTEST MGL-PAX:MACRO)"><code>DEFTEST</code></a> or <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a>, or when their <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_debugg.htm" title="(*DEBUGGER-HOOK* VARIABLE)"><code>*DEBUGGER-HOOK*</code></a>
is invoked with a condition that's not an <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3ANESTED-CONDITION-20-28MGL-PAX-3AREADER-20TRY-3AUNHANDLED-ERROR-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L20">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3ANESTED-CONDITION-20-28MGL-PAX-3AREADER-20TRY-3AUNHANDLED-ERROR-29-29" >NESTED-CONDITION</a></span></span> <span class="locative-args">UNHANDLED-ERROR</span> <span class="locative-args">(:CONDITION = '<code>NIL</code>)</span></span></li>
</ul>

<p><a id='x-28TRY-3ABACKTRACE-OF-20-28MGL-PAX-3AREADER-20TRY-3AUNHANDLED-ERROR-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L20">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3ABACKTRACE-OF-20-28MGL-PAX-3AREADER-20TRY-3AUNHANDLED-ERROR-29-29" >BACKTRACE-OF</a></span></span> <span class="locative-args">UNHANDLED-ERROR</span> <span class="locative-args">(:BACKTRACE = '<code>NIL</code>)</span></span></li>
</ul>

<p><a id='x-28TRY-3ADEBUGGER-INVOKED-P-20-28MGL-PAX-3AREADER-20TRY-3AUNHANDLED-ERROR-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L20">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3ADEBUGGER-INVOKED-P-20-28MGL-PAX-3AREADER-20TRY-3AUNHANDLED-ERROR-29-29" >DEBUGGER-INVOKED-P</a></span></span> <span class="locative-args">UNHANDLED-ERROR</span> <span class="locative-args">(:DEBUGGER-INVOKED-P = '<code>NIL</code>)</span></span></li>
</ul>

<p><a id='x-28TRY-3A-2AGATHER-BACKTRACE-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L126">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AGATHER-BACKTRACE-2A-20VARIABLE-29" >*GATHER-BACKTRACE*</a></span></span> <span class="locative-args">T</span></span></p>

<p>Capturing the backtrace can be expensive. <code>*GATHER-BACKTRACE*</code>
controls whether <a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>s shall have their <a href="#x-28TRY-3ABACKTRACE-OF-20-28MGL-PAX-3AREADER-20TRY-3AUNHANDLED-ERROR-29-29" title="(TRY:BACKTRACE-OF (MGL-PAX:READER TRY:UNHANDLED-ERROR))"><code>BACKTRACE-OF</code></a>
populated.</p></li>
</ul>

<p><a id='x-28TRY-3ANLX-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/error.lisp#L37">[condition]</a></span> <span class="reference-object"><a href="#x-28TRY-3ANLX-20CONDITION-29" >NLX</a></span></span> <span class="locative-args">ERROR*</span></span></p>

<p>Representing a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> of unknown origin,
this is signalled if a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> does not return normally although it
should have because it was not dismissed (see <a href="#x-28TRY-3ADISMISSAL-20CONDITION-29" title="(TRY:DISMISSAL CONDITION)"><code>DISMISSAL</code></a>, <a href="#x-28TRY-3ASKIP-TRIAL-20FUNCTION-29" title="(TRY:SKIP-TRIAL FUNCTION)"><code>SKIP-TRIAL</code></a>,
<a href="#x-28TRY-3AABORT-TRIAL-20FUNCTION-29" title="(TRY:ABORT-TRIAL FUNCTION)"><code>ABORT-TRIAL</code></a>). In this case, there is no <code>CL:ERROR</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm" title="(ERROR CONDITION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_error.htm" title="(ERROR FUNCTION)"><code>1</code></a>) associated with the
event.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCATEGORIES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FERRORS-20MGL-PAX-3ASECTION-29" title="Errors">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEVENTS-20MGL-PAX-3ASECTION-29" title="Events">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29" title="The IS Macro">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCATEGORIES-20MGL-PAX-3ASECTION-29" title="Categories">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L232">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FCATEGORIES-20MGL-PAX-3ASECTION-29">4.8 Categories</a></h3>

<p>Categories determine how event types are printed and events of
what types are counted together.</p>

<p>The default value of <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a> is</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><span class="paren2">(<span class="code">abort*             <span class="keyword">:marker</span> <span class="string">"⊟"</span></span>)</span>
 <span class="paren2">(<span class="code">unexpected-failure <span class="keyword">:marker</span> <span class="string">"⊠"</span></span>)</span>
 <span class="paren2">(<span class="code">unexpected-success <span class="keyword">:marker</span> <span class="string">"⊡"</span></span>)</span>
 <span class="paren2">(<span class="code">skip               <span class="keyword">:marker</span> <span class="string">"-"</span></span>)</span>
 <span class="paren2">(<span class="code">expected-failure   <span class="keyword">:marker</span> <span class="string">"×"</span></span>)</span>
 <span class="paren2">(<span class="code">expected-success   <span class="keyword">:marker</span> <span class="string">"⋅"</span></span>)</span></span>)</span></span></code></pre>

<p>which says that all concrete <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s that are of type <a href="#x-28TRY-3AABORT-2A-20CONDITION-29" title="(TRY:ABORT* CONDITION)"><code>ABORT*</code></a> (i.e.
<a href="#x-28TRY-3ARESULT-ABORT-2A-20CONDITION-29" title="(TRY:RESULT-ABORT* CONDITION)"><code>RESULT-ABORT*</code></a>, <a href="#x-28TRY-3AVERDICT-ABORT-2A-20CONDITION-29" title="(TRY:VERDICT-ABORT* CONDITION)"><code>VERDICT-ABORT*</code></a>, <a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>, and <a href="#x-28TRY-3ANLX-20CONDITION-29" title="(TRY:NLX CONDITION)"><code>NLX</code></a>) are to
be marked with <code>&quot;⊟&quot;</code> when printed (see <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">Printing Events</a>). Also, the six
types define six counters for <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">Counting Events</a>. Note that <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>
events have the same marker but squared as their <a href="#x-28TRY-3AEXPECTED-20CONDITION-29" title="(TRY:EXPECTED CONDITION)"><code>EXPECTED</code></a>
counterpart.</p>

<p><a id='x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L289">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" >*CATEGORIES*</a></span></span> <span class="locative-args">&quot;- see above -&quot;</span></span></p>

<p>A list of of elements like <code>(TYPE &amp;KEY MARKER)</code>.
When <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">Printing Events</a>, <a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29" title="Concrete Events">Concrete Events</a> are printed with the marker of
the first matching type. When <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">Counting Events</a>, the counts associated with
all matching types are incremented.</p></li>
</ul>

<p><a id='x-28TRY-3AFANCY-STD-CATEGORIES-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L258">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFANCY-STD-CATEGORIES-20FUNCTION-29" >FANCY-STD-CATEGORIES</a></span></span> <span class="locative-args"></span></span></p>

<p>Returns the default value of <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a> (see <a href="#x-28TRY-3A-40TRY-2FCATEGORIES-20MGL-PAX-3ASECTION-29" title="Categories">Categories</a>),
which contains some fancy Unicode characters.</p></li>
</ul>

<p><a id='x-28TRY-3AASCII-STD-CATEGORIES-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/events.lisp#L268">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AASCII-STD-CATEGORIES-20FUNCTION-29" >ASCII-STD-CATEGORIES</a></span></span> <span class="locative-args"></span></span></p>

<p>Returns a value suitable for <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a>, which uses only ASCII
characters for the markers.</p>

<pre><code><span class="code">'<span class="paren1">(<span class="code"><span class="paren2">(<span class="code">abort*             <span class="keyword">:marker</span> <span class="string">"!"</span></span>)</span>
  <span class="paren2">(<span class="code">unexpected-failure <span class="keyword">:marker</span> <span class="string">"F"</span></span>)</span>
  <span class="paren2">(<span class="code">unexpected-success <span class="keyword">:marker</span> <span class="string">":"</span></span>)</span>
  <span class="paren2">(<span class="code">skip               <span class="keyword">:marker</span> <span class="string">"-"</span></span>)</span>
  <span class="paren2">(<span class="code">expected-failure   <span class="keyword">:marker</span> <span class="string">"f"</span></span>)</span>
  <span class="paren2">(<span class="code">expected-success   <span class="keyword">:marker</span> <span class="string">"."</span></span>)</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCATEGORIES-20MGL-PAX-3ASECTION-29" title="Categories">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29" title="Format Specifier Forms">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29" title="The IS Macro">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29">5 The IS Macro</a></h2>

<p><a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> is the most fundamental one among <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">Checks</a>, on which all
the others are built, and it is a replacement for <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_assert.htm" title="(ASSERT MGL-PAX:MACRO)"><code>CL:ASSERT</code></a> that can
capture values of subforms to provide context to failures:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">= <span class="paren3">(<span class="code">1+ 5</span>)</span> 0</span>)</span></span>)</span>

debugger invoked on a TRY:UNEXPECTED-FAILURE:
  UNEXPECTED-FAILURE in check:
    <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">1+ 5</span>)</span> 0</span>)</span></span>)</span>
  where
    #1# = 6</span></code></pre>

<p><code>IS</code> automatically captures values of arguments to functions like <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_1pl_1_.htm" title="(1+ FUNCTION)"><code>1+</code></a>
in the above example. Values of other interesting subforms can be
explicitly requested to be captured. <code>IS</code> supports capturing multiple
values and can be taught how to deal with macros. The combination of
these features allows <a href="#x-28TRY-3AMATCH-VALUES-20MGL-PAX-3AMACRO-29" title="(TRY:MATCH-VALUES MGL-PAX:MACRO)"><code>MATCH-VALUES</code></a> to be implementable as tiny
extension:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">match-values <span class="paren3">(<span class="code">values <span class="paren4">(<span class="code">1+ 5</span>)</span> <span class="string">"sdf"</span></span>)</span>
      <span class="paren3">(<span class="code">= * 0</span>)</span>
      <span class="paren3">(<span class="code">string= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span>

debugger invoked on a TRY:UNEXPECTED-FAILURE:
  <span class="paren1">(<span class="code">IS
   <span class="paren2">(<span class="code">MATCH-VALUES #1=<span class="paren3">(<span class="code">VALUES <span class="paren4">(<span class="code">1+ 5</span>)</span> #2=<span class="string">"sdf"</span></span>)</span>
     <span class="paren3">(<span class="code">= * 0</span>)</span>
     <span class="paren3">(<span class="code">STRING= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span>
  where
    #1# == 6
           #2#</span></code></pre>

<p><code>IS</code> is flexible enough that all other checks (<a href="#x-28TRY-3ASIGNALS-20MGL-PAX-3AMACRO-29" title="(TRY:SIGNALS MGL-PAX:MACRO)"><code>SIGNALS</code></a>, <a href="#x-28TRY-3ASIGNALS-NOT-20MGL-PAX-3AMACRO-29" title="(TRY:SIGNALS-NOT MGL-PAX:MACRO)"><code>SIGNALS-NOT</code></a>,
<a href="#x-28TRY-3AINVOKES-DEBUGGER-20MGL-PAX-3AMACRO-29" title="(TRY:INVOKES-DEBUGGER MGL-PAX:MACRO)"><code>INVOKES-DEBUGGER</code></a>, <a href="#x-28TRY-3AINVOKES-DEBUGGER-NOT-20MGL-PAX-3AMACRO-29" title="(TRY:INVOKES-DEBUGGER-NOT MGL-PAX:MACRO)"><code>INVOKES-DEBUGGER-NOT</code></a>, <a href="#x-28TRY-3AFAILS-20MGL-PAX-3AMACRO-29" title="(TRY:FAILS MGL-PAX:MACRO)"><code>FAILS</code></a>, and <a href="#x-28TRY-3AIN-TIME-20MGL-PAX-3AMACRO-29" title="(TRY:IN-TIME MGL-PAX:MACRO)"><code>IN-TIME</code></a> are built
on top of it.</p>

<p><a id='x-28TRY-3AIS-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L60">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" >IS</a></span></span> <span class="locative-args">FORM &amp;KEY MSG CTX (CAPTURE <code>T</code>) (PRINT-CAPTURES <code>T</code>) (RETRY <code>T</code>)</span></span></p>

<p>Evaluate <code>FORM</code> and signal a <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a> <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a> if its first return
value is not <code>NIL</code>, else signal a <code>RESULT</code> <a href="#x-28TRY-3AFAILURE-20CONDITION-29" title="(TRY:FAILURE CONDITION)"><code>FAILURE</code></a> (see <a href="#x-28TRY-3A-40TRY-2FOUTCOMES-20MGL-PAX-3ASECTION-29" title="Outcomes">Outcomes</a>).
<code>IS</code> returns normally if</p>

<ul>
<li><p>the <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a> restart is invoked (available when running in a
  trial), or</p></li>
<li><p>the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/r_contin.htm" title="(CONTINUE RESTART)"><code>CONTINUE</code></a> restart is invoked (available when not running in a
  trial), or</p></li>
<li><p>the signalled <code>RESULT</code> condition is not handled (possible only when
  not running in a trial, and the result is a <a href="#x-28TRY-3APASS-20TYPE-29" title="(TRY:PASS TYPE)"><code>PASS</code></a>).</p></li>
</ul>

<p>The return value of <code>IS</code> is <code>T</code> if the last condition signalled is a
<code>SUCCESS</code>, and <code>NIL</code> otherwise.</p>

<p><code>MSG</code> and <code>CTX</code> are <a href="#x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29" title="Format Specifier Forms">Format Specifier Forms</a>. <code>MSG</code> prints a
description of the check being made, which is by default the whole
<code>IS</code> form. Due to how conditions are printed, <code>MSG</code> says what the
desired outcome is, and <code>CTX</code> provides information about the
evaluation.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">equal <span class="paren3">(<span class="code">prin1-to-string 'hello</span>)</span> <span class="string">"hello"</span></span>)</span>
    <span class="keyword">:msg</span> <span class="string">"Symbols are replacements for strings."</span> 
    <span class="keyword">:ctx</span> <span class="paren2">(<span class="code"><span class="string">"*PACKAGE* is ~S and *PRINT-CASE* is ~S~%"</span>
          <span class="special">*package*</span> <span class="special">*print-case*</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  Symbols are replacements for strings.
where
  <span class="paren1">(<span class="code">PRIN1-TO-STRING 'HELLO</span>)</span> = "HELLO"
*PACKAGE* is #&lt;PACKAGE "TRY"&gt; and *PRINT-CASE* is :UPCASE</span></code></pre>

<p>If <code>CAPTURE</code> is true, the value(s) of some subforms of <code>FORM</code> may be
automatically recorded in the condition and also made available for
<code>CTX</code> via <a href="#x-28TRY-3A-2AIS-CAPTURES-2A-20VARIABLE-29" title="(TRY:*IS-CAPTURES* VARIABLE)"><code>*IS-CAPTURES*</code></a>. See <a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">Captures</a> for more.</p>

<p>If <code>PRINT-CAPTURES</code> is true, the captures made are printed when the
<code>RESULT</code> condition is displayed in the debugger or <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_descri.htm" title="(DESCRIBE FUNCTION)"><code>DESCRIBE</code></a>d (see
<a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">Printing Events</a>). This is the <code>where (PRIN1-TO-STRING 'HELLO) = &quot;HELLO&quot;</code>
part above. If <code>PRINT-CAPTURES</code> is <code>NIL</code>, the captures are still
available in <code>*IS-CAPTURES*</code> for writing custom <code>CTX</code> messages.</p>

<p>If <code>RETRY</code> is true, then the <a href="#x-28TRY-3ARETRY-CHECK-20FUNCTION-29" title="(TRY:RETRY-CHECK FUNCTION)"><code>RETRY-CHECK</code></a> restart evaluates <code>FORM</code> again
and signals a new <code>RESULT</code>. If <code>RETRY</code> is <code>NIL</code>, then the <code>RETRY-CHECK</code>
restart returns <code>:RETRY</code>, which allows complex checks such as <a href="#x-28TRY-3ASIGNALS-20MGL-PAX-3AMACRO-29" title="(TRY:SIGNALS MGL-PAX:MACRO)"><code>SIGNALS</code></a>
to implement their own retry mechanism.</p></li>
</ul>

<p><a id='x-28TRY-3A-2AIS-FORM-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L52">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AIS-FORM-2A-20VARIABLE-29" >*IS-FORM*</a></span></span> <span class="locative-args">&quot;-unbound-&quot;</span></span></p>

<p><a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> binds this to its <code>FORM</code> argument for <code>CTX</code> and <code>MSG</code>.</p></li>
</ul>

<p><a id='x-28TRY-3A-2AIS-CAPTURES-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L55">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AIS-CAPTURES-2A-20VARIABLE-29" >*IS-CAPTURES*</a></span></span> <span class="locative-args">&quot;-unbound-&quot;</span></span></p>

<p>Captures made during an <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> evaluation are made available for
<code>CTX</code> via <code>*IS-CAPTURES*</code>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29" title="The IS Macro">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29" title="The IS Macro">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29" title="Format Specifier Forms">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L161">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29">5.1 Format Specifier Forms</a></h3>

<p>A format specifier form is a Lisp form, typically an argument to
macro, standing for the <code>FORMAT-CONTROL</code> and <code>FORMAT-ARGS</code> arguments to
the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_format.htm" title="(FORMAT FUNCTION)"><code>FORMAT</code></a> function.</p>

<p>It may be a constant string:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is nil <span class="keyword">:msg</span> <span class="string">"FORMAT-CONTROL~%with no args."</span></span>)</span>

UNEXPECTED-FAILURE in check:
  FORMAT-CONTROL
  with no args.</span></code></pre>

<p>It may be a list whose first element is a constant string, and the
rest are the format arguments to be evaluated:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is nil <span class="keyword">:msg</span> <span class="paren2">(<span class="code"><span class="string">"Implicit LIST ~A."</span> <span class="string">"form"</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  Implicit LIST form.</span></code></pre>

<p>Or it may be a form that evaluates to a list like <code>(FORMAT-CONTROL
&amp;REST FORMAT-ARGS)</code>:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is nil <span class="keyword">:msg</span> <span class="paren2">(<span class="code">list <span class="string">"Full ~A."</span> <span class="string">"form"</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  Full form.</span></code></pre>

<p>Finally, it may evaluate to <code>NIL</code>, in which case some context specific
default is implied.</p>

<p><a id='x-28TRY-3ACANONICALIZE-FORMAT-SPECIFIER-FORM-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L201">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ACANONICALIZE-FORMAT-SPECIFIER-FORM-20FUNCTION-29" >CANONICALIZE-FORMAT-SPECIFIER-FORM</a></span></span> <span class="locative-args">FORM</span></span></p>

<p>Ensure that the format specifier form <code>FORM</code> is in its full form.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29" title="Format Specifier Forms">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FIS-20MGL-PAX-3ASECTION-29" title="The IS Macro">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29" title="Automatic Captures">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L212">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29">5.2 Captures</a></h3>

<p>During the evaluation of the <code>FORM</code> argument of <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a>, evaluation of any
form (e.g. a subform of <code>FORM</code>) may be recorded, which are called
captures.</p>

<p><a id='x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FWRITING-AUTOMATIC-CAPTURE-RULES-20MGL-PAX-3ASECTION-29" title="Writing Automatic Capture Rules">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29" title="Automatic Captures">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L310">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29">5.2.1 Automatic Captures</a></h4>

<p><a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> automatically captures some subforms of <code>FORM</code> that are likely
to be informative. In particular, if <code>FORM</code> is a function call, then
non-constant arguments are automatically captured:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">= 3 <span class="paren3">(<span class="code">1+ 2</span>)</span> <span class="paren3">(<span class="code">- 4 3</span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= 3 #1=<span class="paren3">(<span class="code">1+ 2</span>)</span> #2=<span class="paren3">(<span class="code">- 4 3</span>)</span></span>)</span></span>)</span>
where
  #1# = 3
  #2# = 1</span></code></pre>

<p>By default, automatic captures are not made for subforms deeper in
<code>FORM</code>, except for when <code>FORM</code> is a call to <code>NULL</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_null.htm" title="(NULL FUNCTION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/t_null.htm" title="(NULL TYPE)"><code>1</code></a>), <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_endp.htm" title="(ENDP FUNCTION)"><code>ENDP</code></a> and <code>NOT</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_not.htm" title="(NOT FUNCTION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/t_not.htm" title="(NOT TYPE)"><code>1</code></a>):</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">null <span class="paren3">(<span class="code">find <span class="paren4">(<span class="code">1+ 1</span>)</span> '<span class="paren4">(<span class="code">1 2 3</span>)</span></span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">NULL #1=<span class="paren3">(<span class="code">FIND #2=<span class="paren4">(<span class="code">1+ 1</span>)</span> '<span class="paren4">(<span class="code">1 2 3</span>)</span></span>)</span></span>)</span></span>)</span>
where
  #2# = 2
  #1# = 2</span></code></pre>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">endp <span class="paren3">(<span class="code">member <span class="paren4">(<span class="code">1+ 1</span>)</span> '<span class="paren4">(<span class="code">1 2 3</span>)</span></span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">ENDP #1=<span class="paren3">(<span class="code">MEMBER #2=<span class="paren4">(<span class="code">1+ 1</span>)</span> '<span class="paren4">(<span class="code">1 2 3</span>)</span></span>)</span></span>)</span></span>)</span>
where
  #2# = 2
  #1# = <span class="paren1">(<span class="code">2 3</span>)</span></span></code></pre>

<p>Note that the argument of <code>NOT</code> is not captured as it is assumed to be
<code>NIL</code> or <code>T</code>. If that's not true, use <code>NULL</code>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">not <span class="paren3">(<span class="code">equal <span class="paren4">(<span class="code">1+ 5</span>)</span> 6</span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">NOT <span class="paren3">(<span class="code">EQUAL #1=<span class="paren4">(<span class="code">1+ 5</span>)</span> 6</span>)</span></span>)</span></span>)</span>
where
  #1# = 6</span></code></pre>

<p>Other automatic captures are discussed with the relevant
functionality such as <a href="#x-28TRY-3AMATCH-VALUES-20MGL-PAX-3AMACRO-29" title="(TRY:MATCH-VALUES MGL-PAX:MACRO)"><code>MATCH-VALUES</code></a>.</p>

<p><a id='x-28TRY-3A-40TRY-2FWRITING-AUTOMATIC-CAPTURE-RULES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29" title="Automatic Captures">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FAUTOMATIC-CAPTURES-20MGL-PAX-3ASECTION-29" title="Automatic Captures">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-CAPTURES-20MGL-PAX-3ASECTION-29" title="Explicit Captures">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FWRITING-AUTOMATIC-CAPTURE-RULES-20MGL-PAX-3ASECTION-29" title="Writing Automatic Capture Rules">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L457">&#955;</a></span></span></p>

<h5><a href="#x-28TRY-3A-40TRY-2FWRITING-AUTOMATIC-CAPTURE-RULES-20MGL-PAX-3ASECTION-29">Writing Automatic Capture Rules</a></h5>

<p><a id='x-28TRY-3ASUB-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L365">[class]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASUB-20CLASS-29" >SUB</a></span></span> <span class="locative-args">STRUCTURE-OBJECT</span></span></p>

<p>A <code>SUB</code> (short for substitution) says that in the original form <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> is
checking, a <code>SUBFORM</code> was substituted (by <code>SUBSTITUTE-IS-FORM</code>) with
<code>VAR</code> (if <code>VALUESP</code> is <code>NIL</code>) or with (<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_vals_l.htm" title="(VALUES-LIST FUNCTION)"><code>VALUES-LIST</code></a> <code>VAR</code>) if <code>VALUESP</code> is
true. Conversely, <code>VAR</code> is to be bound to the evaluated <code>NEW-FORM</code> if
<code>VALUESP</code> is <code>NIL</code>, and to (<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_mult_1.htm" title="(MULTIPLE-VALUE-LIST MGL-PAX:MACRO)"><code>MULTIPLE-VALUE-LIST</code></a> <code>FORM</code>) if <code>VALUESP</code>.
<code>NEW-FORM</code> is often <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eq.htm" title="(EQ FUNCTION)"><code>EQ</code></a> to <code>SUBFORM</code>, but it may be different, which is
the case when further substitutions are made within a substitution.</p></li>
</ul>

<p><a id='x-28TRY-3AMAKE-SUB-20FUNCTION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L365">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AMAKE-SUB-20FUNCTION-29" >MAKE-SUB</a></span></span> <span class="locative-args">VAR SUBFORM NEW-FORM VALUESP</span></span></li>
</ul>

<p><a id='x-28TRY-3ASUB-VAR-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L365">[structure-accessor]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASUB-VAR-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29" >SUB-VAR</a></span></span></span></li>
</ul>

<p><a id='x-28TRY-3ASUB-SUBFORM-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L365">[structure-accessor]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASUB-SUBFORM-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29" >SUB-SUBFORM</a></span></span></span></li>
</ul>

<p><a id='x-28TRY-3ASUB-NEW-FORM-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L365">[structure-accessor]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASUB-NEW-FORM-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29" >SUB-NEW-FORM</a></span></span></span></li>
</ul>

<p><a id='x-28TRY-3ASUB-VALUESP-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L365">[structure-accessor]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASUB-VALUESP-20-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20TRY-3ASUB-29-29" >SUB-VALUESP</a></span></span></span></li>
</ul>

<p><a id='x-28TRY-3ASUBSTITUTE-IS-LIST-FORM-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L473">[generic-function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASUBSTITUTE-IS-LIST-FORM-20GENERIC-FUNCTION-29" >SUBSTITUTE-IS-LIST-FORM</a></span></span> <span class="locative-args">FIRST FORM ENV</span></span></p>

<p>In the list <code>FORM</code>, whose <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_car_c.htm" title="(CAR FUNCTION)"><code>CAR</code></a> is <code>FIRST</code>, substitute
subexpressions of interest with a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_gensym.htm" title="(GENSYM FUNCTION)"><code>GENSYM</code></a> and return the new form. As
the second value, return a list of <code>SUBs</code>.</p>

<p>For example, consider <code>(IS (FIND (FOO) LIST))</code>. When
<code>SUBSTITUTE-IS-LIST-FORM</code> is invoked on <code>(FIND (FOO) LIST)</code>, it
substitutes each argument of <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_find_.htm" title="(FIND FUNCTION)"><code>FIND</code></a> with a variable, returning the new
form <code>(FIND TEMP1 TEMP2)</code> and the list of two
substitutions <code>((TEMP2 (FOO) (FOO) NIL) (TEMP3 LIST LIST NIL))</code>.
This allows the original form to be rewritten as</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let*</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code">temp1 <span class="paren4">(<span class="code">foo</span>)</span></span>)</span>
       <span class="paren3">(<span class="code">temp2 list</span>)</span></span>)</span>
  <span class="paren2">(<span class="code">find temp1 temp2</span>)</span></span>)</span></span></code></pre>

<p>TEMP1 and TEMP2 may then be reported in the <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a> condition
signalled by <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> like this:</p>

<pre><code>The following check failed:
  (is (find #1=(foo) #2=list))
where
  #1# = &lt;return-value-of-foo&gt;
  #2# = &lt;value-of-variable-list&gt;
</code></pre></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FEXPLICIT-CAPTURES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FWRITING-AUTOMATIC-CAPTURE-RULES-20MGL-PAX-3ASECTION-29" title="Writing Automatic Capture Rules">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-CAPTURES-20MGL-PAX-3ASECTION-29" title="Explicit Captures">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L220">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FEXPLICIT-CAPTURES-20MGL-PAX-3ASECTION-29">5.2.2 Explicit Captures</a></h4>

<p>In addition to automatic captures, which are prescribed by
rewriting rules (see <a href="#x-28TRY-3A-40TRY-2FWRITING-AUTOMATIC-CAPTURE-RULES-20MGL-PAX-3ASECTION-29" title="Writing Automatic Capture Rules">Writing Automatic Capture Rules</a>),
explicit, ad-hoc captures can also be made.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">x 1</span>)</span></span>)</span>
      <span class="paren3">(<span class="code">= <span class="paren4">(<span class="code">capture x</span>)</span> 2</span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS
   <span class="paren2">(<span class="code"><i><span class="symbol">LET</span></i> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">X 1</span>)</span></span>)</span>
     <span class="paren3">(<span class="code">= <span class="paren4">(<span class="code">CAPTURE X</span>)</span> 2</span>)</span></span>)</span></span>)</span>
where
  X = 1</span></code></pre>

<p>If <a href="#x-28TRY-3ACAPTURE-20MGL-PAX-3AMACRO-29" title="(TRY:CAPTURE MGL-PAX:MACRO)"><code>CAPTURE</code></a> showing up in the form that <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> print is undesirable, then
<a href="#x-28TRY-3A-25-20MACROLET-29" title="(TRY:% MACROLET)"><code>%</code></a> may be used instead:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">x 1</span>)</span></span>)</span>
      <span class="paren3">(<span class="code">= <span class="paren4">(<span class="code">% x</span>)</span> 2</span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS
   <span class="paren2">(<span class="code"><i><span class="symbol">LET</span></i> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">X 1</span>)</span></span>)</span>
     <span class="paren3">(<span class="code">= X 2</span>)</span></span>)</span></span>)</span>
where
  X = 1</span></code></pre>

<p>Multiple values may be captured with <a href="#x-28TRY-3ACAPTURE-VALUES-20MGL-PAX-3AMACRO-29" title="(TRY:CAPTURE-VALUES MGL-PAX:MACRO)"><code>CAPTURE-VALUES</code></a> and its
secretive counterpart <a href="#x-28TRY-3A-25-25-20MACROLET-29" title="(TRY:%% MACROLET)"><code>%%</code></a>:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">= <span class="paren3">(<span class="code">%% <span class="paren4">(<span class="code">values 1 2</span>)</span></span>)</span> 2</span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">VALUES 1 2</span>)</span> 2</span>)</span></span>)</span>
where
  #1# == 1
         2</span></code></pre>

<p>where printing <code>==</code> instead of <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eq_sle.htm" title="(= FUNCTION)"><code>=</code></a> indicates that this is a multiple
value capture.</p>

<p><a id='x-28TRY-3ACAPTURE-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L273">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3ACAPTURE-20MGL-PAX-3AMACRO-29" >CAPTURE</a></span></span> <span class="locative-args">FORM</span></span></p>

<p>Evaluate <code>FORM</code>, record its primary return value if within the
dynamic extent of an <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> evaluation, and finally return that value.
If <code>CAPTURE</code> is used within the lexical scope of <code>IS</code>, then <code>CAPTURE</code>
itself will show up in the form that the default <code>MSG</code> prints. Thus it
is recommended to use the equivalent <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_flet_.htm" title="(MACROLET MGL-PAX:MACRO)"><code>MACROLET</code></a> <a href="#x-28TRY-3A-25-20MACROLET-29" title="(TRY:% MACROLET)"><code>%</code></a> in the lexical
scope as <code>%</code> is removed before printing.</p></li>
</ul>

<p><a id='x-28TRY-3ACAPTURE-VALUES-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L286">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3ACAPTURE-VALUES-20MGL-PAX-3AMACRO-29" >CAPTURE-VALUES</a></span></span> <span class="locative-args">FORM</span></span></p>

<p>Like <code>CAPTURE-VALUES</code>, but record and return all values returned by
<code>FORM</code>. It is recommended to use the equivalent <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_flet_.htm" title="(MACROLET MGL-PAX:MACRO)"><code>MACROLET</code></a> <a href="#x-28TRY-3A-25-25-20MACROLET-29" title="(TRY:%% MACROLET)"><code>%%</code></a> in the
lexical scope as <code>%%</code> is removed before printing.</p></li>
</ul>

<p><a id='x-28TRY-3A-25-20MACROLET-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L300">[macrolet]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-25-20MACROLET-29" >%</a></span></span> <span class="locative-args">FORM</span></span></p>

<p>An alias for <a href="#x-28TRY-3ACAPTURE-20MGL-PAX-3AMACRO-29" title="(TRY:CAPTURE MGL-PAX:MACRO)"><code>CAPTURE</code></a> in the lexical scope of <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a>. Removed from the
<code>IS</code> form when printed.</p></li>
</ul>

<p><a id='x-28TRY-3A-25-25-20MACROLET-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/is.lisp#L304">[macrolet]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-25-25-20MACROLET-29" >%%</a></span></span> <span class="locative-args">FORM</span></span></p>

<p>An alias for <a href="#x-28TRY-3ACAPTURE-VALUES-20MGL-PAX-3AMACRO-29" title="(TRY:CAPTURE-VALUES MGL-PAX:MACRO)"><code>CAPTURE-VALUES</code></a> in the lexical scope of <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a>. Removed
from the <code>IS</code> form when printed.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-CAPTURES-20MGL-PAX-3ASECTION-29" title="Explicit Captures">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29">6 Check Library</a></h2>

<p>In the following, various checks built on top of <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> are described.
Many of them share a number of arguments, which are described here.</p>

<ul>
<li><p><code>ON-RETURN</code> is a boolean that determines whether the check in a
  macro that wraps <code>BODY</code> is made when <code>BODY</code> returns normally.</p></li>
<li><p><code>ON-NLX</code> is a boolean that determines whether the check in a macro
  that wraps <code>BODY</code> is made when <code>BODY</code> performs a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a>.</p></li>
<li><p><code>MSG</code> and <code>CTX</code> are <a href="#x-28TRY-3A-40TRY-2FFORMAT-SPECIFIER-FORMS-20MGL-PAX-3ASECTION-29" title="Format Specifier Forms">Format Specifier Forms</a> as in <code>IS</code>.</p></li>
<li><p><code>NAME</code> may be provided so that it is printed (with <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_wr_pr.htm" title="(PRIN1 FUNCTION)"><code>PRIN1</code></a>) instead of
  <code>BODY</code> in <code>MSG</code>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FMISC-CHECKS-20MGL-PAX-3ASECTION-29" title="Miscellaneous Checks">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L24">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29">6.1 Checking Conditions</a></h3>

<p>The macros <a href="#x-28TRY-3ASIGNALS-20MGL-PAX-3AMACRO-29" title="(TRY:SIGNALS MGL-PAX:MACRO)"><code>SIGNALS</code></a>, <a href="#x-28TRY-3ASIGNALS-NOT-20MGL-PAX-3AMACRO-29" title="(TRY:SIGNALS-NOT MGL-PAX:MACRO)"><code>SIGNALS-NOT</code></a>, <a href="#x-28TRY-3AINVOKES-DEBUGGER-20MGL-PAX-3AMACRO-29" title="(TRY:INVOKES-DEBUGGER MGL-PAX:MACRO)"><code>INVOKES-DEBUGGER</code></a>, and
<a href="#x-28TRY-3AINVOKES-DEBUGGER-NOT-20MGL-PAX-3AMACRO-29" title="(TRY:INVOKES-DEBUGGER-NOT MGL-PAX:MACRO)"><code>INVOKES-DEBUGGER-NOT</code></a> all check whether a condition of a given type,
possibly also matching a predicate, was signalled. In addition to
those already described in <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">Check Library</a>, these macros share a
number of arguments.</p>

<p>Matching conditions are those that are of type <code>CONDITION-TYPE</code> (not
evaluated) and satisfy the predicate <code>PRED</code>.</p>

<p>When <code>PRED</code> is <code>NIL</code>, it always matches. When it is a string, then it
matches if it is a substring of the printed representation of the
condition being handled (by <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_wr_pr.htm" title="(PRINC FUNCTION)"><code>PRINC</code></a> under <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_w_std_.htm" title="(WITH-STANDARD-IO-SYNTAX MGL-PAX:MACRO)"><code>WITH-STANDARD-IO-SYNTAX</code></a>).
When it is a function, it matches if it returns true when called
with the condition as its argument.</p>

<p>The check is performed in the cleanup form of an <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_unwind.htm" title="(UNWIND-PROTECT MGL-PAX:MACRO)"><code>UNWIND-PROTECT</code></a>
around <code>BODY</code>.</p>

<p><code>HANDLER</code> is called when a matching condition is found. It can be a
function, <code>T</code>, or <code>NIL</code>. When it is a function, it is called from the
condition handler (<code>SIGNALS</code> and <code>SIGNALS-NOT</code>) or the debugger
hook (invokes-debugger and <code>INVOKES-DEBUGGER-NOT</code>) with the matching
condition. <code>HANDLER</code> may perform a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a>. When <code>HANDLER</code> is <code>T</code>,
the matching condition is handled by performing a non-local exit to
just outside <code>BODY</code>. If the exit completes, <code>BODY</code> is treated as if it
had returned normally, and <code>ON-RETURN</code> is consulted. When <code>HANDLER</code> is
<code>NIL</code>, no addition action is performed when a matching condition is
found.</p>

<p>The default <code>CTX</code> describes the result of the matching process in
terms of <a href="#x-28TRY-3A-2ACONDITION-MATCHED-P-2A-20VARIABLE-29" title="(TRY:*CONDITION-MATCHED-P* VARIABLE)"><code>*CONDITION-MATCHED-P*</code></a> and <a href="#x-28TRY-3A-2ABEST-MATCHING-CONDITION-2A-20VARIABLE-29" title="(TRY:*BEST-MATCHING-CONDITION* VARIABLE)"><code>*BEST-MATCHING-CONDITION*</code></a>.</p>

<p><a id='x-28TRY-3A-2ACONDITION-MATCHED-P-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L87">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ACONDITION-MATCHED-P-2A-20VARIABLE-29" >*CONDITION-MATCHED-P*</a></span></span> <span class="locative-args">&quot;-unbound-&quot;</span></span></p>

<p>When a check described in <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">Checking Conditions</a> signals its
<a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>, this variable is bound to a boolean value to indicate
whether a condition that matched <code>CONDITION-TYPE</code> and <code>PRED</code> was
found.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ABEST-MATCHING-CONDITION-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L94">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ABEST-MATCHING-CONDITION-2A-20VARIABLE-29" >*BEST-MATCHING-CONDITION*</a></span></span> <span class="locative-args">&quot;-unbound-&quot;</span></span></p>

<p>Bound when a check described in <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">Checking Conditions</a>
signals its <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>. If <a href="#x-28TRY-3A-2ACONDITION-MATCHED-P-2A-20VARIABLE-29" title="(TRY:*CONDITION-MATCHED-P* VARIABLE)"><code>*CONDITION-MATCHED-P*</code></a>, then it is the
most recent condition that matched both <code>CONDITION-TYPE</code> and <code>PRED</code>.
Else, it is the most recent condition that matched
<code>CONDITION-TYPE</code> or <code>NIL</code> if no such conditions were detected.</p></li>
</ul>

<p><a id='x-28TRY-3ASIGNALS-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L148">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASIGNALS-20MGL-PAX-3AMACRO-29" >SIGNALS</a></span></span> <span class="locative-args">(CONDITION-TYPE &amp;KEY PRED (HANDLER <code>T</code>) (ON-RETURN <code>T</code>) (ON-NLX <code>T</code>) NAME MSG CTX) &amp;BODY BODY</span></span></p>

<p>Check that <code>BODY</code> signals a <code>CONDITION</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_cnd.htm" title="(CONDITION CONDITION)"><code>0</code></a> <a href="mgl-pax-manual.html#x-28CONDITION-20MGL-PAX-3ALOCATIVE-29" title="(CONDITION MGL-PAX:LOCATIVE)"><code>1</code></a>) of <code>CONDITION-TYPE</code> (not
evaluated) that matches <code>PRED</code>. To detect matching conditions, <code>SIGNALS</code>
sets up a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_handle.htm" title="(HANDLER-BIND MGL-PAX:MACRO)"><code>HANDLER-BIND</code></a>. Thus it can only see what <code>BODY</code> does not
handle. The arguments are described in <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">Checking Conditions</a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">signals <span class="paren2">(<span class="code">error</span>)</span>
  <span class="paren2">(<span class="code">error <span class="string">"xxx"</span></span>)</span></span>)</span>
=&gt; NIL</span></code></pre>

<p>The following example shows a failure where <code>CONDITION-TYPE</code> matches
but <code>PRED</code> does not.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">ignore-errors
  <span class="paren2">(<span class="code">signals <span class="paren3">(<span class="code">error <span class="keyword">:pred</span> <span class="string">"non-matching"</span></span>)</span>
    <span class="paren3">(<span class="code">error <span class="string">"xxx"</span></span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">ERROR <span class="string">"xxx"</span></span>)</span> signals a condition of type ERROR that matches
  "non-matching".
The predicate did not match "xxx".</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3ASIGNALS-NOT-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L204">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASIGNALS-NOT-20MGL-PAX-3AMACRO-29" >SIGNALS-NOT</a></span></span> <span class="locative-args">(CONDITION-TYPE &amp;KEY PRED (HANDLER <code>T</code>) (ON-RETURN <code>T</code>) (ON-NLX <code>T</code>) NAME MSG CTX) &amp;BODY BODY</span></span></p>

<p>Check that <code>BODY</code> does not signal a <code>CONDITION</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_cnd.htm" title="(CONDITION CONDITION)"><code>0</code></a> <a href="mgl-pax-manual.html#x-28CONDITION-20MGL-PAX-3ALOCATIVE-29" title="(CONDITION MGL-PAX:LOCATIVE)"><code>1</code></a>) of <code>CONDITION-TYPE</code> (not
evaluated) that matches <code>PRED</code>. To detect matching conditions,
<code>SIGNALS-NOT</code> sets up a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_handle.htm" title="(HANDLER-BIND MGL-PAX:MACRO)"><code>HANDLER-BIND</code></a>. Thus it can only see what <code>BODY</code>
does not handle. The arguments are described in
<a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">Checking Conditions</a>.</p></li>
</ul>

<p><a id='x-28TRY-3AINVOKES-DEBUGGER-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L235">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AINVOKES-DEBUGGER-20MGL-PAX-3AMACRO-29" >INVOKES-DEBUGGER</a></span></span> <span class="locative-args">(CONDITION-TYPE &amp;KEY PRED (HANDLER <code>T</code>) (ON-RETURN <code>T</code>) (ON-NLX <code>T</code>) NAME MSG CTX) &amp;BODY BODY</span></span></p>

<p>Check that <code>BODY</code> enters the debugger with a <code>CONDITION</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_cnd.htm" title="(CONDITION CONDITION)"><code>0</code></a> <a href="mgl-pax-manual.html#x-28CONDITION-20MGL-PAX-3ALOCATIVE-29" title="(CONDITION MGL-PAX:LOCATIVE)"><code>1</code></a>) of
<code>CONDITION-TYPE</code> (not evaluated) that matches <code>PRED</code>. To detect matching
conditions, <code>INVOKES-DEBUGGER</code> sets up a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_debugg.htm" title="(*DEBUGGER-HOOK* VARIABLE)"><code>*DEBUGGER-HOOK*</code></a>. Thus if
<code>*DEBUGGER-HOOK*</code> is changed by <code>BODY</code>, it may not detect the condition.
The arguments are described in <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">Checking Conditions</a>.</p>

<p>Note that in a trial (see <a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>), all <code>ERROR</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm" title="(ERROR CONDITION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_error.htm" title="(ERROR FUNCTION)"><code>1</code></a>)s are handled,
and a <code>*DEBUGGER-HOOK*</code> is set up (see <a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>). Thus invoking
debugger would normally cause the trial to abort.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">invokes-debugger <span class="paren2">(<span class="code">error <span class="keyword">:pred</span> <span class="string">"xxx"</span></span>)</span>
  <span class="paren2">(<span class="code">handler-bind <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">error #'invoke-debugger</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">error <span class="string">"xxx"</span></span>)</span></span>)</span></span>)</span>
=&gt; NIL</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3AINVOKES-DEBUGGER-NOT-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L288">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AINVOKES-DEBUGGER-NOT-20MGL-PAX-3AMACRO-29" >INVOKES-DEBUGGER-NOT</a></span></span> <span class="locative-args">(CONDITION-TYPE &amp;KEY PRED (HANDLER <code>T</code>) (ON-RETURN <code>T</code>) (ON-NLX <code>T</code>) NAME MSG CTX) &amp;BODY BODY</span></span></p>

<p>Check that <code>BODY</code> does not enter the debugger with a <code>CONDITION</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/e_cnd.htm" title="(CONDITION CONDITION)"><code>0</code></a> <a href="mgl-pax-manual.html#x-28CONDITION-20MGL-PAX-3ALOCATIVE-29" title="(CONDITION MGL-PAX:LOCATIVE)"><code>1</code></a>) of
<code>CONDITION-TYPE</code> (not evaluated) that matches <code>PRED</code>. To detect matching
conditions, <code>INVOKES-DEBUGGER-NOT</code> sets up a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_debugg.htm" title="(*DEBUGGER-HOOK* VARIABLE)"><code>*DEBUGGER-HOOK*</code></a>. Thus if
<code>*DEBUGGER-HOOK*</code> is changed by <code>BODY</code>, it may not detect the condition.
The arguments are described in <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">Checking Conditions</a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FMISC-CHECKS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCHECKING-CONDITIONS-20MGL-PAX-3ASECTION-29" title="Checking Conditions">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-UTILITIES-20MGL-PAX-3ASECTION-29" title="Check Utilities">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FMISC-CHECKS-20MGL-PAX-3ASECTION-29" title="Miscellaneous Checks">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L319">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FMISC-CHECKS-20MGL-PAX-3ASECTION-29">6.2 Miscellaneous Checks</a></h3>

<p><a id='x-28TRY-3AFAILS-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L325">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFAILS-20MGL-PAX-3AMACRO-29" >FAILS</a></span></span> <span class="locative-args">(&amp;KEY NAME MSG CTX) &amp;BODY BODY</span></span></p>

<p>Check that <code>BODY</code> performs a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> but do not cancel
it (see <a href="#x-28TRY-3A-3A-40CANCELLED-NLX-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@CANCELLED-NLX MGL-PAX:GLOSSARY-TERM)">cancelled non-local exit</a>). See <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">Check Library</a> for the descriptions
of the other arguments.</p>

<p>In the following example, <code>FAILS</code> signals a <a href="#x-28TRY-3ASUCCESS-20CONDITION-29" title="(TRY:SUCCESS CONDITION)"><code>SUCCESS</code></a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">catch</span></i> 'foo
  <span class="paren2">(<span class="code">fails <span class="paren3">(<span class="code"></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">throw</span></i> 'foo 7</span>)</span></span>)</span></span>)</span>
=&gt; 7</span></code></pre>

<p>Next, <code>FAILS</code> signals an <a href="#x-28TRY-3AUNEXPECTED-FAILURE-20TYPE-29" title="(TRY:UNEXPECTED-FAILURE TYPE)"><code>UNEXPECTED-FAILURE</code></a> because <code>BODY</code> returns
normally.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">fails <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">print 'hey</span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">PRINT 'HEY</span>)</span> does not return normally.</span></code></pre>

<p>Note that there is no <code>FAILS-NOT</code> as <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a> fills that role.</p></li>
</ul>

<p><a id='x-28TRY-3AIN-TIME-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L373">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AIN-TIME-20MGL-PAX-3AMACRO-29" >IN-TIME</a></span></span> <span class="locative-args">(SECONDS &amp;KEY (ON-RETURN <code>T</code>) (ON-NLX <code>T</code>) NAME MSG CTX) &amp;BODY BODY</span></span></p>

<p>Check that <code>BODY</code> finishes in <code>SECONDS</code>. See <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">Check Library</a> for
the descriptions of the other arguments.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">in-time <span class="paren2">(<span class="code">1</span>)</span>
  <span class="paren2">(<span class="code">sleep 2</span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">SLEEP 2</span>)</span> finishes within 1s.
Took 2.000s.</span></code></pre>

<p><a href="#x-28TRY-3ARETRY-CHECK-20FUNCTION-29" title="(TRY:RETRY-CHECK FUNCTION)"><code>RETRY-CHECK</code></a> restarts timing.</p></li>
</ul>

<p><a id='x-28TRY-3A-2AIN-TIME-ELAPSED-SECONDS-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L409">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AIN-TIME-ELAPSED-SECONDS-2A-20VARIABLE-29" >*IN-TIME-ELAPSED-SECONDS*</a></span></span> <span class="locative-args">&quot;-unbound-&quot;</span></span></p>

<p>Bound to the number of seconds passed during the evaluation of
<code>BODY</code> when <a href="#x-28TRY-3AIN-TIME-20MGL-PAX-3AMACRO-29" title="(TRY:IN-TIME MGL-PAX:MACRO)"><code>IN-TIME</code></a> signals its <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCHECK-UTILITIES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FMISC-CHECKS-20MGL-PAX-3ASECTION-29" title="Miscellaneous Checks">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-LIBRARY-20MGL-PAX-3ASECTION-29" title="Check Library">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCOMPARING-FLOATS-20MGL-PAX-3ASECTION-29" title="Comparing Floats">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-UTILITIES-20MGL-PAX-3ASECTION-29" title="Check Utilities">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L415">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FCHECK-UTILITIES-20MGL-PAX-3ASECTION-29">6.3 Check Utilities</a></h3>

<p>These utilities are not checks (which signal <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>s) but simple
functions and macros that may be useful for writing <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a> checks.</p>

<p><a id='x-28TRY-3AON-VALUES-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/util.lisp#L157">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AON-VALUES-20MGL-PAX-3AMACRO-29" >ON-VALUES</a></span></span> <span class="locative-args">FORM &amp;BODY BODY</span></span></p>

<p><code>ON-VALUES</code> evaluates <code>FORM</code> and transforms its return values one by
one based on forms in <code>BODY</code>. The Nth value is replaced by the return
value of the Nth form of <code>BODY</code> evaluated with <code>*</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_st.htm" title="(* FUNCTION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_stst.htm" title="(* VARIABLE)"><code>1</code></a>) bound to the Nth
value. If the number of values exceeds the number of transformation
forms in <code>BODY</code> then the excess values are returned as is.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">on-values <span class="paren2">(<span class="code">values 1 <span class="string">"abc"</span> 7</span>)</span>
  <span class="paren2">(<span class="code">1+ *</span>)</span>
  <span class="paren2">(<span class="code">length *</span>)</span></span>)</span>
=&gt; 2
=&gt; 3
=&gt; 7</span></code></pre>

<p>If the number of values is less than the number of transformation
forms, then in later transformation forms <code>*</code> is bound to <code>NIL</code>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">on-values <span class="paren2">(<span class="code">values</span>)</span>
  *
  *</span>)</span>
=&gt; NIL
=&gt; NIL</span></code></pre>

<p>The first forms in <code>BODY</code> may be options. Options must precede
transformation forms. With <code>:TRUNCATE</code> <code>T</code>, the excess values are
discarded.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">on-values <span class="paren2">(<span class="code">values 1 <span class="string">"abc"</span> 7</span>)</span>
  <span class="paren2">(<span class="code"><span class="keyword">:truncate</span> t</span>)</span>
  <span class="paren2">(<span class="code">1+ *</span>)</span>
  <span class="paren2">(<span class="code">length *</span>)</span></span>)</span>
=&gt; 2
=&gt; 3</span></code></pre>

<p>The <code>:ON-LENGTH-MISMATCH</code> option may be <code>NIL</code> or a function of a single
argument. If the number of values and the number of transformation
forms is different, then this function is called to transform the
list of values. <code>:TRUNCATE</code> is handled before <code>:ON-LENGTH-MISMATCH</code>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">on-values 1
  <span class="paren2">(<span class="code"><span class="keyword">:on-length-mismatch</span> <span class="paren3">(<span class="code"><i><span class="symbol">lambda</span></i> <span class="paren4">(<span class="code">values</span>)</span>
                         <span class="paren4">(<span class="code"><i><span class="symbol">if</span></i> <span class="paren5">(<span class="code">= <span class="paren6">(<span class="code">length values</span>)</span> 1</span>)</span>
                             <span class="paren5">(<span class="code">append values '<span class="paren6">(<span class="code"><span class="string">"abc"</span></span>)</span></span>)</span>
                             values</span>)</span></span>)</span></span>)</span>
  <span class="paren2">(<span class="code">1+ *</span>)</span>
  *</span>)</span>
=&gt; 2
=&gt; "abc"</span></code></pre>

<p>If the same option is specified multiple times, only the first one
is in effect.</p></li>
</ul>

<p><a id='x-28TRY-3AMATCH-VALUES-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L426">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AMATCH-VALUES-20MGL-PAX-3AMACRO-29" >MATCH-VALUES</a></span></span> <span class="locative-args">FORM &amp;BODY BODY</span></span></p>

<p><code>MATCH-VALUES</code> returns true iff all return values of <code>FORM</code> satisfy
the predicates given by <code>BODY</code>, which are described in <a href="#x-28TRY-3AON-VALUES-20MGL-PAX-3AMACRO-29" title="(TRY:ON-VALUES MGL-PAX:MACRO)"><code>ON-VALUES</code></a>. The
<code>:TRUNCATE</code> option of <code>ON-VALUES</code> is supported, but <code>:ON-LENGTH-MISMATCH</code>
always returns <code>NIL</code>.</p>

<pre><code><span class="code"><span class="comment">;; no values
</span><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">match-values <span class="paren3">(<span class="code">values</span>)</span></span>)</span></span>)</span>
<span class="comment">;; single value success
</span><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">match-values 1
      <span class="paren3">(<span class="code">= * 1</span>)</span></span>)</span></span>)</span>
<span class="comment">;; success with different types
</span><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">match-values <span class="paren3">(<span class="code">values 1 <span class="string">"sdf"</span></span>)</span>
      <span class="paren3">(<span class="code">= * 1</span>)</span>
      <span class="paren3">(<span class="code">string= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span>
<span class="comment">;; too few values
</span><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">not <span class="paren3">(<span class="code">match-values 1
           <span class="paren4">(<span class="code">= * 1</span>)</span>
           <span class="paren4">(<span class="code">string= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span></span>)</span>
<span class="comment">;; too many values
</span><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">not <span class="paren3">(<span class="code">match-values <span class="paren4">(<span class="code">values 1 <span class="string">"sdf"</span> 3</span>)</span>
           <span class="paren4">(<span class="code">= * 1</span>)</span>
           <span class="paren4">(<span class="code">string= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span></span>)</span>
<span class="comment">;; too many values, but truncated
</span><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">match-values <span class="paren3">(<span class="code">values 1 <span class="string">"sdf"</span> 3</span>)</span>
      <span class="paren3">(<span class="code"><span class="keyword">:truncate</span> t</span>)</span>
      <span class="paren3">(<span class="code">= * 1</span>)</span>
      <span class="paren3">(<span class="code">string= * <span class="string">"sdf"</span></span>)</span></span>)</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28TRY-3AMISMATCH-25-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L477">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AMISMATCH-25-20FUNCTION-29" >MISMATCH%</a></span></span> <span class="locative-args">SEQUENCE1 SEQUENCE2 &amp;KEY FROM-END (TEST #'<code>EQL</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eql.htm" title="(EQL FUNCTION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/t_eql.htm" title="(EQL TYPE)"><code>1</code></a>)) (START1 0) END1 (START2 0) END2 KEY MAX-PREFIX-LENGTH MAX-SUFFIX-LENGTH</span></span></p>

<p>Like <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_mismat.htm" title="(MISMATCH FUNCTION)"><code>CL:MISMATCH</code></a> but <code>CAPTUREs</code> and returns the common prefix and
the mismatched suffixes. The <code>TEST-NOT</code> argument is deprecated by
the CLHS and is not supported. In addition, if <code>MAX-PREFIX-LENGTH</code> and
<code>MAX-SUFFIX-LENGTH</code> are non-<code>NIL</code>, they must be non-negative integers,
and they limit the number of elements in the prefix and the
suffixes.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">null <span class="paren3">(<span class="code">mismatch% '<span class="paren4">(<span class="code">1 2 3</span>)</span> '<span class="paren4">(<span class="code">1 2 4 5</span>)</span></span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">NULL #1=<span class="paren3">(<span class="code">MISMATCH% '<span class="paren4">(<span class="code">1 2 3</span>)</span> '<span class="paren4">(<span class="code">1 2 4 5</span>)</span></span>)</span></span>)</span></span>)</span>
where
  COMMON-PREFIX = <span class="paren1">(<span class="code">1 2</span>)</span>
  MISMATCHED-SUFFIX-1 = <span class="paren1">(<span class="code">3</span>)</span>
  MISMATCHED-SUFFIX-2 = <span class="paren1">(<span class="code">4 5</span>)</span>
  #1# = 2</span></code></pre>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">null <span class="paren3">(<span class="code">mismatch% <span class="string">"Hello, World!"</span>
                      <span class="string">"Hello,
World!"</span></span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS
   <span class="paren2">(<span class="code">NULL
    #1=<span class="paren3">(<span class="code">MISMATCH% <span class="string">"Hello, World!"</span> <span class="string">"Hello,
  World!"</span></span>)</span></span>)</span></span>)</span>
where
  COMMON-PREFIX = "Hello,"
  MISMATCHED-SUFFIX-1 = " World!"
  MISMATCHED-SUFFIX-2 = "
  World!"
  #1# = 6</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3ADIFFERENT-ELEMENTS-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L545">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ADIFFERENT-ELEMENTS-20FUNCTION-29" >DIFFERENT-ELEMENTS</a></span></span> <span class="locative-args">SEQUENCE1 SEQUENCE2 &amp;KEY (PRED #'<code>EQL</code>(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eql.htm" title="(EQL FUNCTION)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/t_eql.htm" title="(EQL TYPE)"><code>1</code></a>)) (MISSING <code>:MISSING</code>)</span></span></p>

<p>Return the different elements under <code>PRED</code> in the given sequences as
a list of <code>(:INDEX &lt;INDEX&gt; &lt;E1&gt; &lt;E2&gt;)</code> elements, where <code>E1</code> and <code>E2</code>
are elements of <code>SEQUENCE1</code> and <code>SEQUENCE2</code> at <code>&lt;INDEX&gt;</code>, respectively,
and they may be <code>MISSING</code> if the corresponding sequence is too short.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">is <span class="paren2">(<span class="code">endp <span class="paren3">(<span class="code">different-elements '<span class="paren4">(<span class="code">1 2 3</span>)</span> '<span class="paren4">(<span class="code">1 b 3 d</span>)</span></span>)</span></span>)</span></span>)</span>

UNEXPECTED-FAILURE in check:
  <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">ENDP #1=<span class="paren3">(<span class="code">DIFFERENT-ELEMENTS '<span class="paren4">(<span class="code">1 2 3</span>)</span> '<span class="paren4">(<span class="code">1 B 3 D</span>)</span></span>)</span></span>)</span></span>)</span>
where
  #1# = <span class="paren1">(<span class="code"><span class="paren2">(<span class="code"><span class="keyword">:INDEX</span> 1 2 B</span>)</span> <span class="paren2">(<span class="code"><span class="keyword">:INDEX</span> 3 <span class="keyword">:MISSING</span> D</span>)</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28TRY-3AWITH-SHUFFLING-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/checks.lisp#L573">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AWITH-SHUFFLING-20MGL-PAX-3AMACRO-29" >WITH-SHUFFLING</a></span></span> <span class="locative-args">NIL &amp;BODY BODY</span></span></p>

<p>Execute the forms that make up the list of forms <code>BODY</code> in random
order and return <code>NIL</code>. This may be useful to prevent writing tests
that accidentally depend on the order in which subtests are called.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">loop</span></i> repeat 3 do
  <span class="paren2">(<span class="code"><i><span class="symbol">with-shuffling</span></i> <span class="paren3">(<span class="code"></span>)</span>
    <span class="paren3">(<span class="code">prin1 1</span>)</span>
    <span class="paren3">(<span class="code">prin1 2</span>)</span></span>)</span></span>)</span>
.. 122112
=&gt; NIL</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCOMPARING-FLOATS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCHECK-UTILITIES-20MGL-PAX-3ASECTION-29" title="Check Utilities">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FCHECK-UTILITIES-20MGL-PAX-3ASECTION-29" title="Check Utilities">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCOMPARING-FLOATS-20MGL-PAX-3ASECTION-29" title="Comparing Floats">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/floats.lisp#L3">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FCOMPARING-FLOATS-20MGL-PAX-3ASECTION-29">6.3.1 Comparing Floats</a></h4>

<p>Float comparisons following
<a href="https://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/" >https://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/</a>.</p>

<p><a id='x-28TRY-3AFLOAT--7E-3D-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/floats.lisp#L18">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFLOAT--7E-3D-20FUNCTION-29" >FLOAT-~=</a></span></span> <span class="locative-args">X Y &amp;KEY (MAX-DIFF-IN-VALUE <a href="#x-28TRY-3A-2AMAX-DIFF-IN-VALUE-2A-20VARIABLE-29" title="(TRY:*MAX-DIFF-IN-VALUE* VARIABLE)"><code>*MAX-DIFF-IN-VALUE*</code></a>) (MAX-DIFF-IN-ULP <a href="#x-28TRY-3A-2AMAX-DIFF-IN-ULP-2A-20VARIABLE-29" title="(TRY:*MAX-DIFF-IN-ULP* VARIABLE)"><code>*MAX-DIFF-IN-ULP*</code></a>)</span></span></p>

<p>Return whether two numbers, <code>X</code> and <code>Y</code>, are approximately equal either
according to <code>MAX-DIFF-IN-VALUE</code> or <code>MAX-DIFF-IN-ULP</code>.</p>

<p>If the absolute value of the difference of two floats is not greater
than <code>MAX-DIFF-IN-VALUE</code>, then they are considered equal.</p>

<p>If two floats are of the same sign and the number of representable
floats (ULP, unit in the last place) between them is less than
<code>MAX-DIFF-IN-ULP</code>, then they are considered equal.</p>

<p>If neither <code>X</code> nor <code>Y</code> are floats, then the comparison is done with <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eq_sle.htm" title="(= FUNCTION)"><code>=</code></a>.
If one of them is a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/t_short_.htm" title="(DOUBLE-FLOAT TYPE)"><code>DOUBLE-FLOAT</code></a>, then the other is converted to a
double float, and the comparison takes place in double float space.
Else, both are converted to <a href="http://www.lispworks.com/documentation/HyperSpec/Body/t_short_.htm" title="(SINGLE-FLOAT TYPE)"><code>SINGLE-FLOAT</code></a> and the comparison takes
place in single float space.</p></li>
</ul>

<p><a id='x-28TRY-3A-2AMAX-DIFF-IN-VALUE-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/floats.lisp#L12">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AMAX-DIFF-IN-VALUE-2A-20VARIABLE-29" >*MAX-DIFF-IN-VALUE*</a></span></span> <span class="locative-args">1.0e-16</span></span></p>

<p>The default value of the <code>MAX-DIFF-IN-VALUE</code> argument of <a href="#x-28TRY-3AFLOAT--7E-3D-20FUNCTION-29" title="(TRY:FLOAT-~= FUNCTION)"><code>FLOAT-~=</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-2AMAX-DIFF-IN-ULP-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/floats.lisp#L15">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AMAX-DIFF-IN-ULP-2A-20VARIABLE-29" >*MAX-DIFF-IN-ULP*</a></span></span> <span class="locative-args">2</span></span></p>

<p>The default value of the <code>MAX-DIFF-IN-ULP</code> argument of <a href="#x-28TRY-3AFLOAT--7E-3D-20FUNCTION-29" title="(TRY:FLOAT-~= FUNCTION)"><code>FLOAT-~=</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AFLOAT--7E-3C-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/floats.lisp#L68">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFLOAT--7E-3C-20FUNCTION-29" >FLOAT-~&lt;</a></span></span> <span class="locative-args">X Y &amp;KEY (MAX-DIFF-IN-VALUE <a href="#x-28TRY-3A-2AMAX-DIFF-IN-VALUE-2A-20VARIABLE-29" title="(TRY:*MAX-DIFF-IN-VALUE* VARIABLE)"><code>*MAX-DIFF-IN-VALUE*</code></a>) (MAX-DIFF-IN-ULP <a href="#x-28TRY-3A-2AMAX-DIFF-IN-ULP-2A-20VARIABLE-29" title="(TRY:*MAX-DIFF-IN-ULP* VARIABLE)"><code>*MAX-DIFF-IN-ULP*</code></a>)</span></span></p>

<p>Return whether <code>X</code> is approximately less than <code>Y</code>. Equivalent to <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eq_sle.htm" title="(&lt; FUNCTION)"><code>&lt;</code></a>,
but it also allows for approximate equality according to <a href="#x-28TRY-3AFLOAT--7E-3D-20FUNCTION-29" title="(TRY:FLOAT-~= FUNCTION)"><code>FLOAT-~=</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AFLOAT--7E-3E-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/floats.lisp#L78">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AFLOAT--7E-3E-20FUNCTION-29" >FLOAT-~&gt;</a></span></span> <span class="locative-args">X Y &amp;KEY (MAX-DIFF-IN-VALUE <a href="#x-28TRY-3A-2AMAX-DIFF-IN-VALUE-2A-20VARIABLE-29" title="(TRY:*MAX-DIFF-IN-VALUE* VARIABLE)"><code>*MAX-DIFF-IN-VALUE*</code></a>) (MAX-DIFF-IN-ULP <a href="#x-28TRY-3A-2AMAX-DIFF-IN-ULP-2A-20VARIABLE-29" title="(TRY:*MAX-DIFF-IN-ULP* VARIABLE)"><code>*MAX-DIFF-IN-ULP*</code></a>)</span></span></p>

<p>Return whether <code>X</code> is approximately greater than <code>Y</code>. Equivalent to <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eq_sle.htm" title="(&gt; FUNCTION)"><code>&gt;</code></a>,
but it also allows for approximate equality according to <a href="#x-28TRY-3AFLOAT--7E-3D-20FUNCTION-29" title="(TRY:FLOAT-~= FUNCTION)"><code>FLOAT-~=</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCOMPARING-FLOATS-20MGL-PAX-3ASECTION-29" title="Comparing Floats">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Calling Test Functions">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29">7 Tests</a></h2>

<p>In Try, tests are Lisp functions that record their execution in
<a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> objects. <code>TRIAL</code>s are to tests what function call traces are to
functions. In more detail, tests</p>

<ul>
<li><p>create a <code>TRIAL</code> object and signal a <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> event upon entry to
  the function,</p></li>
<li><p>signal a <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> condition before returning normally or via a
  <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a>,</p></li>
<li><p>return the <code>TRIAL</code> object as the first value,</p></li>
<li><p>return explicitly returned values as the second, third, and so on
  values.</p></li>
</ul>

<p>See <a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" title="(TRY:DEFTEST MGL-PAX:MACRO)"><code>DEFTEST</code></a> and <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a> for more precise descriptions.</p>

<p><a id='x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L41">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" >DEFTEST</a></span></span> <span class="locative-args">NAME LAMBDA-LIST &amp;BODY BODY</span></span></p>

<p><code>DEFTEST</code> is a wrapper around <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm" title="(DEFUN MGL-PAX:MACRO)"><code>DEFUN</code></a> to define global test functions.
See <code>DEFUN</code> for a description of <code>NAME</code>, <code>LAMBDA-LIST</code>, and <code>BODY</code>. The
behaviour common with <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a> is described in <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">Tests</a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-test <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">write-string <span class="string">"hey"</span></span>)</span></span>)</span>
=&gt; MY-TEST

<span class="paren1">(<span class="code">test-bound-p 'my-test</span>)</span>
=&gt; T

<span class="paren1">(<span class="code">my-test</span>)</span>
.. hey
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-TEST</span>)</span> EXPECTED-SUCCESS 0.000s&gt;</span></code></pre>

<p>Although the common case is for tests to have no arguments, <code>DEFTEST</code>
supports general function lambda lists. Within a global test,</p>

<ul>
<li><p><code>NAME</code> is bound to the <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> object</p></li>
<li><p>the first return value is the trial</p></li>
<li><p>values are not returned implicitly</p></li>
<li><p>values returned with an explicit <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_ret_fr.htm" title="(RETURN-FROM MGL-PAX:MACRO)"><code>RETURN-FROM</code></a> are returned as
  values after the trial</p></li>
</ul>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-test <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">prin1 my-test</span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">return-from</span></i> my-test <span class="paren3">(<span class="code">values 2 3</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code">my-test</span>)</span>
.. #&lt;TRIAL <span class="paren1">(<span class="code">MY-TEST</span>)</span> RUNNING&gt;
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-TEST</span>)</span> EXPECTED-SUCCESS 0.000s&gt;
=&gt; 2
=&gt; 3</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3A-2ARUN-DEFTEST-WHEN-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L136">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ARUN-DEFTEST-WHEN-2A-20VARIABLE-29" >*RUN-DEFTEST-WHEN*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>This may be any of <code>:COMPILE-TOPLEVEL</code>, <code>:LOAD-TOPLEVEL</code>, <code>:EXECUTE</code>, or
a list thereof. The value of <code>*RUN-DEFTEST-WHEN*</code> determines in what
<a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_eval_w.htm" title="(EVAL-WHEN MGL-PAX:MACRO)"><code>EVAL-WHEN</code></a> situation to call the test function immediately after it
has been defined with <a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" title="(TRY:DEFTEST MGL-PAX:MACRO)"><code>DEFTEST</code></a>.</p>

<p>For interactive development, it may be convenient to set it to
<code>:EXECUTE</code> and have the test run when the <code>DEFTEST</code> is evaluated (maybe
with Slime <code>C-M-x</code>, <code>slime-eval-defun</code>). Or set it to
<code>:COMPILE-TOPLEVEL</code>, and have it rerun on Slime <code>C-c C-c</code>,
<code>slime-compile-defun</code>.</p>

<p>If the test has required arguments, an argument list is prompted for
and read from <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_debug_.htm" title="(*QUERY-IO* VARIABLE)"><code>*QUERY-IO*</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3ATEST-BOUND-P-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L361">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATEST-BOUND-P-20FUNCTION-29" >TEST-BOUND-P</a></span></span> <span class="locative-args">SYMBOL</span></span></p>

<p>See if <code>SYMBOL</code> names a global test (i.e. a test defined with
<a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" title="(TRY:DEFTEST MGL-PAX:MACRO)"><code>DEFTEST</code></a>). If since the execution of <code>DEFTEST</code>, the symbol has been
uninterned, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_fmakun.htm" title="(FMAKUNBOUND FUNCTION)"><code>FMAKUNBOUND</code></a>, or redefined with <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm" title="(DEFUN MGL-PAX:MACRO)"><code>DEFUN</code></a>, then it no longer
names a global test.</p></li>
</ul>

<p><a id='x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L191">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" >WITH-TEST</a></span></span> <span class="locative-args">(&amp;OPTIONAL TRIAL-VAR &amp;KEY NAME) &amp;BODY BODY</span></span></p>

<p>Define a so-called lambda test to group together <code>CHECK</code>s and other
tests it executes. <code>WITH-TEST</code> executes <code>BODY</code> in its lexical
environment even on a rerun (see <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>).</p>

<p>If <code>TRIAL-VAR</code> is a non-<code>NIL</code> symbol, bind it to the trial object.
<code>NAME</code> may be any type, it is purely for presentation purposes. If
<code>NAME</code> is <code>NIL</code>, then it defaults to <code>TRIAL-VAR</code>.</p>

<p>To facilitate returning values, a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_block.htm" title="(BLOCK MGL-PAX:MACRO)"><code>BLOCK</code></a> is wrapped around <code>BODY</code>. The
name of the block is <code>TRIAL-VAR</code> if it is a symbol, else it's <code>NIL</code>.</p>

<p>When both <code>TRIAL-VAR</code> and <code>NAME</code> are specified:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">some-feature <span class="keyword">:name</span> <span class="string">"obscure feature"</span></span>)</span>
  <span class="paren2">(<span class="code">prin1 some-feature</span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">return-from</span></i> some-feature <span class="paren3">(<span class="code">values 1 2</span>)</span></span>)</span></span>)</span>
.. #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code"><span class="string">"obscure feature"</span></span>)</span></span>)</span> RUNNING&gt;
.. obscure feature
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ obscure feature ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code"><span class="string">"obscure feature"</span></span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;
=&gt; 1
=&gt; 2</span></code></pre>

<p>If only <code>TRIAL-VAR</code> is specified:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">some-feature</span>)</span>
  <span class="paren2">(<span class="code">prin1 some-feature</span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">return-from</span></i> some-feature <span class="paren3">(<span class="code">values 1 2</span>)</span></span>)</span></span>)</span>
.. #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">SOME-FEATURE</span>)</span></span>)</span> RUNNING&gt;
.. SOME-FEATURE
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ SOME-FEATURE ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">SOME-FEATURE</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;
=&gt; 1
=&gt; 2</span></code></pre>

<p>If neither is specified:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">prin1 <span class="paren3">(<span class="code">current-trial</span>)</span></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span>
  <span class="paren2">(<span class="code">return <span class="paren3">(<span class="code">values 1 2</span>)</span></span>)</span></span>)</span>
.. #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">NIL</span>)</span></span>)</span> RUNNING&gt;
.. NIL
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ NIL ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">NIL</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;
=&gt; 1
=&gt; 2</span></code></pre>

<p>Finally, using that <code>NAME</code> defaults to <code>TRIAL-VAR</code> and that it is valid
to specify non-symbols for <code>TRIAL-VAR</code>, one can also write:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code"><span class="string">"Some feature"</span></span>)</span>
  <span class="paren2">(<span class="code">prin1 <span class="paren3">(<span class="code">current-trial</span>)</span></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span>
  <span class="paren2">(<span class="code">return <span class="paren3">(<span class="code">values 1 2</span>)</span></span>)</span></span>)</span>
.. #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code"><span class="string">"Some feature"</span></span>)</span></span>)</span> RUNNING&gt;
.. Some feature
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ Some feature ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code"><span class="string">"Some feature"</span></span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;
=&gt; 1
=&gt; 2</span></code></pre>

<p>In summary and in contrast to global tests (those defined with
<a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" title="(TRY:DEFTEST MGL-PAX:MACRO)"><code>DEFTEST</code></a>), lambda tests</p>

<ul>
<li><p>have no arguments,</p></li>
<li><p>are defined and called at the same time,</p></li>
<li><p>may not bind their trial object to any variable,</p></li>
<li><p>may have a <code>BLOCK</code> named <code>NIL</code>,</p></li>
<li><p>have a <code>NAME</code> purely for presentation purposes.</p></li>
</ul>

<p>Lambda tests can be thought of as analogous to <code>(FUNCALL (LAMBDA ()
BODY))</code>. The presence of the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_lambda.htm" title="(LAMBDA MGL-PAX:MACRO)"><code>LAMBDA</code></a> is important because it is
stored in the <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> object to support <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>.</p></li>
</ul>

<p><a id='x-28TRY-3ALIST-PACKAGE-TESTS-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L373">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ALIST-PACKAGE-TESTS-20FUNCTION-29" >LIST-PACKAGE-TESTS</a></span></span> <span class="locative-args">&amp;OPTIONAL (PACKAGE <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_pkg.htm" title="(*PACKAGE* VARIABLE)"><code>*PACKAGE*</code></a>)</span></span></p>

<p>List all symbols in <code>PACKAGE</code> that name global tests in the sense of
<a href="#x-28TRY-3ATEST-BOUND-P-20FUNCTION-29" title="(TRY:TEST-BOUND-P FUNCTION)"><code>TEST-BOUND-P</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3AWITH-TESTS-RUN-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L392">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AWITH-TESTS-RUN-20MGL-PAX-3AMACRO-29" >WITH-TESTS-RUN</a></span></span> <span class="locative-args">(TESTS-RUN) &amp;BODY BODY</span></span></p>

<p>Bind the symbol <code>TESTS-RUN</code> to an empty <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eq.htm" title="(EQ FUNCTION)"><code>EQ</code></a> hash table and execute
<code>BODY</code>. The has table reflects call counts to global tests. Keys are
symbols naming global tests, and the values are the number of times
the keys have been called.</p></li>
</ul>

<p><a id='x-28TRY-3AWARN-ON-TESTS-NOT-RUN-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/test.lisp#L405">[macro]</a></span> <span class="reference-object"><a href="#x-28TRY-3AWARN-ON-TESTS-NOT-RUN-20MGL-PAX-3AMACRO-29" >WARN-ON-TESTS-NOT-RUN</a></span></span> <span class="locative-args">(&amp;OPTIONAL (PACKAGE <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_pkg.htm" title="(*PACKAGE* VARIABLE)"><code>*PACKAGE*</code></a>)) &amp;BODY BODY</span></span></p>

<p>A convenience utility to that records the global tests run by <code>BODY</code>
with <a href="#x-28TRY-3AWITH-TESTS-RUN-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TESTS-RUN MGL-PAX:MACRO)"><code>WITH-TESTS-RUN</code></a> and, when <code>BODY</code> finishes, signals a warning for
each global tests in <code>PACKAGE</code> not run.</p>

<p>This is how Try runs its own tests:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> test <span class="paren2">(<span class="code"></span>)</span>
  <span class="comment">;; Bind *PACKAGE* so that names of tests printed have package names,
</span>  <span class="comment">;; and M-. works on them in Slime.
</span>  <span class="paren2">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code"><span class="special">*package*</span> <span class="paren5">(<span class="code">find-package <span class="keyword">:common-lisp</span></span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">warn-on-tests-not-run <span class="paren4">(<span class="code"><span class="paren5">(<span class="code">find-package <span class="keyword">:try</span></span>)</span></span>)</span>
      <span class="paren4">(<span class="code">print <span class="paren5">(<span class="code">try 'test-all
                  <span class="keyword">:print</span> 'unexpected
                  <span class="keyword">:describe</span> 'unexpected</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Calling Test Functions">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L3">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29">7.1 Calling Test Functions</a></h3>

<p>Tests can be run explicitly by invoking the <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> function or
implicitly by calling a test function:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-test <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code">my-test</span>)</span>
.. MY-TEST
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ MY-TEST ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-TEST</span>)</span> EXPECTED-SUCCESS 0.004s ⋅1&gt;</span></code></pre>

<p>The situation is similar with a <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a>:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">my-test</span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>
.. MY-TEST
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ MY-TEST ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">MY-TEST</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;</span></code></pre>

<p>Behind the scenes, the outermost test function calls <code>TRY</code> with</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">try trial <span class="keyword">:debug</span> <span class="special">*debug*</span> <span class="keyword">:collect</span> <span class="special">*collect*</span> <span class="keyword">:rerun</span> <span class="special">*rerun*</span>
     <span class="keyword">:print</span> <span class="special">*print*</span> <span class="keyword">:describe</span> <span class="special">*describe*</span>
     <span class="keyword">:stream</span> <span class="special">*stream*</span> <span class="keyword">:printer</span> <span class="special">*printer*</span></span>)</span></span></code></pre>

<p><code>TRY</code> then calls the test function belonging to <code>TRIAL</code>.
The rest of the behaviour is described in <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">Explicit TRY</a>.</p>

<p><a id='x-28TRY-3A-2ADEBUG-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L50">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ADEBUG-2A-20VARIABLE-29" >*DEBUG*</a></span></span> <span class="locative-args">(AND UNEXPECTED (NOT NLX) (NOT VERDICT))</span></span></p>

<p>The default value makes <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> invoke the debugger on <a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>,
<a href="#x-28TRY-3ARESULT-ABORT-2A-20CONDITION-29" title="(TRY:RESULT-ABORT* CONDITION)"><code>RESULT-ABORT*</code></a>, <a href="#x-28TRY-3AUNEXPECTED-RESULT-FAILURE-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-FAILURE CONDITION)"><code>UNEXPECTED-RESULT-FAILURE</code></a>, and
<a href="#x-28TRY-3AUNEXPECTED-RESULT-SUCCESS-20CONDITION-29" title="(TRY:UNEXPECTED-RESULT-SUCCESS CONDITION)"><code>UNEXPECTED-RESULT-SUCCESS</code></a>. <a href="#x-28TRY-3ANLX-20CONDITION-29" title="(TRY:NLX CONDITION)"><code>NLX</code></a> is excluded because it is caught as
the test function is being exited, but by that time the dynamic
environment of the actual cause is likely gone. <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> is excluded
because it is a consequence of its child outcomes.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ACOUNT-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L58">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ACOUNT-2A-20VARIABLE-29" >*COUNT*</a></span></span> <span class="locative-args">LEAF</span></span></p>

<p>Although the default value of <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a> lumps <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>s and
<a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>s together, with the default of <a href="#x-28TRY-3ALEAF-20CONDITION-29" title="(TRY:LEAF CONDITION)"><code>LEAF</code></a>, <code>VERDICT</code>s are not
counted.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ACOLLECT-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L63">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ACOLLECT-2A-20VARIABLE-29" >*COLLECT*</a></span></span> <span class="locative-args">UNEXPECTED</span></span></p>

<p>To save memory, only the <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> are collected by default.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ARERUN-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L66">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ARERUN-2A-20VARIABLE-29" >*RERUN*</a></span></span> <span class="locative-args">UNEXPECTED</span></span></p>

<p>The default matches that of <a href="#x-28TRY-3A-2ACOLLECT-2A-20VARIABLE-29" title="(TRY:*COLLECT* VARIABLE)"><code>*COLLECT*</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-2APRINT-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L69">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2APRINT-2A-20VARIABLE-29" >*PRINT*</a></span></span> <span class="locative-args">LEAF</span></span></p>

<p>With the default of <a href="#x-28TRY-3ALEAF-20CONDITION-29" title="(TRY:LEAF CONDITION)"><code>LEAF</code></a> combined with the default <a href="#x-28TRY-3A-2APRINT-PARENT-2A-20VARIABLE-29" title="(TRY:*PRINT-PARENT* VARIABLE)"><code>*PRINT-PARENT*</code></a>
<code>T</code>, only <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>s with checks or <a href="#x-28TRY-3AERROR-2A-20CONDITION-29" title="(TRY:ERROR* CONDITION)"><code>ERROR*</code></a> in them are printed. If
<a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>, only the interesting things are printed.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ADESCRIBE-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L74">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ADESCRIBE-2A-20VARIABLE-29" >*DESCRIBE*</a></span></span> <span class="locative-args">UNEXPECTED</span></span></p>

<p>By default, the context (e.g. <a href="#x-28TRY-3A-40TRY-2FCAPTURES-20MGL-PAX-3ASECTION-29" title="Captures">Captures</a>, and the <code>CTX</code> argument
of is and other checks) of <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> events is described.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ASTREAM-2A-20-28VARIABLE-20-28MAKE-SYNONYM-STREAM-20-28QUOTE-20-2ADEBUG-IO-2A-29-29-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L78">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ASTREAM-2A-20-28VARIABLE-20-28MAKE-SYNONYM-STREAM-20-28QUOTE-20-2ADEBUG-IO-2A-29-29-29-29" >*STREAM*</a></span></span> <span class="locative-args">(MAKE-SYNONYM-STREAM '*DEBUG-IO*)</span></span></li>
</ul>

<p><a id='x-28TRY-3A-2APRINTER-2A-20VARIABLE-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L80">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2APRINTER-2A-20VARIABLE-29" >*PRINTER*</a></span></span> <span class="locative-args">TREE-PRINTER</span></span></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Calling Test Functions">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29" title="Testables">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L89">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29">7.2 Explicit TRY</a></h3>

<p>Instead of invoking the test function directly, tests can also be
run by invoking the <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> function.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">deftest</span></i> my-test <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">is t</span>)</span></span>)</span>

<span class="paren1">(<span class="code">try 'my-test</span>)</span>
.. MY-TEST
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ MY-TEST ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">MY-TEST</span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;</span></code></pre>

<p>The situation is similar with a <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a>, only that <code>TRY</code> wraps an
extra <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> around the execution of the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_lambda.htm" title="(LAMBDA MGL-PAX:MACRO)"><code>LAMBDA</code></a> to ensure that all
<a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s are signalled within a trial.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">try <span class="paren2">(<span class="code"><i><span class="symbol">lambda</span></i> <span class="paren3">(<span class="code"></span>)</span>
       <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">my-test</span>)</span>
         <span class="paren4">(<span class="code">is t</span>)</span></span>)</span></span>)</span></span>)</span>
.. <span class="paren1">(<span class="code">TRY #&lt;<i><span class="symbol">FUNCTION</span></i> <span class="paren2">(<span class="code"><i><span class="symbol">LAMBDA</span></i> <span class="paren3">(<span class="code"></span>)</span></span>)</span> {531FE50B}&gt;</span>)</span>
..   MY-TEST
..     ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..   ⋅ MY-TEST ⋅1
.. ⋅ <span class="paren1">(<span class="code">TRY #&lt;<i><span class="symbol">FUNCTION</span></i> <span class="paren2">(<span class="code"><i><span class="symbol">LAMBDA</span></i> <span class="paren3">(<span class="code"></span>)</span></span>)</span> {531FE50B}&gt;</span>)</span> ⋅1
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code">TRY #&lt;<i><span class="symbol">FUNCTION</span></i> <span class="paren2">(<span class="code"><i><span class="symbol">LAMBDA</span></i> <span class="paren3">(<span class="code"></span>)</span></span>)</span> {531FE50B}&gt;</span>)</span> EXPECTED-SUCCESS 0.000s ⋅1&gt;</span></code></pre>

<p>Invoking tests with an explicit <code>TRY</code> is very similar to just calling
the test functions directly (see <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Calling Test Functions">Calling Test Functions</a>). The differences
are that <code>TRY</code></p>

<ul>
<li><p>can run <a href="#x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29" title="Testables">Testables</a>,</p></li>
<li><p>has a function argument for each of the <a href="#x-28TRY-3A-2ADEBUG-2A-20VARIABLE-29" title="(TRY:*DEBUG* VARIABLE)"><code>*DEBUG*</code></a>, <a href="#x-28TRY-3A-2ACOLLECT-2A-20VARIABLE-29" title="(TRY:*COLLECT* VARIABLE)"><code>*COLLECT*</code></a>, etc
  variables.</p></li>
</ul>

<p>Those arguments default to <a href="#x-28TRY-3A-2ATRY-DEBUG-2A-20VARIABLE-29" title="(TRY:*TRY-DEBUG* VARIABLE)"><code>*TRY-DEBUG*</code></a>, <a href="#x-28TRY-3A-2ATRY-COLLECT-2A-20VARIABLE-29" title="(TRY:*TRY-COLLECT* VARIABLE)"><code>*TRY-COLLECT*</code></a>, etc, which
parallel and default to <code>*DEBUG*</code>, <code>*COLLECT*</code>, etc if set to
<code>:UNSPECIFIED</code>. <code>*TRY-DEBUG*</code> is <code>NIL</code>, the rest of them are <code>:UNSPECIFIED</code>.</p>

<p>These defaults encourage the use of an explicit <code>TRY</code> call in the
non-interactive case and calling the test functions directly in the
interactive one, but this is not enforced in any way.</p>

<p><a id='x-28TRY-3ATRY-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L323">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATRY-20FUNCTION-29" >TRY</a></span></span> <span class="locative-args">TESTABLE &amp;KEY (DEBUG <a href="#x-28TRY-3A-2ATRY-DEBUG-2A-20VARIABLE-29" title="(TRY:*TRY-DEBUG* VARIABLE)"><code>*TRY-DEBUG*</code></a>) (COUNT <a href="#x-28TRY-3A-2ATRY-COUNT-2A-20VARIABLE-29" title="(TRY:*TRY-COUNT* VARIABLE)"><code>*TRY-COUNT*</code></a>) (COLLECT <a href="#x-28TRY-3A-2ATRY-COLLECT-2A-20VARIABLE-29" title="(TRY:*TRY-COLLECT* VARIABLE)"><code>*TRY-COLLECT*</code></a>) (RERUN <a href="#x-28TRY-3A-2ATRY-RERUN-2A-20VARIABLE-29" title="(TRY:*TRY-RERUN* VARIABLE)"><code>*TRY-RERUN*</code></a>) (PRINT <a href="#x-28TRY-3A-2ATRY-PRINT-2A-20VARIABLE-29" title="(TRY:*TRY-PRINT* VARIABLE)"><code>*TRY-PRINT*</code></a>) (DESCRIBE <a href="#x-28TRY-3A-2ATRY-DESCRIBE-2A-20VARIABLE-29" title="(TRY:*TRY-DESCRIBE* VARIABLE)"><code>*TRY-DESCRIBE*</code></a>) (STREAM <a href="#x-28TRY-3A-2ATRY-STREAM-2A-20VARIABLE-29" title="(TRY:*TRY-STREAM* VARIABLE)"><code>*TRY-STREAM*</code></a>) (PRINTER <a href="#x-28TRY-3A-2ATRY-PRINTER-2A-20VARIABLE-29" title="(TRY:*TRY-PRINTER* VARIABLE)"><code>*TRY-PRINTER*</code></a>)</span></span></p>

<p><code>TRY</code> runs <code>TESTABLE</code> and handles the <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s to collect, debug, print
the results of checks and trials, and to decide what tests to skip
and what to rerun.</p>

<p><code>DEBUG</code>, <code>COUNT</code>, <code>COLLECT</code>, <code>RERUN</code>, <code>PRINT</code>, and <code>DESCRIBE</code> must all be valid
specifiers for types that are either <code>NIL</code> (the empty type) or have a
non-empty intersection with the type <code>EVENT</code> (e.g. <code>T</code>, <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>,
<a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>, <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>).</p>

<p><code>TRY</code> sets up a <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_handle.htm" title="(HANDLER-BIND MGL-PAX:MACRO)"><code>HANDLER-BIND</code></a> handler for <code>EVENT</code>s and runs <code>TESTABLE</code> (see
<a href="#x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29" title="Testables">Testables</a>). When an <code>EVENT</code> is signalled, the handler matches its
type to the value of the <code>DEBUG</code> argument (in the sense of <code>(TYPEP
EVENT DEBUG)</code>). If it matches, then the debugger is invoked with the
event. In the debugger, the user has a number of restarts available
to change (see <a href="#x-28TRY-3A-40TRY-2FEVENT-RESTARTS-20MGL-PAX-3ASECTION-29" title="Event Restarts">Event Restarts</a>, <a href="#x-28TRY-3A-40TRY-2FOUTCOME-RESTARTS-20MGL-PAX-3ASECTION-29" title="Outcome Restarts">Outcome Restarts</a>,
<a href="#x-28TRY-3A-40TRY-2FCHECK-RESTARTS-20MGL-PAX-3ASECTION-29" title="Check Restarts">Check Restarts</a>, <a href="#x-28TRY-3A-40TRY-2FTRIAL-RESTARTS-20MGL-PAX-3ASECTION-29" title="Trial Restarts">Trial Restarts</a>, and <a href="#x-28TRY-3ASET-TRY-DEBUG-20FUNCTION-29" title="(TRY:SET-TRY-DEBUG FUNCTION)"><code>SET-TRY-DEBUG</code></a>.</p>

<p>If the debugger is not invoked, <code>TRY</code> invokes the very first restart
available, which is always <a href="#x-28TRY-3ARECORD-EVENT-20FUNCTION-29" title="(TRY:RECORD-EVENT FUNCTION)"><code>RECORD-EVENT</code></a>.</p>

<p>Recording the event is performed as follows.</p>

<ul>
<li><p>Outcome counts are updated (see <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">Counting Events</a>).</p></li>
<li><p>The event is passed to the collector (see <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">Collecting Events</a>).</p></li>
<li><p>The event is passed to the printer (see <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">Printing Events</a>).</p></li>
<li><p>Finally, when rerunning a trial (i.e. when <code>TESTABLE</code> is a trial),
  on a <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> event, the trial may be skipped (see <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>).</p></li>
</ul>

<p><code>TRY</code> returns the values returned by the outermost trial (see
<a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">Tests</a>).</p></li>
</ul>

<p><a id='x-28TRY-3ASET-TRY-DEBUG-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L283">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ASET-TRY-DEBUG-20FUNCTION-29" >SET-TRY-DEBUG</a></span></span> <span class="locative-args">DEBUG</span></span></p>

<p>Invoke the <code>SET-TRY-DEBUG</code> restart to override the <code>DEBUG</code> argument of
the currently running <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>. <code>DEBUG</code> must thus be a suitable type. When
the <code>SET-TRY-DEBUG</code> restart is invoked interactively, <code>DEBUG</code> is read as
a non-evaluated form from <a href="http://www.lispworks.com/documentation/HyperSpec/Body/v_debug_.htm" title="(*QUERY-IO* VARIABLE)"><code>*QUERY-IO*</code></a>.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-DEBUG-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L155">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-DEBUG-2A-20VARIABLE-29" >*TRY-DEBUG*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:DEBUG</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2ADEBUG-2A-20VARIABLE-29" title="(TRY:*DEBUG* VARIABLE)"><code>*DEBUG*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-COUNT-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L158">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-COUNT-2A-20VARIABLE-29" >*TRY-COUNT*</a></span></span> <span class="locative-args">:UNSPECIFIED</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:COUNT</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2ACOUNT-2A-20VARIABLE-29" title="(TRY:*COUNT* VARIABLE)"><code>*COUNT*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-COLLECT-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L161">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-COLLECT-2A-20VARIABLE-29" >*TRY-COLLECT*</a></span></span> <span class="locative-args">:UNSPECIFIED</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:COLLECT</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2ACOLLECT-2A-20VARIABLE-29" title="(TRY:*COLLECT* VARIABLE)"><code>*COLLECT*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-RERUN-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L164">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-RERUN-2A-20VARIABLE-29" >*TRY-RERUN*</a></span></span> <span class="locative-args">:UNSPECIFIED</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:RERUN</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2ARERUN-2A-20VARIABLE-29" title="(TRY:*RERUN* VARIABLE)"><code>*RERUN*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-PRINT-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L167">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-PRINT-2A-20VARIABLE-29" >*TRY-PRINT*</a></span></span> <span class="locative-args">:UNSPECIFIED</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:PRINT</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2APRINT-2A-20VARIABLE-29" title="(TRY:*PRINT* VARIABLE)"><code>*PRINT*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-DESCRIBE-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L170">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-DESCRIBE-2A-20VARIABLE-29" >*TRY-DESCRIBE*</a></span></span> <span class="locative-args">:UNSPECIFIED</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:DESCRIBE</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2ADESCRIBE-2A-20VARIABLE-29" title="(TRY:*DESCRIBE* VARIABLE)"><code>*DESCRIBE*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-STREAM-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L173">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-STREAM-2A-20VARIABLE-29" >*TRY-STREAM*</a></span></span> <span class="locative-args">:UNSPECIFIED</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:STREAM</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2ASTREAM-2A-20-28VARIABLE-20-28MAKE-SYNONYM-STREAM-20-28QUOTE-20-2ADEBUG-IO-2A-29-29-29-29" title="(TRY:*STREAM* (VARIABLE (MAKE-SYNONYM-STREAM (QUOTE *DEBUG-IO*))))"><code>*STREAM*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ATRY-PRINTER-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L176">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ATRY-PRINTER-2A-20VARIABLE-29" >*TRY-PRINTER*</a></span></span> <span class="locative-args">:UNSPECIFIED</span></span></p>

<p>The default value for <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>'s <code>:PRINTER</code> argument. If
<code>:UNSPECIFIED</code>, then the value of <a href="#x-28TRY-3A-2APRINTER-2A-20VARIABLE-29" title="(TRY:*PRINTER* VARIABLE)"><code>*PRINTER*</code></a> is used instead.</p></li>
</ul>

<p><a id='x-28TRY-3A-2AN-RECENT-TRIALS-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L300">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2AN-RECENT-TRIALS-2A-20VARIABLE-29" >*N-RECENT-TRIALS*</a></span></span> <span class="locative-args">3</span></span></p>

<p>See <code>*RECENT-TRIALS*</code>.</p></li>
</ul>

<p><a id='x-28TRY-3ARECENT-TRIAL-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L294">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3ARECENT-TRIAL-20FUNCTION-29" >RECENT-TRIAL</a></span></span> <span class="locative-args">&amp;OPTIONAL (N 0)</span></span></p>

<p>Returns the <code>N</code>th most recent trial or <code>NIL</code> if there are not enough
trials recorded. Every <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> returned by <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> gets pushed
onto a list of trials, but only <a href="#x-28TRY-3A-2AN-RECENT-TRIALS-2A-20VARIABLE-29" title="(TRY:*N-RECENT-TRIALS* VARIABLE)"><code>*N-RECENT-TRIALS*</code></a> are kept.</p></li>
</ul>

<p><a id='x-28TRY-3A-21-20-28VARIABLE-20NIL-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L303">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-21-20-28VARIABLE-20NIL-29-29" >!</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>The most recent trial. Equivalent to <code>(RECENT-TRIAL 0)</code>.</p></li>
</ul>

<p><a id='x-28TRY-3A-21-21-20-28VARIABLE-20NIL-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L305">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-21-21-20-28VARIABLE-20NIL-29-29" >!!</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>Equivalent to <code>(RECENT-TRIAL 1)</code>.</p></li>
</ul>

<p><a id='x-28TRY-3A-21-21-21-20-28VARIABLE-20NIL-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L307">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-21-21-21-20-28VARIABLE-20NIL-29-29" >!!!</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>Equivalent to <code>(RECENT-TRIAL 2)</code>.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-IMPLEMENTATION-20MGL-PAX-3ASECTION-29" title="Implementation of Implicit TRY">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29" title="Testables">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/testable.lisp#L3">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29">7.2.1 Testables</a></h4>

<p>Valid first arguments to <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> are called testables. A testable may
be:</p>

<ul>
<li><p>a <a href="#x-28TRY-3A-3A-40FUNCTION-DESIGNATOR-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@FUNCTION-DESIGNATOR MGL-PAX:GLOSSARY-TERM)">function designator</a></p>

<ul>
<li><p>the name of a global test</p></li>
<li><p>the name of a global function</p></li>
<li><p>a function object</p></li>
<li><p>a trial</p></li>
</ul></li>
<li><p>a list of testables</p></li>
<li><p>a <code>PACKAGE</code>(<a href="mgl-pax-manual.html#x-28PACKAGE-20MGL-PAX-3ALOCATIVE-29" title="(PACKAGE MGL-PAX:LOCATIVE)"><code>0</code></a> <a href="http://www.lispworks.com/documentation/HyperSpec/Body/t_pkg.htm" title="(PACKAGE TYPE)"><code>1</code></a>)</p></li>
</ul>

<p>In the function designator cases, <code>TRY</code> calls the designated function.
<a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>s, being <a href="#x-28TRY-3A-3A-40FUNCALLABLE-INSTANCE-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@FUNCALLABLE-INSTANCE MGL-PAX:GLOSSARY-TERM)">funcallable instance</a>s, designate themselves. If the
trial is not <a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" title="(TRY:RUNNINGP FUNCTION)"><code>RUNNINGP</code></a>, then it will be rerun (see <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>). Don't
invoke <code>TRY</code> with <code>RUNNINGP</code> trials (but see
<a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-IMPLEMENTATION-20MGL-PAX-3ASECTION-29" title="Implementation of Implicit TRY">Implementation of Implicit TRY</a> for discussion).</p>

<p>When given a list of testables, <code>TRY</code> calls each testable one by one.</p>

<p>Finally, a <code>PACKAGE</code> stands for the result of calling
<a href="#x-28TRY-3ALIST-PACKAGE-TESTS-20FUNCTION-29" title="(TRY:LIST-PACKAGE-TESTS FUNCTION)"><code>LIST-PACKAGE-TESTS</code></a> on that package.</p>

<p><a id='x-28TRY-3A-40TRY-2FIMPLICIT-TRY-IMPLEMENTATION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FTESTABLES-20MGL-PAX-3ASECTION-29" title="Testables">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-IMPLEMENTATION-20MGL-PAX-3ASECTION-29" title="Implementation of Implicit TRY">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/try.lisp#L195">&#955;</a></span></span></p>

<h4><a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-IMPLEMENTATION-20MGL-PAX-3ASECTION-29">7.2.2 Implementation of Implicit TRY</a></h4>

<p>What's happening in the implementation is that a test function,
when it is called, checks whether it is running under the <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>
function. If it isn't, then it invokes <code>TRY</code> with its <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>. <code>TRY</code>
realizes the trial cannot be rerun yet (see <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a>) because it
is <a href="#x-28TRY-3ARUNNINGP-20FUNCTION-29" title="(TRY:RUNNINGP FUNCTION)"><code>RUNNINGP</code></a>, sets up its event handlers for debugging, collecting,
printing, and invokes the trial as if it were rerun but without
skipping anything based on the <code>RERUN</code> argument. Thus the following
are infinite recursions:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">recurse</span>)</span>
  <span class="paren2">(<span class="code">try recurse</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren2">(<span class="code">recurse</span>)</span>
  <span class="paren2">(<span class="code">funcall recurse</span>)</span></span>)</span></span></code></pre>

<p><a id='x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-IMPLEMENTATION-20MGL-PAX-3ASECTION-29" title="Implementation of Implicit TRY">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/print.lisp#L5">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29">7.3 Printing Events</a></h3>

<p><a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> instantiates a printer of the type given by its <code>PRINTER</code>
argument. All <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s recorded by <code>TRY</code> are sent to this printer. The
printer then prints events that match the type given by the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_wr_pr.htm" title="(PRINT FUNCTION)"><code>PRINT</code></a>
argument of <code>TRY</code>. Events that also match the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_descri.htm" title="(DESCRIBE FUNCTION)"><code>DESCRIBE</code></a> argument of <code>TRY</code>
are printed with context information (see <a href="#x-28TRY-3AIS-20MGL-PAX-3AMACRO-29" title="(TRY:IS MGL-PAX:MACRO)"><code>IS</code></a>) and backtraces (see
<a href="#x-28TRY-3AUNHANDLED-ERROR-20CONDITION-29" title="(TRY:UNHANDLED-ERROR CONDITION)"><code>UNHANDLED-ERROR</code></a>).</p>

<p>Although the printing is primarily customized with global special
variables, changing the value of those variables after the printer
object is instantiated by <code>TRY</code> has no effect. This is to ensure
consistent output with nested <code>TRY</code> calls of differing printer
setups.</p>

<p><a id='x-28TRY-3ATREE-PRINTER-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/print.lisp#L349">[class]</a></span> <span class="reference-object"><a href="#x-28TRY-3ATREE-PRINTER-20CLASS-29" >TREE-PRINTER</a></span></span></span></p>

<p><code>TREE-PRINTER</code> prints events in an indented
tree-like structure, with each internal node corresponding to a
<a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>. This is the default printer (according to <a href="#x-28TRY-3A-2APRINTER-2A-20VARIABLE-29" title="(TRY:*PRINTER* VARIABLE)"><code>*PRINTER*</code></a> and
<a href="#x-28TRY-3A-2ATRY-PRINTER-2A-20VARIABLE-29" title="(TRY:*TRY-PRINTER* VARIABLE)"><code>*TRY-PRINTER*</code></a>) and currently the only one.</p>

<p>The following example prints all <a href="#x-28TRY-3A-40TRY-2FCONCRETE-EVENTS-20MGL-PAX-3ASECTION-29" title="Concrete Events">Concrete Events</a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*print*</span> '<span class="paren4">(<span class="code">not trial-start</span>)</span></span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*describe*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">verdict-abort*</span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">expected-verdict-success</span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-expected-outcome</span></i> <span class="paren4">(<span class="code">'failure</span>)</span>
      <span class="paren4">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren5">(<span class="code">unexpected-verdict-success</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">handler-bind <span class="paren4">(<span class="code"><span class="paren5">(<span class="code"><span class="paren6">(<span class="code">and verdict success</span>)</span> #'force-expected-failure</span>)</span></span>)</span>
      <span class="paren4">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren5">(<span class="code">expected-verdict-failure</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">handler-bind <span class="paren4">(<span class="code"><span class="paren5">(<span class="code"><span class="paren6">(<span class="code">and verdict success</span>)</span> #'force-unexpected-failure</span>)</span></span>)</span>
      <span class="paren4">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren5">(<span class="code">unexpected-verdict-failure</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">verdict-skip</span>)</span>
      <span class="paren4">(<span class="code">skip-trial</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">is t <span class="keyword">:msg</span> <span class="string">"EXPECTED-RESULT-SUCCESS"</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-failure-expected</span></i> <span class="paren4">(<span class="code">'failure</span>)</span>
      <span class="paren4">(<span class="code">is t <span class="keyword">:msg</span> <span class="string">"UNEXPECTED-RESULT-SUCCESS"</span></span>)</span>
      <span class="paren4">(<span class="code">is nil <span class="keyword">:msg</span> <span class="string">"EXPECTED-RESULT-FAILURE"</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">is nil <span class="keyword">:msg</span> <span class="string">"UNEXPECTED-RESULT-FAILURE"</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-skip</span></i> <span class="paren4">(<span class="code"></span>)</span>
      <span class="paren4">(<span class="code">is nil <span class="keyword">:msg</span> <span class="string">"RESULT-SKIP"</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">handler-bind <span class="paren4">(<span class="code"><span class="paren5">(<span class="code"><span class="paren6">(<span class="code">and result success</span>)</span> #'abort-check</span>)</span></span>)</span>
      <span class="paren4">(<span class="code">is t <span class="keyword">:msg</span> <span class="string">"RESULT-ABORT*"</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">catch</span></i> 'foo
      <span class="paren4">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren5">(<span class="code">nlx-test</span>)</span>
        <span class="paren5">(<span class="code"><i><span class="symbol">throw</span></i> 'foo nil</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">error <span class="string">"UNHANDLED-ERROR"</span></span>)</span></span>)</span></span>)</span>
.. VERDICT-ABORT*                       <span class="comment">; TRIAL-START
</span>..   ⋅ EXPECTED-VERDICT-SUCCESS
..   ⊡ UNEXPECTED-VERDICT-SUCCESS
..   × EXPECTED-VERDICT-FAILURE
..   ⊠ UNEXPECTED-VERDICT-FAILURE
..   - VERDICT-SKIP
..   ⋅ EXPECTED-RESULT-SUCCESS
..   ⊡ UNEXPECTED-RESULT-SUCCESS
..   × EXPECTED-RESULT-FAILURE
..   ⊠ UNEXPECTED-RESULT-FAILURE
..   - RESULT-SKIP
..   ⊟ RESULT-ABORT*
..   NLX-TEST                           <span class="comment">; TRIAL-START
</span>..     ⊟ non-local exit                 <span class="comment">; NLX
</span>..   ⊟ NLX-TEST ⊟1                      <span class="comment">; VERDICT-ABORT*
</span>..   ⊟ "UNHANDLED-ERROR" <span class="paren1">(<span class="code">SIMPLE-ERROR</span>)</span>
.. ⊟ VERDICT-ABORT* ⊟3 ⊠1 -1 ×1 ⋅2
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">VERDICT-ABORT*</span>)</span></span>)</span> ABORT* 0.004s ⊟3 ⊠1 ⊡1 -1 ×1 ⋅1&gt;</span></code></pre>

<p>The <code>⊟3 ⊠1 ⊡1 -1 ×1 ⋅1</code> part is the counts for <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a> printed
with their markers.</p></li>
</ul>

<p><a id='x-28TRY-3A-2APRINT-PARENT-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/print.lisp#L57">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2APRINT-PARENT-2A-20VARIABLE-29" >*PRINT-PARENT*</a></span></span> <span class="locative-args">T</span></span></p>

<p>When an <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> is signalled and its parent <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>'s type matches
<code>*PRINT-PARENT*</code>, the trial is printed as if its <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> matched
the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_wr_pr.htm" title="(PRINT FUNCTION)"><code>PRINT</code></a> argument of <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print*</span> 'leaf</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*print-parent*</span> t</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">t0</span>)</span>
    <span class="paren3">(<span class="code">is t</span>)</span>
    <span class="paren3">(<span class="code">is t</span>)</span></span>)</span></span>)</span>
.. T0
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ T0 ⋅2
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">T0</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅2&gt;</span></code></pre>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print*</span> 'leaf</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*print-parent*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">t0</span>)</span>
    <span class="paren3">(<span class="code">is t</span>)</span>
    <span class="paren3">(<span class="code">is t</span>)</span></span>)</span></span>)</span>
.. ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
.. ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">T0</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅2&gt;</span></code></pre>

<p><code>*PRINT-PARENT*</code> <code>NIL</code> combined with printing <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>s results in a flat
 output:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print*</span> '<span class="paren4">(<span class="code">or leaf verdict</span>)</span></span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*print-parent*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">outer</span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">inner</span>)</span>
      <span class="paren4">(<span class="code">is t <span class="keyword">:msg</span> <span class="string">"inner-t"</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code">is t <span class="keyword">:msg</span> <span class="string">"outer-t"</span></span>)</span></span>)</span></span>)</span>
.. ⋅ inner-t
.. ⋅ INNER ⋅1
.. ⋅ outer-t
.. ⋅ OUTER ⋅2
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">OUTER</span>)</span></span>)</span> EXPECTED-SUCCESS 0.000s ⋅2&gt;</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3A-2APRINT-INDENTATION-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/print.lisp#L259">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2APRINT-INDENTATION-2A-20VARIABLE-29" >*PRINT-INDENTATION*</a></span></span> <span class="locative-args">2</span></span></p>

<p>The number of spaces each printed <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> increases the indentation
of its children.</p></li>
</ul>

<p><a id='x-28TRY-3A-2APRINT-DURATION-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/print.lisp#L263">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2APRINT-DURATION-2A-20VARIABLE-29" >*PRINT-DURATION*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>If true, the number of seconds spent during execution is printed.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print-duration*</span> t</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*describe*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">timed</span>)</span>
    <span class="paren3">(<span class="code">is <span class="paren4">(<span class="code"><i><span class="symbol">progn</span></i> <span class="paren5">(<span class="code">sleep 0.3</span>)</span> t</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">is <span class="paren4">(<span class="code"><i><span class="symbol">progn</span></i> <span class="paren5">(<span class="code">sleep 0.2</span>)</span> t</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">error <span class="string">"xxx"</span></span>)</span></span>)</span></span>)</span>
..        TIMED
..  0.300   ⋅ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code"><i><span class="symbol">PROGN</span></i> <span class="paren3">(<span class="code">SLEEP 0.3</span>)</span> T</span>)</span></span>)</span>
..  0.200   ⋅ <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code"><i><span class="symbol">PROGN</span></i> <span class="paren3">(<span class="code">SLEEP 0.2</span>)</span> T</span>)</span></span>)</span>
..          ⊟ ""xxx <span class="paren1">(<span class="code">SIMPLE-ERROR</span>)</span>
..  0.504 ⊟ TIMED ⊟1 ⋅2
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">TIMED</span>)</span></span>)</span> ABORT* 0.504s ⊟1 ⋅2&gt;</span></code></pre>

<p>Timing is available for all <a href="#x-28TRY-3AOUTCOME-20CONDITION-29" title="(TRY:OUTCOME CONDITION)"><code>OUTCOME</code></a>s (i.e. for <a href="#x-28TRY-3A-40TRY-2FCHECKS-20MGL-PAX-3ASECTION-29" title="Checks">Checks</a> and
<a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>s). Checks generally measure the time spent during evaluation
the form they are wrapping. Trials measure the time between
<a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a> and the <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>.</p>

<p>Timing information is not available for <code>TRIAL-START</code> and <a href="#x-28TRY-3AERROR-2A-20CONDITION-29" title="(TRY:ERROR* CONDITION)"><code>ERROR*</code></a>
events.</p></li>
</ul>

<p><a id='x-28TRY-3A-2APRINT-COMPACTLY-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/print.lisp#L292">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2APRINT-COMPACTLY-2A-20VARIABLE-29" >*PRINT-COMPACTLY*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p><a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a>s whose type matches <code>*PRINT-COMPACTLY*</code> are printed less
verbosely. <a href="#x-28TRY-3ALEAF-20CONDITION-29" title="(TRY:LEAF CONDITION)"><code>LEAF</code></a> events are printed only with their marker, and
<a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>s of trials without printed child trials are printed with <code>=&gt;
&lt;MARKER&gt;</code> (see <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a>).</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print-compactly*</span> t</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*describe*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">outer</span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">loop</span></i> repeat 10 do <span class="paren4">(<span class="code">is t</span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">inner</span>)</span>
      <span class="paren4">(<span class="code">is t</span>)</span>
      <span class="paren4">(<span class="code">is nil</span>)</span>
      <span class="paren4">(<span class="code">error <span class="string">"xxx"</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">loop</span></i> repeat 10 do <span class="paren4">(<span class="code">is t</span>)</span></span>)</span></span>)</span></span>)</span>
.. OUTER ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅
..   INNER ⋅⊠⊟ =&gt; ⊟
..   ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅
.. ⊠ OUTER ⊟1 ⊠1 ⋅21
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">OUTER</span>)</span></span>)</span> UNEXPECTED-FAILURE 0.000s ⊟1 ⊠1 ⋅21&gt;</span></code></pre>

<p><code>*PRINT-COMPACTLY*</code> has no effect on events being <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_descri.htm" title="(DESCRIBE FUNCTION)"><code>DESCRIBE</code></a>d.</p></li>
</ul>

<p><a id='x-28TRY-3A-2ADEFER-DESCRIBE-2A-20VARIABLE-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/print.lisp#L320">[variable]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-2ADEFER-DESCRIBE-2A-20VARIABLE-29" >*DEFER-DESCRIBE*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>When an <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> is to be <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_descri.htm" title="(DESCRIBE FUNCTION)"><code>DESCRIBE</code></a>d and its type matches
<code>*DEFER-DESCRIBE*</code>, then instead of printing the often longish context
information in the tree of events, it is deferred until after <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>
has finished. The following example only prints <a href="#x-28TRY-3ALEAF-20CONDITION-29" title="(TRY:LEAF CONDITION)"><code>LEAF</code></a> events (due to
<a href="#x-28TRY-3A-2APRINT-2A-20VARIABLE-29" title="(TRY:*PRINT* VARIABLE)"><code>*PRINT*</code></a> and <a href="#x-28TRY-3A-2APRINT-PARENT-2A-20VARIABLE-29" title="(TRY:*PRINT-PARENT* VARIABLE)"><code>*PRINT-PARENT*</code></a>) and in compact form (see
<a href="#x-28TRY-3A-2APRINT-COMPACTLY-2A-20VARIABLE-29" title="(TRY:*PRINT-COMPACTLY* VARIABLE)"><code>*PRINT-COMPACTLY*</code></a>), deferring description of events matching
<a href="#x-28TRY-3A-2ADESCRIBE-2A-20VARIABLE-29" title="(TRY:*DESCRIBE* VARIABLE)"><code>*DESCRIBE*</code></a> until the end.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print*</span> 'leaf</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*print-parent*</span> nil</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*print-compactly*</span> t</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*defer-describe*</span> t</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">outer</span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">loop</span></i> repeat 10 do <span class="paren4">(<span class="code">is t</span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">inner</span>)</span>
      <span class="paren4">(<span class="code">is <span class="paren5">(<span class="code">= <span class="paren6">(<span class="code">1+ 5</span>)</span> 7</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
.. ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⊠
..
.. <span class="comment">;; UNEXPECTED-RESULT-FAILURE (⊠) in OUTER INNER:
</span>.. <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= #1=<span class="paren3">(<span class="code">1+ 5</span>)</span> 7</span>)</span></span>)</span>
.. where
..   #1# = 6
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">OUTER</span>)</span></span>)</span> UNEXPECTED-FAILURE 0.000s ⊠1 ⋅10&gt;</span></code></pre></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/count.lisp#L5">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29">7.4 Counting Events</a></h3>

<p><a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a>s have a counter for each category in <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a>. When an
<a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> is recorded by <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> and its type matches <a href="#x-28TRY-3A-2ACOUNT-2A-20VARIABLE-29" title="(TRY:*COUNT* VARIABLE)"><code>*COUNT*</code></a>, the counters
of all categories matching the event type are incremented in the
<a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a>. When a trial finishes and a <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> is recorded, the
trial's event counters are added to that of its parent's (if any).
The counts are printed with <code>VERDICT</code>s (see <a href="#x-28TRY-3A-40TRY-2FPRINT-20MGL-PAX-3ASECTION-29" title="Printing Events">Printing Events</a>).</p>

<p>If both <code>*COUNT*</code> and <code>*CATEGORIES*</code> are unchanged from the their
default values, then only <a href="#x-28TRY-3ALEAF-20CONDITION-29" title="(TRY:LEAF CONDITION)"><code>LEAF</code></a> events are counted, and we get
separate counters for <a href="#x-28TRY-3AABORT-2A-20CONDITION-29" title="(TRY:ABORT* CONDITION)"><code>ABORT*</code></a>, <a href="#x-28TRY-3AUNEXPECTED-FAILURE-20TYPE-29" title="(TRY:UNEXPECTED-FAILURE TYPE)"><code>UNEXPECTED-FAILURE</code></a>,
<a href="#x-28TRY-3AUNEXPECTED-SUCCESS-20TYPE-29" title="(TRY:UNEXPECTED-SUCCESS TYPE)"><code>UNEXPECTED-SUCCESS</code></a>, <a href="#x-28TRY-3ASKIP-20CONDITION-29" title="(TRY:SKIP CONDITION)"><code>SKIP</code></a>, <a href="#x-28TRY-3AEXPECTED-FAILURE-20TYPE-29" title="(TRY:EXPECTED-FAILURE TYPE)"><code>EXPECTED-FAILURE</code></a>, and <a href="#x-28TRY-3AEXPECTED-SUCCESS-20TYPE-29" title="(TRY:EXPECTED-SUCCESS TYPE)"><code>EXPECTED-SUCCESS</code></a>.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*debug*</span> nil</span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren3">(<span class="code">outer</span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-test</span></i> <span class="paren4">(<span class="code">inner</span>)</span>
      <span class="paren4">(<span class="code">is t</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">is t</span>)</span>
    <span class="paren3">(<span class="code">is nil</span>)</span></span>)</span></span>)</span>
.. OUTER
..   INNER
..     ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..   ⋅ INNER ⋅1
..   ⋅ <span class="paren1">(<span class="code">IS T</span>)</span>
..   ⊠ <span class="paren1">(<span class="code">IS NIL</span>)</span>
.. ⊠ OUTER ⊠1 ⋅2
..
==&gt; #&lt;TRIAL <span class="paren1">(<span class="code"><i><span class="symbol">WITH-TEST</span></i> <span class="paren2">(<span class="code">OUTER</span>)</span></span>)</span> UNEXPECTED-FAILURE 0.000s ⊠1 ⋅2&gt;</span></code></pre>

<p>As the above example shows, <a href="#x-28TRY-3AEXPECTED-VERDICT-SUCCESS-20CONDITION-29" title="(TRY:EXPECTED-VERDICT-SUCCESS CONDITION)"><code>EXPECTED-VERDICT-SUCCESS</code></a> and
<a href="#x-28TRY-3AEXPECTED-RESULT-SUCCESS-20CONDITION-29" title="(TRY:EXPECTED-RESULT-SUCCESS CONDITION)"><code>EXPECTED-RESULT-SUCCESS</code></a> are both marked with <code>&quot;⋅&quot;</code>, but only
<code>EXPECTED-RESULT-SUCCESS</code> is counted due to <code>*COUNT*</code> being <code>LEAF</code>.</p>

<p><a id='x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/collect.lisp#L3">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29">7.5 Collecting Events</a></h3>

<p>When an <a href="#x-28TRY-3AEVENT-20CONDITION-29" title="(TRY:EVENT CONDITION)"><code>EVENT</code></a> is recorded and the type of the <code>EVENT</code> matches the
<code>COLLECT</code> type argument of <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>, then a corresponding object is pushed
onto <a href="#x-28TRY-3ACHILDREN-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" title="(TRY:CHILDREN (MGL-PAX:READER TRY:TRIAL))"><code>CHILDREN</code></a> of the <a href="#x-28TRY-3ACURRENT-TRIAL-20FUNCTION-29" title="(TRY:CURRENT-TRIAL FUNCTION)"><code>CURRENT-TRIAL</code></a> for subsequent <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">Rerunning Trials</a> or
<a href="#x-28TRY-3A-40TRY-2FREPLAY-20MGL-PAX-3ASECTION-29" title="Reprocessing Trials">Reprocessing Trials</a>.</p>

<p>In particular, if the matching event is a <a href="#x-28TRY-3ALEAF-20CONDITION-29" title="(TRY:LEAF CONDITION)"><code>LEAF</code></a>, then the event
itself is collected. If the matching event is a <a href="#x-28TRY-3ATRIAL-EVENT-20CONDITION-29" title="(TRY:TRIAL-EVENT CONDITION)"><code>TRIAL-EVENT</code></a>, then
its <a href="#x-28TRY-3ATRIAL-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-EVENT-29-29" title="(TRY:TRIAL (MGL-PAX:READER TRY:TRIAL-EVENT))"><code>TRIAL</code></a> is collected. Furthermore, trials
which collected anything are always collected by their parent.</p>

<p>By default, both implicit and explicit calls to <code>TRY</code> collect the
<a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a> (see <a href="#x-28TRY-3A-2ACOLLECT-2A-20VARIABLE-29" title="(TRY:*COLLECT* VARIABLE)"><code>*COLLECT*</code></a> and <a href="#x-28TRY-3A-2ATRY-COLLECT-2A-20VARIABLE-29" title="(TRY:*TRY-COLLECT* VARIABLE)"><code>*TRY-COLLECT*</code></a>), and consequently all
the enclosing trials.</p>

<p><a id='x-28TRY-3ACHILDREN-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/trial.lisp#L80">[reader]</a></span> <span class="reference-object"><a href="#x-28TRY-3ACHILDREN-20-28MGL-PAX-3AREADER-20TRY-3ATRIAL-29-29" >CHILDREN</a></span></span> <span class="locative-args">TRIAL</span> <span class="locative-args">(:CHILDREN = <code>NIL</code>)</span></span></p>

<p>A list of immediate child <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a>s, <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>s, and
<a href="#x-28TRY-3AERROR-2A-20CONDITION-29" title="(TRY:ERROR* CONDITION)"><code>ERROR*</code></a>s collected in reverse chronological order (see
<a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">Collecting Events</a>). The <code>VERDICT</code> of this <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> is not among <code>CHILDREN</code>,
but the <code>VERDICT</code>s of child trials' are.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FREPLAY-20MGL-PAX-3ASECTION-29" title="Reprocessing Trials">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/rerun.lisp#L3">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29">7.6 Rerunning Trials</a></h3>

<p>When a <a href="#x-28TRY-3ATRIAL-20TYPE-29" title="(TRY:TRIAL TYPE)"><code>TRIAL</code></a> is <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_funcal.htm" title="(FUNCALL FUNCTION)"><code>FUNCALL</code></a>ed or passed to <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a>, the same tests that
instantiated <code>TRIAL</code> are executed.</p>

<ul>
<li><p>If the trial was created by calling a <a href="#x-28TRY-3ADEFTEST-20MGL-PAX-3AMACRO-29" title="(TRY:DEFTEST MGL-PAX:MACRO)"><code>DEFTEST</code></a> function, then the
  test currently associated with that symbol naming the function is
  called with the arguments of the original function call. If the
  symbol is no longer <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_fbound.htm" title="(FBOUNDP FUNCTION)"><code>FBOUNDP</code></a> (because it was <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_fmakun.htm" title="(FMAKUNBOUND FUNCTION)"><code>FMAKUNBOUND</code></a>) or it no
  longer names a <code>DEFTEST</code> (it was redefined with <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm" title="(DEFUN MGL-PAX:MACRO)"><code>DEFUN</code></a>), then an
  error is signalled.</p></li>
<li><p>If the trial was created by entering a <a href="#x-28TRY-3AWITH-TEST-20MGL-PAX-3AMACRO-29" title="(TRY:WITH-TEST MGL-PAX:MACRO)"><code>WITH-TEST</code></a> form, then its
  body is executed again in the original lexical but the current
  dynamic environment. Implementationally speaking, <code>WITH-TEST</code>
  defines a local function of no arguments (likely a closure) that
  wraps its body, stores the closure in the trial object and calls
  it on a rerun in a <code>WITH-TEST</code> of the same <code>TRIAL-VAR</code> and same <code>NAME</code>.</p></li>
<li><p>If the trial was created by <code>TRY</code> itself to ensure that all events
  are signalled in a trial (see <a href="#x-28TRY-3A-40TRY-2FEXPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Explicit TRY">Explicit TRY</a>), then on a rerun
  the same <code>TESTABLE</code> is run again.</p></li>
</ul>

<p>All three possibilities involve entering <code>DEFTEST</code> or <code>WITH-TEST</code>, or
invoking <code>TRY</code>: the same cases that we have when calling tests
functions (see <a href="#x-28TRY-3A-40TRY-2FIMPLICIT-TRY-20MGL-PAX-3ASECTION-29" title="Calling Test Functions">Calling Test Functions</a>). Thus even if a trial is rerun
with <code>FUNCALL</code>, execution is guaranteed to happen under an <code>TRY</code>, so we
can talk about its <code>RERUN</code> parameter.</p>

<p>As the test functions are being rerun, some trials are automatically
skipped. When that happens the corresponding function call
immediately returns the <code>TRIAL</code> object. A new trial is skipped if</p>

<ul>
<li><p>among the collected but not yet rerun trials in the trial being
  rerun, there is no trial representing the same function call, or</p></li>
<li><p>the first such trial does not match the <code>RERUN</code> type argument of <code>TRY</code>
  in that neither its <a href="#x-28TRY-3ATRIAL-START-20CONDITION-29" title="(TRY:TRIAL-START CONDITION)"><code>TRIAL-START</code></a>, <a href="#x-28TRY-3AVERDICT-20CONDITION-29" title="(TRY:VERDICT CONDITION)"><code>VERDICT</code></a> events match the type
  <code>RERUN</code>, nor do any of its collected <a href="#x-28TRY-3ARESULT-20CONDITION-29" title="(TRY:RESULT CONDITION)"><code>RESULT</code></a>s and trials.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FREPLAY-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FRERUN-20MGL-PAX-3ASECTION-29" title="Rerunning Trials">&#8592;</a> <a href="#x-28TRY-3A-40TRY-2FTESTS-20MGL-PAX-3ASECTION-29" title="Tests">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FIMPLEMENTATION-NOTES-20MGL-PAX-3ASECTION-29" title="Implementation Notes">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FREPLAY-20MGL-PAX-3ASECTION-29" title="Reprocessing Trials">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/replay.lisp#L5">&#955;</a></span></span></p>

<h3><a href="#x-28TRY-3A-40TRY-2FREPLAY-20MGL-PAX-3ASECTION-29">7.7 Reprocessing Trials</a></h3>

<p><a id='x-28TRY-3AREPLAY-EVENTS-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/replay.lisp#L8">[function]</a></span> <span class="reference-object"><a href="#x-28TRY-3AREPLAY-EVENTS-20FUNCTION-29" >REPLAY-EVENTS</a></span></span> <span class="locative-args">TRIAL &amp;KEY (COLLECT <a href="#x-28TRY-3A-2ATRY-COLLECT-2A-20VARIABLE-29" title="(TRY:*TRY-COLLECT* VARIABLE)"><code>*TRY-COLLECT*</code></a>) (PRINT <a href="#x-28TRY-3A-2ATRY-PRINT-2A-20VARIABLE-29" title="(TRY:*TRY-PRINT* VARIABLE)"><code>*TRY-PRINT*</code></a>) (DESCRIBE <a href="#x-28TRY-3A-2ATRY-DESCRIBE-2A-20VARIABLE-29" title="(TRY:*TRY-DESCRIBE* VARIABLE)"><code>*TRY-DESCRIBE*</code></a>) (STREAM <a href="#x-28TRY-3A-2ATRY-STREAM-2A-20VARIABLE-29" title="(TRY:*TRY-STREAM* VARIABLE)"><code>*TRY-STREAM*</code></a>) (PRINTER <a href="#x-28TRY-3A-2ATRY-PRINTER-2A-20VARIABLE-29" title="(TRY:*TRY-PRINTER* VARIABLE)"><code>*TRY-PRINTER*</code></a>)</span></span></p>

<p><code>REPLAY-EVENTS</code> reprocesses the events collected (see <a href="#x-28TRY-3A-40TRY-2FCOLLECT-20MGL-PAX-3ASECTION-29" title="Collecting Events">Collecting Events</a>)
in <code>TRIAL</code>. It takes the same arguments as <a href="#x-28TRY-3ATRY-20FUNCTION-29" title="(TRY:TRY FUNCTION)"><code>TRY</code></a> except <code>DEBUG</code>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_countc.htm" title="(COUNT FUNCTION)"><code>COUNT</code></a> and
<code>RERUN</code>. This is because <code>REPLAY-EVENTS</code> does not run any tests. It
simply signals the events collected in <code>TRIAL</code> again to allow further
processing. The values of <a href="#x-28TRY-3A-2ACATEGORIES-2A-20-28VARIABLE-20-22--20see-20above-20--22-29-29" title="(TRY:*CATEGORIES* (VARIABLE \&quot;- see above -\&quot;))"><code>*CATEGORIES*</code></a> and <a href="#x-28TRY-3A-2ACOUNT-2A-20VARIABLE-29" title="(TRY:*COUNT* VARIABLE)"><code>*COUNT*</code></a> that were in
effect for <code>TRIAL</code> are used, and their current values are ignored to
be able to keep consistent counts (see <a href="#x-28TRY-3A-40TRY-2FCOUNT-20MGL-PAX-3ASECTION-29" title="Counting Events">Counting Events</a>).</p>

<p>Suppose we have run a large test using the default <code>:PRINT 'LEAF</code>
<code>:COLLECT 'UNEXPECTED</code> arguments for <code>TRY</code>, and now we have too much
output to look at. Instead of searching for the interesting bits in
the output, we can replay the events and print only the <a href="#x-28TRY-3AUNEXPECTED-20CONDITION-29" title="(TRY:UNEXPECTED CONDITION)"><code>UNEXPECTED</code></a>
events:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">replay-events ! <span class="keyword">:print</span> 'unexpected</span>)</span></span></code></pre>

<p>Or we could tell the printer to just print markers for <code>*CATEGORIES*</code>
and <code>:DESCRIBE</code> at the end:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="special">*print-parent*</span> nil</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*print-compactly*</span> t</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*defer-describe*</span> t</span>)</span>
      <span class="paren3">(<span class="code"><span class="special">*categories*</span> <span class="paren4">(<span class="code">ascii-std-categories</span>)</span></span>)</span></span>)</span>
  <span class="paren2">(<span class="code">replay-events !</span>)</span></span>)</span>
.. ................F................!.....
.. 
.. <span class="comment">;; UNEXPECTED-FAILURE (F) in SOME-TEST INNER-TEST:
</span>.. <span class="paren1">(<span class="code">IS <span class="paren2">(<span class="code">= 5 6</span>)</span></span>)</span>
.. debug info
.. 
.. <span class="comment">;; UNHANDLED-ERROR (!) in SOME-TEST:
</span>.. "my-msg" <span class="paren1">(<span class="code">MY-ERR</span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FIMPLEMENTATION-NOTES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FREPLAY-20MGL-PAX-3ASECTION-29" title="Reprocessing Trials">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FGLOSSARY-20MGL-PAX-3ASECTION-29" title="Glossary">&#8594;</a> <a href="#x-28TRY-3A-40TRY-2FIMPLEMENTATION-NOTES-20MGL-PAX-3ASECTION-29" title="Implementation Notes">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L408">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FIMPLEMENTATION-NOTES-20MGL-PAX-3ASECTION-29">8 Implementation Notes</a></h2>

<p>Try is supported on ABCL, AllegroCL, CLISP, CCL, CMUCL, ECL and
SBCL.</p>

<ul>
<li><p>Pretty printing is non-existent on CLISP and broken on ABCL. The
  output may look garbled on them.</p></li>
<li><p>Gray streams are broken on ABCL so the output may look even worse
  <a href="https://abcl.org/trac/ticket/373" >https://abcl.org/trac/ticket/373</a>.</p></li>
<li><p>ABCL, CMUCL, and ECL have a bug related to losing
  <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_eql.htm" title="(EQL FUNCTION)"><code>EQL</code></a>ness of source literals
  <a href="https://gitlab.com/embeddable-common-lisp/ecl/-/issues/665" >https://gitlab.com/embeddable-common-lisp/ecl/-/issues/665</a>.
  The result is somewhat cosmetic, it may cause multiple captures
  being made for the same thing.</p></li>
</ul>

<p><a id='x-28TRY-3A-40TRY-2FGLOSSARY-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28TRY-3A-40TRY-2FIMPLEMENTATION-NOTES-20MGL-PAX-3ASECTION-29" title="Implementation Notes">&#8592;</a> <a href="#x-28TRY-3A-40TRY-MANUAL-20MGL-PAX-3ASECTION-29" title="Try Manual">&#8593;</a> <a href="#x-28TRY-3A-40TRY-2FGLOSSARY-20MGL-PAX-3ASECTION-29" title="Glossary">&#8634;</a> <a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L426">&#955;</a></span></span></p>

<h2><a href="#x-28TRY-3A-40TRY-2FGLOSSARY-20MGL-PAX-3ASECTION-29">9 Glossary</a></h2>

<p><a id='x-28TRY-3A-3A-40FUNCTION-DESIGNATOR-20MGL-PAX-3AGLOSSARY-TERM-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L432">[glossary-term]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-3A-40FUNCTION-DESIGNATOR-20MGL-PAX-3AGLOSSARY-TERM-29" >function designator</a></span></span></span></p>

<p>This is a term from the Common Lisp ANSI standard. A function
designator is a symbol (denoting the function named by that symbol
in the global environment), or a function (denoting itself).</p></li>
</ul>

<p><a id='x-28TRY-3A-3A-40FUNCALLABLE-INSTANCE-20MGL-PAX-3AGLOSSARY-TERM-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L437">[glossary-term]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-3A-40FUNCALLABLE-INSTANCE-20MGL-PAX-3AGLOSSARY-TERM-29" >funcallable instance</a></span></span></span></p>

<p>This is a term from the MOP. A funcallable instance is an instance
of a class that's a subclass of <code>MOP:FUNCALLABLE-STANDARD-CLASS</code>. It
is like a normal instance, but it can also be <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_funcal.htm" title="(FUNCALL FUNCTION)"><code>FUNCALL</code></a>ed.</p></li>
</ul>

<p><a id='x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L442">[glossary-term]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" >non-local exit</a></span></span></span></p>

<p>This is a term from the Common Lisp ANSI standard. If a form does
not return normally, but control is transferred via <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_go.htm" title="(GO MGL-PAX:MACRO)"><code>GO</code></a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_return.htm" title="(RETURN MGL-PAX:MACRO)"><code>RETURN</code></a>,
<a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_ret_fr.htm" title="(RETURN-FROM MGL-PAX:MACRO)"><code>RETURN-FROM</code></a> or <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_throw.htm" title="(THROW MGL-PAX:MACRO)"><code>THROW</code></a>, then it is said to have performed a non-local
exit.</p></li>
</ul>

<p><a id='x-28TRY-3A-3A-40CANCELLED-NLX-20MGL-PAX-3AGLOSSARY-TERM-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/try/blob/9390e629bca55e35719c7cc6f0d6418ebfcb6732/src/manual.lisp#L448">[glossary-term]</a></span> <span class="reference-object"><a href="#x-28TRY-3A-3A-40CANCELLED-NLX-20MGL-PAX-3AGLOSSARY-TERM-29" >cancelled non-local exit</a></span></span></span></p>

<p>This is a term from the Common Lisp ANSI standard. If during the
unwinding of the stack initiated by a <a href="#x-28TRY-3A-3A-40NON-LOCAL-EXIT-20MGL-PAX-3AGLOSSARY-TERM-29" title="(TRY::@NON-LOCAL-EXIT MGL-PAX:GLOSSARY-TERM)">non-local exit</a> another nlx is
initiated in, and exits from an <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_unwind.htm" title="(UNWIND-PROTECT MGL-PAX:MACRO)"><code>UNWIND-PROTECT</code></a> cleanup form, then
this second nlx is said to have cancelled the first, and the first
nlx will not continue.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">catch</span></i> 'foo
  <span class="paren2">(<span class="code"><i><span class="symbol">catch</span></i> 'bar
    <span class="paren3">(<span class="code"><i><span class="symbol">unwind-protect</span></i>
         <span class="paren4">(<span class="code"><i><span class="symbol">throw</span></i> 'foo 'foo</span>)</span>
      <span class="paren4">(<span class="code"><i><span class="symbol">throw</span></i> 'bar 'bar</span>)</span></span>)</span></span>)</span></span>)</span>
=&gt; BAR</span></code></pre></li>
</ul>
  </div>
</div>
<script>$('#page-toc').toc({'selectors': 'h1,h2,h3,h4'});</script>
</body>
</html>
